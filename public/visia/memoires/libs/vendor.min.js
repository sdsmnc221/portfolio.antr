!function(t){"use strict";if(!t.fetch){var e={searchParams:"URLSearchParams"in t,iterable:"Symbol"in t&&"iterator"in Symbol,blob:"FileReader"in t&&"Blob"in t&&function(){try{return new Blob,!0}catch(t){return!1}}(),formData:"FormData"in t,arrayBuffer:"ArrayBuffer"in t};if(e.arrayBuffer)var i=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],n=function(t){return t&&DataView.prototype.isPrototypeOf(t)},s=ArrayBuffer.isView||function(t){return t&&i.indexOf(Object.prototype.toString.call(t))>-1};u.prototype.append=function(t,e){t=a(t),e=h(e);var i=this.map[t];this.map[t]=i?i+","+e:e},u.prototype.delete=function(t){delete this.map[a(t)]},u.prototype.get=function(t){return t=a(t),this.has(t)?this.map[t]:null},u.prototype.has=function(t){return this.map.hasOwnProperty(a(t))},u.prototype.set=function(t,e){this.map[a(t)]=h(e)},u.prototype.forEach=function(t,e){for(var i in this.map)this.map.hasOwnProperty(i)&&t.call(e,this.map[i],i,this)},u.prototype.keys=function(){var t=[];return this.forEach(function(e,i){t.push(i)}),l(t)},u.prototype.values=function(){var t=[];return this.forEach(function(e){t.push(e)}),l(t)},u.prototype.entries=function(){var t=[];return this.forEach(function(e,i){t.push([i,e])}),l(t)},e.iterable&&(u.prototype[Symbol.iterator]=u.prototype.entries);var o=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];_.prototype.clone=function(){return new _(this,{body:this._bodyInit})},m.call(_.prototype),m.call(y.prototype),y.prototype.clone=function(){return new y(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new u(this.headers),url:this.url})},y.error=function(){var t=new y(null,{status:0,statusText:""});return t.type="error",t};var r=[301,302,303,307,308];y.redirect=function(t,e){if(-1===r.indexOf(e))throw new RangeError("Invalid status code");return new y(null,{status:e,headers:{location:t}})},t.Headers=u,t.Request=_,t.Response=y,t.fetch=function(t,i){return new Promise(function(n,s){var o=new _(t,i),r=new XMLHttpRequest;r.onload=function(){var t,e,i={status:r.status,statusText:r.statusText,headers:(t=r.getAllResponseHeaders()||"",e=new u,t.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach(function(t){var i=t.split(":"),n=i.shift().trim();if(n){var s=i.join(":").trim();e.append(n,s)}}),e)};i.url="responseURL"in r?r.responseURL:i.headers.get("X-Request-URL");var s="response"in r?r.response:r.responseText;n(new y(s,i))},r.onerror=function(){s(new TypeError("Network request failed"))},r.ontimeout=function(){s(new TypeError("Network request failed"))},r.open(o.method,o.url,!0),"include"===o.credentials?r.withCredentials=!0:"omit"===o.credentials&&(r.withCredentials=!1),"responseType"in r&&e.blob&&(r.responseType="blob"),o.headers.forEach(function(t,e){r.setRequestHeader(e,t)}),r.send(void 0===o._bodyInit?null:o._bodyInit)})},t.fetch.polyfill=!0}function a(t){if("string"!=typeof t&&(t=String(t)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(t))throw new TypeError("Invalid character in header field name");return t.toLowerCase()}function h(t){return"string"!=typeof t&&(t=String(t)),t}function l(t){var i={next:function(){var e=t.shift();return{done:void 0===e,value:e}}};return e.iterable&&(i[Symbol.iterator]=function(){return i}),i}function u(t){this.map={},t instanceof u?t.forEach(function(t,e){this.append(e,t)},this):Array.isArray(t)?t.forEach(function(t){this.append(t[0],t[1])},this):t&&Object.getOwnPropertyNames(t).forEach(function(e){this.append(e,t[e])},this)}function c(t){if(t.bodyUsed)return Promise.reject(new TypeError("Already read"));t.bodyUsed=!0}function f(t){return new Promise(function(e,i){t.onload=function(){e(t.result)},t.onerror=function(){i(t.error)}})}function d(t){var e=new FileReader,i=f(e);return e.readAsArrayBuffer(t),i}function p(t){if(t.slice)return t.slice(0);var e=new Uint8Array(t.byteLength);return e.set(new Uint8Array(t)),e.buffer}function m(){return this.bodyUsed=!1,this._initBody=function(t){if(this._bodyInit=t,t)if("string"==typeof t)this._bodyText=t;else if(e.blob&&Blob.prototype.isPrototypeOf(t))this._bodyBlob=t;else if(e.formData&&FormData.prototype.isPrototypeOf(t))this._bodyFormData=t;else if(e.searchParams&&URLSearchParams.prototype.isPrototypeOf(t))this._bodyText=t.toString();else if(e.arrayBuffer&&e.blob&&n(t))this._bodyArrayBuffer=p(t.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer]);else{if(!e.arrayBuffer||!ArrayBuffer.prototype.isPrototypeOf(t)&&!s(t))throw new Error("unsupported BodyInit type");this._bodyArrayBuffer=p(t)}else this._bodyText="";this.headers.get("content-type")||("string"==typeof t?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):e.searchParams&&URLSearchParams.prototype.isPrototypeOf(t)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},e.blob&&(this.blob=function(){var t=c(this);if(t)return t;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?c(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(d)}),this.text=function(){var t,e,i,n=c(this);if(n)return n;if(this._bodyBlob)return t=this._bodyBlob,e=new FileReader,i=f(e),e.readAsText(t),i;if(this._bodyArrayBuffer)return Promise.resolve(function(t){for(var e=new Uint8Array(t),i=new Array(e.length),n=0;n<e.length;n++)i[n]=String.fromCharCode(e[n]);return i.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},e.formData&&(this.formData=function(){return this.text().then(g)}),this.json=function(){return this.text().then(JSON.parse)},this}function _(t,e){var i,n,s=(e=e||{}).body;if(t instanceof _){if(t.bodyUsed)throw new TypeError("Already read");this.url=t.url,this.credentials=t.credentials,e.headers||(this.headers=new u(t.headers)),this.method=t.method,this.mode=t.mode,s||null==t._bodyInit||(s=t._bodyInit,t.bodyUsed=!0)}else this.url=String(t);if(this.credentials=e.credentials||this.credentials||"omit",!e.headers&&this.headers||(this.headers=new u(e.headers)),this.method=(i=e.method||this.method||"GET",n=i.toUpperCase(),o.indexOf(n)>-1?n:i),this.mode=e.mode||this.mode||null,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&s)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(s)}function g(t){var e=new FormData;return t.trim().split("&").forEach(function(t){if(t){var i=t.split("="),n=i.shift().replace(/\+/g," "),s=i.join("=").replace(/\+/g," ");e.append(decodeURIComponent(n),decodeURIComponent(s))}}),e}function y(t,e){e||(e={}),this.type="default",this.status=void 0===e.status?200:e.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in e?e.statusText:"OK",this.headers=new u(e.headers),this.url=e.url||"",this._initBody(t)}}("undefined"!=typeof self?self:this),function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t.L={})}(this,function(t){"use strict";function e(t){var e,i,n,s;for(i=1,n=arguments.length;i<n;i++)for(e in s=arguments[i])t[e]=s[e];return t}function i(t,e){var i=Array.prototype.slice;if(t.bind)return t.bind.apply(t,i.call(arguments,1));var n=i.call(arguments,2);return function(){return t.apply(e,n.length?n.concat(i.call(arguments)):arguments)}}function n(t){return t._leaflet_id=t._leaflet_id||++Xt,t._leaflet_id}function s(t,e,i){var n,s,o,r;return r=function(){n=!1,s&&(o.apply(i,s),s=!1)},o=function(){n?s=arguments:(t.apply(i,arguments),setTimeout(r,e),n=!0)}}function o(t,e,i){var n=e[1],s=e[0],o=n-s;return t===n&&i?t:((t-s)%o+o)%o+s}function r(){return!1}function a(t,e){var i=Math.pow(10,void 0===e?6:e);return Math.round(t*i)/i}function h(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function l(t){return h(t).split(/\s+/)}function u(t,e){for(var i in t.hasOwnProperty("options")||(t.options=t.options?Ht(t.options):{}),e)t.options[i]=e[i];return t.options}function c(t,e,i){var n=[];for(var s in t)n.push(encodeURIComponent(i?s.toUpperCase():s)+"="+encodeURIComponent(t[s]));return(e&&-1!==e.indexOf("?")?"&":"?")+n.join("&")}function f(t,e){return t.replace(qt,function(t,i){var n=e[i];if(void 0===n)throw new Error("No value provided for variable "+t);return"function"==typeof n&&(n=n(e)),n})}function d(t,e){for(var i=0;i<t.length;i++)if(t[i]===e)return i;return-1}function p(t){return window["webkit"+t]||window["moz"+t]||window["ms"+t]}function m(t){var e=+new Date,i=Math.max(0,16-(e-Gt));return Gt=e+i,window.setTimeout(t,i)}function _(t,e,n){if(!n||$t!==m)return $t.call(window,i(t,e));t.call(e)}function g(t){t&&Kt.call(window,t)}function y(){}function v(t,e,i){this.x=i?Math.round(t):t,this.y=i?Math.round(e):e}function x(t,e,i){return t instanceof v?t:Vt(t)?new v(t[0],t[1]):void 0===t||null===t?t:"object"==typeof t&&"x"in t&&"y"in t?new v(t.x,t.y):new v(t,e,i)}function w(t,e){if(t)for(var i=e?[t,e]:t,n=0,s=i.length;n<s;n++)this.extend(i[n])}function b(t,e){return!t||t instanceof w?t:new w(t,e)}function P(t,e){if(t)for(var i=e?[t,e]:t,n=0,s=i.length;n<s;n++)this.extend(i[n])}function M(t,e){return t instanceof P?t:new P(t,e)}function T(t,e,i){if(isNaN(t)||isNaN(e))throw new Error("Invalid LatLng object: ("+t+", "+e+")");this.lat=+t,this.lng=+e,void 0!==i&&(this.alt=+i)}function S(t,e,i){return t instanceof T?t:Vt(t)&&"object"!=typeof t[0]?3===t.length?new T(t[0],t[1],t[2]):2===t.length?new T(t[0],t[1]):null:void 0===t||null===t?t:"object"==typeof t&&"lat"in t?new T(t.lat,"lng"in t?t.lng:t.lon,t.alt):void 0===e?null:new T(t,e,i)}function k(t,e,i,n){if(Vt(t))return this._a=t[0],this._b=t[1],this._c=t[2],void(this._d=t[3]);this._a=t,this._b=e,this._c=i,this._d=n}function E(t,e,i,n){return new k(t,e,i,n)}function C(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function A(t,e){var i,n,s,o,r,a,h="";for(i=0,s=t.length;i<s;i++){for(n=0,o=(r=t[i]).length;n<o;n++)a=r[n],h+=(n?"L":"M")+a.x+" "+a.y;h+=e?Fe?"z":"x":""}return h||"M0 0"}function O(t){return navigator.userAgent.toLowerCase().indexOf(t)>=0}function R(t,e,i,n){return"touchstart"===e?z(t,i,n):"touchmove"===e?function(t,e,i){var n=function(t){(t.pointerType!==t.MSPOINTER_TYPE_MOUSE&&"mouse"!==t.pointerType||0!==t.buttons)&&Z(t,e)};t["_leaflet_touchmove"+i]=n,t.addEventListener(Xe,n,!1)}(t,i,n):"touchend"===e&&function(t,e,i){var n=function(t){Z(t,e)};t["_leaflet_touchend"+i]=n,t.addEventListener(qe,n,!1),t.addEventListener(Ve,n,!1)}(t,i,n),this}function z(t,e,n){var s=i(function(t){if("mouse"!==t.pointerType&&t.MSPOINTER_TYPE_MOUSE&&t.pointerType!==t.MSPOINTER_TYPE_MOUSE){if(!(Ye.indexOf(t.target.tagName)<0))return;Y(t)}Z(t,e)});t["_leaflet_touchstart"+n]=s,t.addEventListener(He,s,!1),$e||(document.documentElement.addEventListener(He,I,!0),document.documentElement.addEventListener(Xe,B,!0),document.documentElement.addEventListener(qe,N,!0),document.documentElement.addEventListener(Ve,N,!0),$e=!0)}function I(t){Ge[t.pointerId]=t,Ke++}function B(t){Ge[t.pointerId]&&(Ge[t.pointerId]=t)}function N(t){delete Ge[t.pointerId],Ke--}function Z(t,e){for(var i in t.touches=[],Ge)t.touches.push(Ge[i]);t.changedTouches=[t],e(t)}function D(t,e,i){function n(t){var e;if(Ie){if(!pe||"mouse"===t.pointerType)return;e=Ke}else e=t.touches.length;if(!(e>1)){var i=Date.now(),n=i-(o||i);r=t.touches?t.touches[0]:t,a=n>0&&n<=h,o=i}}function s(t){if(a&&!r.cancelBubble){if(Ie){if(!pe||"mouse"===t.pointerType)return;var i,n,s={};for(n in r)i=r[n],s[n]=i&&i.bind?i.bind(r):i;r=s}r.type="dblclick",e(r),o=null}}var o,r,a=!1,h=250;return t[ti+Je+i]=n,t[ti+Qe+i]=s,t[ti+"dblclick"+i]=e,t.addEventListener(Je,n,!1),t.addEventListener(Qe,s,!1),t.addEventListener("dblclick",e,!1),this}function j(t,e){var i=t[ti+Je+e],n=t[ti+Qe+e],s=t[ti+"dblclick"+e];return t.removeEventListener(Je,i,!1),t.removeEventListener(Qe,n,!1),pe||t.removeEventListener("dblclick",s,!1),this}function F(t,e,i,n){if("object"==typeof e)for(var s in e)U(t,s,e[s],i);else for(var o=0,r=(e=l(e)).length;o<r;o++)U(t,e[o],i,n);return this}function W(t,e,i,n){if("object"==typeof e)for(var s in e)H(t,s,e[s],i);else if(e)for(var o=0,r=(e=l(e)).length;o<r;o++)H(t,e[o],i,n);else{for(var a in t[ei])H(t,a,t[ei][a]);delete t[ei]}return this}function U(t,e,i,s){var o=e+n(i)+(s?"_"+n(s):"");if(t[ei]&&t[ei][o])return this;var r=function(e){return i.call(s||t,e||window.event)},a=r;Ie&&0===e.indexOf("touch")?R(t,e,r,o):!Be||"dblclick"!==e||!D||Ie&&we?"addEventListener"in t?"mousewheel"===e?t.addEventListener("onwheel"in t?"wheel":"mousewheel",r,!1):"mouseenter"===e||"mouseleave"===e?(r=function(e){e=e||window.event,tt(t,e)&&a(e)},t.addEventListener("mouseenter"===e?"mouseover":"mouseout",r,!1)):("click"===e&&_e&&(r=function(t){!function(t,e){var i=t.timeStamp||t.originalEvent&&t.originalEvent.timeStamp,n=oe&&i-oe;n&&n>100&&n<500||t.target._simulatedClick&&!t._simulated?G(t):(oe=i,e(t))}(t,a)}),t.addEventListener(e,r,!1)):"attachEvent"in t&&t.attachEvent("on"+e,r):D(t,r,o),t[ei]=t[ei]||{},t[ei][o]=r}function H(t,e,i,s){var o=e+n(i)+(s?"_"+n(s):""),r=t[ei]&&t[ei][o];if(!r)return this;Ie&&0===e.indexOf("touch")?function(t,e,i){var n=t["_leaflet_"+e+i];"touchstart"===e?t.removeEventListener(He,n,!1):"touchmove"===e?t.removeEventListener(Xe,n,!1):"touchend"===e&&(t.removeEventListener(qe,n,!1),t.removeEventListener(Ve,n,!1))}(t,e,o):!Be||"dblclick"!==e||!j||Ie&&we?"removeEventListener"in t?"mousewheel"===e?t.removeEventListener("onwheel"in t?"wheel":"mousewheel",r,!1):t.removeEventListener("mouseenter"===e?"mouseover":"mouseleave"===e?"mouseout":e,r,!1):"detachEvent"in t&&t.detachEvent("on"+e,r):j(t,o),t[ei][o]=null}function X(t){return t.stopPropagation?t.stopPropagation():t.originalEvent?t.originalEvent._stopped=!0:t.cancelBubble=!0,Q(t),this}function q(t){return U(t,"mousewheel",X),this}function V(t){return F(t,"mousedown touchstart dblclick",X),U(t,"click",J),this}function Y(t){return t.preventDefault?t.preventDefault():t.returnValue=!1,this}function G(t){return Y(t),X(t),this}function $(t,e){if(!e)return new v(t.clientX,t.clientY);var i=e.getBoundingClientRect(),n=i.width/e.offsetWidth||1,s=i.height/e.offsetHeight||1;return new v(t.clientX/n-i.left-e.clientLeft,t.clientY/s-i.top-e.clientTop)}function K(t){return pe?t.wheelDeltaY/2:t.deltaY&&0===t.deltaMode?-t.deltaY/ii:t.deltaY&&1===t.deltaMode?20*-t.deltaY:t.deltaY&&2===t.deltaMode?60*-t.deltaY:t.deltaX||t.deltaZ?0:t.wheelDelta?(t.wheelDeltaY||t.wheelDelta)/2:t.detail&&Math.abs(t.detail)<32765?20*-t.detail:t.detail?t.detail/-32765*60:0}function J(t){ni[t.type]=!0}function Q(t){var e=ni[t.type];return ni[t.type]=!1,e}function tt(t,e){var i=e.relatedTarget;if(!i)return!0;try{for(;i&&i!==t;)i=i.parentNode}catch(t){return!1}return i!==t}function et(t){return"string"==typeof t?document.getElementById(t):t}function it(t,e){var i=t.style[e]||t.currentStyle&&t.currentStyle[e];if((!i||"auto"===i)&&document.defaultView){var n=document.defaultView.getComputedStyle(t,null);i=n?n[e]:null}return"auto"===i?null:i}function nt(t,e,i){var n=document.createElement(t);return n.className=e||"",i&&i.appendChild(n),n}function st(t){var e=t.parentNode;e&&e.removeChild(t)}function ot(t){for(;t.firstChild;)t.removeChild(t.firstChild)}function rt(t){var e=t.parentNode;e.lastChild!==t&&e.appendChild(t)}function at(t){var e=t.parentNode;e.firstChild!==t&&e.insertBefore(t,e.firstChild)}function ht(t,e){if(void 0!==t.classList)return t.classList.contains(e);var i=ft(t);return i.length>0&&new RegExp("(^|\\s)"+e+"(\\s|$)").test(i)}function lt(t,e){if(void 0!==t.classList)for(var i=l(e),n=0,s=i.length;n<s;n++)t.classList.add(i[n]);else if(!ht(t,e)){var o=ft(t);ct(t,(o?o+" ":"")+e)}}function ut(t,e){void 0!==t.classList?t.classList.remove(e):ct(t,h((" "+ft(t)+" ").replace(" "+e+" "," ")))}function ct(t,e){void 0===t.className.baseVal?t.className=e:t.className.baseVal=e}function ft(t){return void 0===t.className.baseVal?t.className:t.className.baseVal}function dt(t,e){"opacity"in t.style?t.style.opacity=e:"filter"in t.style&&function(t,e){var i=!1,n="DXImageTransform.Microsoft.Alpha";try{i=t.filters.item(n)}catch(t){if(1===e)return}e=Math.round(100*e),i?(i.Enabled=100!==e,i.Opacity=e):t.style.filter+=" progid:"+n+"(opacity="+e+")"}(t,e)}function pt(t){for(var e=document.documentElement.style,i=0;i<t.length;i++)if(t[i]in e)return t[i];return!1}function mt(t,e,i){var n=e||new v(0,0);t.style[oi]=(Le?"translate("+n.x+"px,"+n.y+"px)":"translate3d("+n.x+"px,"+n.y+"px,0)")+(i?" scale("+i+")":"")}function _t(t,e){t._leaflet_pos=e,Ce?mt(t,e):(t.style.left=e.x+"px",t.style.top=e.y+"px")}function gt(t){return t._leaflet_pos||new v(0,0)}function yt(){F(window,"dragstart",Y)}function vt(){W(window,"dragstart",Y)}function xt(t){for(;-1===t.tabIndex;)t=t.parentNode;t.style&&(wt(),li=t,ui=t.style.outline,t.style.outline="none",F(window,"keydown",wt))}function wt(){li&&(li.style.outline=ui,li=void 0,ui=void 0,W(window,"keydown",wt))}function bt(t,e){if(!e||!t.length)return t.slice();var i=e*e;return function(t,e){var i=t.length,n=new(typeof Uint8Array!=void 0+""?Uint8Array:Array)(i);n[0]=n[i-1]=1,function t(e,i,n,s,o){var r,a,h,l=0;for(a=s+1;a<=o-1;a++)(h=kt(e[a],e[s],e[o],!0))>l&&(r=a,l=h);l>n&&(i[r]=1,t(e,i,n,s,r),t(e,i,n,r,o))}(t,n,e,0,i-1);var s,o=[];for(s=0;s<i;s++)n[s]&&o.push(t[s]);return o}(t=function(t,e){for(var i=[t[0]],n=1,s=0,o=t.length;n<o;n++)Lt(t[n],t[s])>e&&(i.push(t[n]),s=n);return s<o-1&&i.push(t[o-1]),i}(t,i),i)}function Pt(t,e,i){return Math.sqrt(kt(t,e,i,!0))}function Mt(t,e,i,n,s){var o,r,a,h=n?wi:St(t,i),l=St(e,i);for(wi=l;;){if(!(h|l))return[t,e];if(h&l)return!1;a=St(r=Tt(t,e,o=h||l,i,s),i),o===h?(t=r,h=a):(e=r,l=a)}}function Tt(t,e,i,n,s){var o,r,a=e.x-t.x,h=e.y-t.y,l=n.min,u=n.max;return 8&i?(o=t.x+a*(u.y-t.y)/h,r=u.y):4&i?(o=t.x+a*(l.y-t.y)/h,r=l.y):2&i?(o=u.x,r=t.y+h*(u.x-t.x)/a):1&i&&(o=l.x,r=t.y+h*(l.x-t.x)/a),new v(o,r,s)}function St(t,e){var i=0;return t.x<e.min.x?i|=1:t.x>e.max.x&&(i|=2),t.y<e.min.y?i|=4:t.y>e.max.y&&(i|=8),i}function Lt(t,e){var i=e.x-t.x,n=e.y-t.y;return i*i+n*n}function kt(t,e,i,n){var s,o=e.x,r=e.y,a=i.x-o,h=i.y-r,l=a*a+h*h;return l>0&&((s=((t.x-o)*a+(t.y-r)*h)/l)>1?(o=i.x,r=i.y):s>0&&(o+=a*s,r+=h*s)),a=t.x-o,h=t.y-r,n?a*a+h*h:new v(o,r)}function Et(t){return!Vt(t[0])||"object"!=typeof t[0][0]&&void 0!==t[0][0]}function Ct(t){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),Et(t)}function At(t,e,i){var n,s,o,r,a,h,l,u,c,f=[1,4,2,8];for(s=0,l=t.length;s<l;s++)t[s]._code=St(t[s],e);for(r=0;r<4;r++){for(u=f[r],n=[],s=0,o=(l=t.length)-1;s<l;o=s++)a=t[s],h=t[o],a._code&u?h._code&u||((c=Tt(h,a,u,e,i))._code=St(c,e),n.push(c)):(h._code&u&&((c=Tt(h,a,u,e,i))._code=St(c,e),n.push(c)),n.push(a));t=n}return t}function Ot(t,e){var i,n,s,o,r="Feature"===t.type?t.geometry:t,a=r?r.coordinates:null,h=[],l=e&&e.pointToLayer,u=e&&e.coordsToLatLng||Rt;if(!a&&!r)return null;switch(r.type){case"Point":return i=u(a),l?l(t,i):new Fi(i);case"MultiPoint":for(s=0,o=a.length;s<o;s++)i=u(a[s]),h.push(l?l(t,i):new Fi(i));return new Ni(h);case"LineString":case"MultiLineString":return n=zt(a,"LineString"===r.type?0:1,u),new Xi(n,e);case"Polygon":case"MultiPolygon":return n=zt(a,"Polygon"===r.type?1:2,u),new qi(n,e);case"GeometryCollection":for(s=0,o=r.geometries.length;s<o;s++){var c=Ot({geometry:r.geometries[s],type:"Feature",properties:t.properties},e);c&&h.push(c)}return new Ni(h);default:throw new Error("Invalid GeoJSON object.")}}function Rt(t){return new T(t[1],t[0],t[2])}function zt(t,e,i){for(var n,s=[],o=0,r=t.length;o<r;o++)n=e?zt(t[o],e-1,i):(i||Rt)(t[o]),s.push(n);return s}function It(t,e){return e="number"==typeof e?e:6,void 0!==t.alt?[a(t.lng,e),a(t.lat,e),a(t.alt,e)]:[a(t.lng,e),a(t.lat,e)]}function Bt(t,e,i,n){for(var s=[],o=0,r=t.length;o<r;o++)s.push(e?Bt(t[o],e-1,i,n):It(t[o],n));return!e&&i&&s.push(s[0]),s}function Nt(t,i){return t.feature?e({},t.feature,{geometry:i}):Zt(i)}function Zt(t){return"Feature"===t.type||"FeatureCollection"===t.type?t:{type:"Feature",properties:{},geometry:t}}function Dt(t,e){return new Vi(t,e)}function jt(t,e){return new sn(t,e)}function Ft(t){return je?new an(t):null}function Wt(t){return Fe||We?new cn(t):null}var Ut=Object.freeze;Object.freeze=function(t){return t};var Ht=Object.create||function(){function t(){}return function(e){return t.prototype=e,new t}}(),Xt=0,qt=/\{ *([\w_-]+) *\}/g,Vt=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},Yt="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=",Gt=0,$t=window.requestAnimationFrame||p("RequestAnimationFrame")||m,Kt=window.cancelAnimationFrame||p("CancelAnimationFrame")||p("CancelRequestAnimationFrame")||function(t){window.clearTimeout(t)},Jt=(Object.freeze||Object)({freeze:Ut,extend:e,create:Ht,bind:i,lastId:Xt,stamp:n,throttle:s,wrapNum:o,falseFn:r,formatNum:a,trim:h,splitWords:l,setOptions:u,getParamString:c,template:f,isArray:Vt,indexOf:d,emptyImageUrl:Yt,requestFn:$t,cancelFn:Kt,requestAnimFrame:_,cancelAnimFrame:g});y.extend=function(t){var i=function(){this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},n=i.__super__=this.prototype,s=Ht(n);for(var o in s.constructor=i,i.prototype=s,this)this.hasOwnProperty(o)&&"prototype"!==o&&"__super__"!==o&&(i[o]=this[o]);return t.statics&&(e(i,t.statics),delete t.statics),t.includes&&(function(t){if("undefined"!=typeof L&&L&&L.Mixin){t=Vt(t)?t:[t];for(var e=0;e<t.length;e++)t[e]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",(new Error).stack)}}(t.includes),e.apply(null,[s].concat(t.includes)),delete t.includes),s.options&&(t.options=e(Ht(s.options),t.options)),e(s,t),s._initHooks=[],s.callInitHooks=function(){if(!this._initHooksCalled){n.callInitHooks&&n.callInitHooks.call(this),this._initHooksCalled=!0;for(var t=0,e=s._initHooks.length;t<e;t++)s._initHooks[t].call(this)}},i},y.include=function(t){return e(this.prototype,t),this},y.mergeOptions=function(t){return e(this.prototype.options,t),this},y.addInitHook=function(t){var e=Array.prototype.slice.call(arguments,1),i="function"==typeof t?t:function(){this[t].apply(this,e)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(i),this};var Qt={on:function(t,e,i){if("object"==typeof t)for(var n in t)this._on(n,t[n],e);else for(var s=0,o=(t=l(t)).length;s<o;s++)this._on(t[s],e,i);return this},off:function(t,e,i){if(t)if("object"==typeof t)for(var n in t)this._off(n,t[n],e);else for(var s=0,o=(t=l(t)).length;s<o;s++)this._off(t[s],e,i);else delete this._events;return this},_on:function(t,e,i){this._events=this._events||{};var n=this._events[t];n||(n=[],this._events[t]=n),i===this&&(i=void 0);for(var s={fn:e,ctx:i},o=n,r=0,a=o.length;r<a;r++)if(o[r].fn===e&&o[r].ctx===i)return;o.push(s)},_off:function(t,e,i){var n,s,o;if(this._events&&(n=this._events[t]))if(e){if(i===this&&(i=void 0),n)for(s=0,o=n.length;s<o;s++){var a=n[s];if(a.ctx===i&&a.fn===e)return a.fn=r,this._firingCount&&(this._events[t]=n=n.slice()),void n.splice(s,1)}}else{for(s=0,o=n.length;s<o;s++)n[s].fn=r;delete this._events[t]}},fire:function(t,i,n){if(!this.listens(t,n))return this;var s=e({},i,{type:t,target:this,sourceTarget:i&&i.sourceTarget||this});if(this._events){var o=this._events[t];if(o){this._firingCount=this._firingCount+1||1;for(var r=0,a=o.length;r<a;r++){var h=o[r];h.fn.call(h.ctx||this,s)}this._firingCount--}}return n&&this._propagateEvent(s),this},listens:function(t,e){var i=this._events&&this._events[t];if(i&&i.length)return!0;if(e)for(var n in this._eventParents)if(this._eventParents[n].listens(t,e))return!0;return!1},once:function(t,e,n){if("object"==typeof t){for(var s in t)this.once(s,t[s],e);return this}var o=i(function(){this.off(t,e,n).off(t,o,n)},this);return this.on(t,e,n).on(t,o,n)},addEventParent:function(t){return this._eventParents=this._eventParents||{},this._eventParents[n(t)]=t,this},removeEventParent:function(t){return this._eventParents&&delete this._eventParents[n(t)],this},_propagateEvent:function(t){for(var i in this._eventParents)this._eventParents[i].fire(t.type,e({layer:t.target,propagatedFrom:t.target},t),!0)}};Qt.addEventListener=Qt.on,Qt.removeEventListener=Qt.clearAllEventListeners=Qt.off,Qt.addOneTimeEventListener=Qt.once,Qt.fireEvent=Qt.fire,Qt.hasEventListeners=Qt.listens;var te=y.extend(Qt),ee=Math.trunc||function(t){return t>0?Math.floor(t):Math.ceil(t)};v.prototype={clone:function(){return new v(this.x,this.y)},add:function(t){return this.clone()._add(x(t))},_add:function(t){return this.x+=t.x,this.y+=t.y,this},subtract:function(t){return this.clone()._subtract(x(t))},_subtract:function(t){return this.x-=t.x,this.y-=t.y,this},divideBy:function(t){return this.clone()._divideBy(t)},_divideBy:function(t){return this.x/=t,this.y/=t,this},multiplyBy:function(t){return this.clone()._multiplyBy(t)},_multiplyBy:function(t){return this.x*=t,this.y*=t,this},scaleBy:function(t){return new v(this.x*t.x,this.y*t.y)},unscaleBy:function(t){return new v(this.x/t.x,this.y/t.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=ee(this.x),this.y=ee(this.y),this},distanceTo:function(t){var e=(t=x(t)).x-this.x,i=t.y-this.y;return Math.sqrt(e*e+i*i)},equals:function(t){return(t=x(t)).x===this.x&&t.y===this.y},contains:function(t){return t=x(t),Math.abs(t.x)<=Math.abs(this.x)&&Math.abs(t.y)<=Math.abs(this.y)},toString:function(){return"Point("+a(this.x)+", "+a(this.y)+")"}},w.prototype={extend:function(t){return t=x(t),this.min||this.max?(this.min.x=Math.min(t.x,this.min.x),this.max.x=Math.max(t.x,this.max.x),this.min.y=Math.min(t.y,this.min.y),this.max.y=Math.max(t.y,this.max.y)):(this.min=t.clone(),this.max=t.clone()),this},getCenter:function(t){return new v((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,t)},getBottomLeft:function(){return new v(this.min.x,this.max.y)},getTopRight:function(){return new v(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(t){var e,i;return(t="number"==typeof t[0]||t instanceof v?x(t):b(t))instanceof w?(e=t.min,i=t.max):e=i=t,e.x>=this.min.x&&i.x<=this.max.x&&e.y>=this.min.y&&i.y<=this.max.y},intersects:function(t){t=b(t);var e=this.min,i=this.max,n=t.min,s=t.max,o=s.x>=e.x&&n.x<=i.x,r=s.y>=e.y&&n.y<=i.y;return o&&r},overlaps:function(t){t=b(t);var e=this.min,i=this.max,n=t.min,s=t.max,o=s.x>e.x&&n.x<i.x,r=s.y>e.y&&n.y<i.y;return o&&r},isValid:function(){return!(!this.min||!this.max)}},P.prototype={extend:function(t){var e,i,n=this._southWest,s=this._northEast;if(t instanceof T)e=t,i=t;else{if(!(t instanceof P))return t?this.extend(S(t)||M(t)):this;if(e=t._southWest,i=t._northEast,!e||!i)return this}return n||s?(n.lat=Math.min(e.lat,n.lat),n.lng=Math.min(e.lng,n.lng),s.lat=Math.max(i.lat,s.lat),s.lng=Math.max(i.lng,s.lng)):(this._southWest=new T(e.lat,e.lng),this._northEast=new T(i.lat,i.lng)),this},pad:function(t){var e=this._southWest,i=this._northEast,n=Math.abs(e.lat-i.lat)*t,s=Math.abs(e.lng-i.lng)*t;return new P(new T(e.lat-n,e.lng-s),new T(i.lat+n,i.lng+s))},getCenter:function(){return new T((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new T(this.getNorth(),this.getWest())},getSouthEast:function(){return new T(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(t){t="number"==typeof t[0]||t instanceof T||"lat"in t?S(t):M(t);var e,i,n=this._southWest,s=this._northEast;return t instanceof P?(e=t.getSouthWest(),i=t.getNorthEast()):e=i=t,e.lat>=n.lat&&i.lat<=s.lat&&e.lng>=n.lng&&i.lng<=s.lng},intersects:function(t){t=M(t);var e=this._southWest,i=this._northEast,n=t.getSouthWest(),s=t.getNorthEast(),o=s.lat>=e.lat&&n.lat<=i.lat,r=s.lng>=e.lng&&n.lng<=i.lng;return o&&r},overlaps:function(t){t=M(t);var e=this._southWest,i=this._northEast,n=t.getSouthWest(),s=t.getNorthEast(),o=s.lat>e.lat&&n.lat<i.lat,r=s.lng>e.lng&&n.lng<i.lng;return o&&r},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(t,e){return!!t&&(t=M(t),this._southWest.equals(t.getSouthWest(),e)&&this._northEast.equals(t.getNorthEast(),e))},isValid:function(){return!(!this._southWest||!this._northEast)}},T.prototype={equals:function(t,e){return!!t&&(t=S(t),Math.max(Math.abs(this.lat-t.lat),Math.abs(this.lng-t.lng))<=(void 0===e?1e-9:e))},toString:function(t){return"LatLng("+a(this.lat,t)+", "+a(this.lng,t)+")"},distanceTo:function(t){return ne.distance(this,S(t))},wrap:function(){return ne.wrapLatLng(this)},toBounds:function(t){var e=180*t/40075017,i=e/Math.cos(Math.PI/180*this.lat);return M([this.lat-e,this.lng-i],[this.lat+e,this.lng+i])},clone:function(){return new T(this.lat,this.lng,this.alt)}};var ie={latLngToPoint:function(t,e){var i=this.projection.project(t),n=this.scale(e);return this.transformation._transform(i,n)},pointToLatLng:function(t,e){var i=this.scale(e),n=this.transformation.untransform(t,i);return this.projection.unproject(n)},project:function(t){return this.projection.project(t)},unproject:function(t){return this.projection.unproject(t)},scale:function(t){return 256*Math.pow(2,t)},zoom:function(t){return Math.log(t/256)/Math.LN2},getProjectedBounds:function(t){if(this.infinite)return null;var e=this.projection.bounds,i=this.scale(t);return new w(this.transformation.transform(e.min,i),this.transformation.transform(e.max,i))},infinite:!1,wrapLatLng:function(t){var e=this.wrapLng?o(t.lng,this.wrapLng,!0):t.lng;return new T(this.wrapLat?o(t.lat,this.wrapLat,!0):t.lat,e,t.alt)},wrapLatLngBounds:function(t){var e=t.getCenter(),i=this.wrapLatLng(e),n=e.lat-i.lat,s=e.lng-i.lng;if(0===n&&0===s)return t;var o=t.getSouthWest(),r=t.getNorthEast();return new P(new T(o.lat-n,o.lng-s),new T(r.lat-n,r.lng-s))}},ne=e({},ie,{wrapLng:[-180,180],R:6371e3,distance:function(t,e){var i=Math.PI/180,n=t.lat*i,s=e.lat*i,o=Math.sin((e.lat-t.lat)*i/2),r=Math.sin((e.lng-t.lng)*i/2),a=o*o+Math.cos(n)*Math.cos(s)*r*r,h=2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a));return this.R*h}}),se={R:6378137,MAX_LATITUDE:85.0511287798,project:function(t){var e=Math.PI/180,i=this.MAX_LATITUDE,n=Math.max(Math.min(i,t.lat),-i),s=Math.sin(n*e);return new v(this.R*t.lng*e,this.R*Math.log((1+s)/(1-s))/2)},unproject:function(t){var e=180/Math.PI;return new T((2*Math.atan(Math.exp(t.y/this.R))-Math.PI/2)*e,t.x*e/this.R)},bounds:function(){var t=6378137*Math.PI;return new w([-t,-t],[t,t])}()};k.prototype={transform:function(t,e){return this._transform(t.clone(),e)},_transform:function(t,e){return e=e||1,t.x=e*(this._a*t.x+this._b),t.y=e*(this._c*t.y+this._d),t},untransform:function(t,e){return e=e||1,new v((t.x/e-this._b)/this._a,(t.y/e-this._d)/this._c)}};var oe,re,ae,he,le=e({},ne,{code:"EPSG:3857",projection:se,transformation:function(){var t=.5/(Math.PI*se.R);return E(t,.5,-t,.5)}()}),ue=e({},le,{code:"EPSG:900913"}),ce=document.documentElement.style,fe="ActiveXObject"in window,de=fe&&!document.addEventListener,pe="msLaunchUri"in navigator&&!("documentMode"in document),me=O("webkit"),_e=O("android"),ge=O("android 2")||O("android 3"),ye=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),ve=_e&&O("Google")&&ye<537&&!("AudioNode"in window),xe=!!window.opera,we=O("chrome"),be=O("gecko")&&!me&&!xe&&!fe,Pe=!we&&O("safari"),Me=O("phantom"),Te="OTransition"in ce,Se=0===navigator.platform.indexOf("Win"),Le=fe&&"transition"in ce,ke="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!ge,Ee="MozPerspective"in ce,Ce=!window.L_DISABLE_3D&&(Le||ke||Ee)&&!Te&&!Me,Ae="undefined"!=typeof orientation||O("mobile"),Oe=Ae&&me,Re=Ae&&ke,ze=!window.PointerEvent&&window.MSPointerEvent,Ie=!(!window.PointerEvent&&!ze),Be=!window.L_NO_TOUCH&&(Ie||"ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch),Ne=Ae&&xe,Ze=Ae&&be,De=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,je=!!document.createElement("canvas").getContext,Fe=!(!document.createElementNS||!C("svg").createSVGRect),We=!Fe&&function(){try{var t=document.createElement("div");t.innerHTML='<v:shape adj="1"/>';var e=t.firstChild;return e.style.behavior="url(#default#VML)",e&&"object"==typeof e.adj}catch(t){return!1}}(),Ue=(Object.freeze||Object)({ie:fe,ielt9:de,edge:pe,webkit:me,android:_e,android23:ge,androidStock:ve,opera:xe,chrome:we,gecko:be,safari:Pe,phantom:Me,opera12:Te,win:Se,ie3d:Le,webkit3d:ke,gecko3d:Ee,any3d:Ce,mobile:Ae,mobileWebkit:Oe,mobileWebkit3d:Re,msPointer:ze,pointer:Ie,touch:Be,mobileOpera:Ne,mobileGecko:Ze,retina:De,canvas:je,svg:Fe,vml:We}),He=ze?"MSPointerDown":"pointerdown",Xe=ze?"MSPointerMove":"pointermove",qe=ze?"MSPointerUp":"pointerup",Ve=ze?"MSPointerCancel":"pointercancel",Ye=["INPUT","SELECT","OPTION"],Ge={},$e=!1,Ke=0,Je=ze?"MSPointerDown":Ie?"pointerdown":"touchstart",Qe=ze?"MSPointerUp":Ie?"pointerup":"touchend",ti="_leaflet_",ei="_leaflet_events",ii=Se&&we?2*window.devicePixelRatio:be?window.devicePixelRatio:1,ni={},si=(Object.freeze||Object)({on:F,off:W,stopPropagation:X,disableScrollPropagation:q,disableClickPropagation:V,preventDefault:Y,stop:G,getMousePosition:$,getWheelDelta:K,fakeStop:J,skipped:Q,isExternalTarget:tt,addListener:F,removeListener:W}),oi=pt(["transform","WebkitTransform","OTransform","MozTransform","msTransform"]),ri=pt(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),ai="webkitTransition"===ri||"OTransition"===ri?ri+"End":"transitionend";if("onselectstart"in document)re=function(){F(window,"selectstart",Y)},ae=function(){W(window,"selectstart",Y)};else{var hi=pt(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);re=function(){if(hi){var t=document.documentElement.style;he=t[hi],t[hi]="none"}},ae=function(){hi&&(document.documentElement.style[hi]=he,he=void 0)}}var li,ui,ci=(Object.freeze||Object)({TRANSFORM:oi,TRANSITION:ri,TRANSITION_END:ai,get:et,getStyle:it,create:nt,remove:st,empty:ot,toFront:rt,toBack:at,hasClass:ht,addClass:lt,removeClass:ut,setClass:ct,getClass:ft,setOpacity:dt,testProp:pt,setTransform:mt,setPosition:_t,getPosition:gt,disableTextSelection:re,enableTextSelection:ae,disableImageDrag:yt,enableImageDrag:vt,preventOutline:xt,restoreOutline:wt}),fi=te.extend({run:function(t,e,i,n){this.stop(),this._el=t,this._inProgress=!0,this._duration=i||.25,this._easeOutPower=1/Math.max(n||.5,.2),this._startPos=gt(t),this._offset=e.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=_(this._animate,this),this._step()},_step:function(t){var e=+new Date-this._startTime,i=1e3*this._duration;e<i?this._runFrame(this._easeOut(e/i),t):(this._runFrame(1),this._complete())},_runFrame:function(t,e){var i=this._startPos.add(this._offset.multiplyBy(t));e&&i._round(),_t(this._el,i),this.fire("step")},_complete:function(){g(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(t){return 1-Math.pow(1-t,this._easeOutPower)}}),di=te.extend({options:{crs:le,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(t,e){e=u(this,e),this._initContainer(t),this._initLayout(),this._onResize=i(this._onResize,this),this._initEvents(),e.maxBounds&&this.setMaxBounds(e.maxBounds),void 0!==e.zoom&&(this._zoom=this._limitZoom(e.zoom)),e.center&&void 0!==e.zoom&&this.setView(S(e.center),e.zoom,{reset:!0}),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this.callInitHooks(),this._zoomAnimated=ri&&Ce&&!Ne&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),F(this._proxy,ai,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(t,i,n){return i=void 0===i?this._zoom:this._limitZoom(i),t=this._limitCenter(S(t),i,this.options.maxBounds),n=n||{},this._stop(),this._loaded&&!n.reset&&!0!==n&&(void 0!==n.animate&&(n.zoom=e({animate:n.animate},n.zoom),n.pan=e({animate:n.animate,duration:n.duration},n.pan)),this._zoom!==i?this._tryAnimatedZoom&&this._tryAnimatedZoom(t,i,n.zoom):this._tryAnimatedPan(t,n.pan))?(clearTimeout(this._sizeTimer),this):(this._resetView(t,i),this)},setZoom:function(t,e){return this._loaded?this.setView(this.getCenter(),t,{zoom:e}):(this._zoom=t,this)},zoomIn:function(t,e){return t=t||(Ce?this.options.zoomDelta:1),this.setZoom(this._zoom+t,e)},zoomOut:function(t,e){return t=t||(Ce?this.options.zoomDelta:1),this.setZoom(this._zoom-t,e)},setZoomAround:function(t,e,i){var n=this.getZoomScale(e),s=this.getSize().divideBy(2),o=(t instanceof v?t:this.latLngToContainerPoint(t)).subtract(s).multiplyBy(1-1/n),r=this.containerPointToLatLng(s.add(o));return this.setView(r,e,{zoom:i})},_getBoundsCenterZoom:function(t,e){e=e||{},t=t.getBounds?t.getBounds():M(t);var i=x(e.paddingTopLeft||e.padding||[0,0]),n=x(e.paddingBottomRight||e.padding||[0,0]),s=this.getBoundsZoom(t,!1,i.add(n));if((s="number"==typeof e.maxZoom?Math.min(e.maxZoom,s):s)===1/0)return{center:t.getCenter(),zoom:s};var o=n.subtract(i).divideBy(2),r=this.project(t.getSouthWest(),s),a=this.project(t.getNorthEast(),s);return{center:this.unproject(r.add(a).divideBy(2).add(o),s),zoom:s}},fitBounds:function(t,e){if(!(t=M(t)).isValid())throw new Error("Bounds are not valid.");var i=this._getBoundsCenterZoom(t,e);return this.setView(i.center,i.zoom,e)},fitWorld:function(t){return this.fitBounds([[-90,-180],[90,180]],t)},panTo:function(t,e){return this.setView(t,this._zoom,{pan:e})},panBy:function(t,e){if(t=x(t).round(),e=e||{},!t.x&&!t.y)return this.fire("moveend");if(!0!==e.animate&&!this.getSize().contains(t))return this._resetView(this.unproject(this.project(this.getCenter()).add(t)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new fi,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),e.noMoveStart||this.fire("movestart"),!1!==e.animate){lt(this._mapPane,"leaflet-pan-anim");var i=this._getMapPanePos().subtract(t).round();this._panAnim.run(this._mapPane,i,e.duration||.25,e.easeLinearity)}else this._rawPanBy(t),this.fire("move").fire("moveend");return this},flyTo:function(t,e,i){function n(t){var e=(f*f-c*c+(t?-1:1)*m*m*d*d)/(2*(t?f:c)*m*d),i=Math.sqrt(e*e+1)-e;return i<1e-9?-18:Math.log(i)}function s(t){return(Math.exp(t)-Math.exp(-t))/2}function o(t){return(Math.exp(t)+Math.exp(-t))/2}function r(t){return c*(o(g)*function(t){return s(t)/o(t)}(g+p*t)-s(g))/m}if(!1===(i=i||{}).animate||!Ce)return this.setView(t,e,i);this._stop();var a=this.project(this.getCenter()),h=this.project(t),l=this.getSize(),u=this._zoom;t=S(t),e=void 0===e?u:e;var c=Math.max(l.x,l.y),f=c*this.getZoomScale(u,e),d=h.distanceTo(a)||1,p=1.42,m=p*p,g=n(0),y=Date.now(),v=(n(1)-g)/p,x=i.duration?1e3*i.duration:1e3*v*.8;return this._moveStart(!0,i.noMoveStart),function i(){var n=(Date.now()-y)/x,s=function(t){return 1-Math.pow(1-t,1.5)}(n)*v;n<=1?(this._flyToFrame=_(i,this),this._move(this.unproject(a.add(h.subtract(a).multiplyBy(r(s)/d)),u),this.getScaleZoom(c/function(t){return c*(o(g)/o(g+p*t))}(s),u),{flyTo:!0})):this._move(t,e)._moveEnd(!0)}.call(this),this},flyToBounds:function(t,e){var i=this._getBoundsCenterZoom(t,e);return this.flyTo(i.center,i.zoom,e)},setMaxBounds:function(t){return(t=M(t)).isValid()?(this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this.options.maxBounds=t,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this.off("moveend",this._panInsideMaxBounds))},setMinZoom:function(t){var e=this.options.minZoom;return this.options.minZoom=t,this._loaded&&e!==t&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(t):this},setMaxZoom:function(t){var e=this.options.maxZoom;return this.options.maxZoom=t,this._loaded&&e!==t&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(t):this},panInsideBounds:function(t,e){this._enforcingBounds=!0;var i=this.getCenter(),n=this._limitCenter(i,this._zoom,M(t));return i.equals(n)||this.panTo(n,e),this._enforcingBounds=!1,this},invalidateSize:function(t){if(!this._loaded)return this;t=e({animate:!1,pan:!0},!0===t?{animate:!0}:t);var n=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var s=this.getSize(),o=n.divideBy(2).round(),r=s.divideBy(2).round(),a=o.subtract(r);return a.x||a.y?(t.animate&&t.pan?this.panBy(a):(t.pan&&this._rawPanBy(a),this.fire("move"),t.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(i(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:n,newSize:s})):this},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(t){if(t=this._locateOptions=e({timeout:1e4,watch:!1},t),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var n=i(this._handleGeolocationResponse,this),s=i(this._handleGeolocationError,this);return t.watch?this._locationWatchId=navigator.geolocation.watchPosition(n,s,t):navigator.geolocation.getCurrentPosition(n,s,t),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(t){var e=t.code,i=t.message||(1===e?"permission denied":2===e?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:e,message:"Geolocation error: "+i+"."})},_handleGeolocationResponse:function(t){var e=new T(t.coords.latitude,t.coords.longitude),i=e.toBounds(t.coords.accuracy),n=this._locateOptions;if(n.setView){var s=this.getBoundsZoom(i);this.setView(e,n.maxZoom?Math.min(s,n.maxZoom):s)}var o={latlng:e,bounds:i,timestamp:t.timestamp};for(var r in t.coords)"number"==typeof t.coords[r]&&(o[r]=t.coords[r]);this.fire("locationfound",o)},addHandler:function(t,e){if(!e)return this;var i=this[t]=new e(this);return this._handlers.push(i),this.options[t]&&i.enable(),this},remove:function(){if(this._initEvents(!0),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch(t){this._container._leaflet_id=void 0,this._containerId=void 0}var t;for(t in void 0!==this._locationWatchId&&this.stopLocate(),this._stop(),st(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._clearHandlers(),this._loaded&&this.fire("unload"),this._layers)this._layers[t].remove();for(t in this._panes)st(this._panes[t]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(t,e){var i=nt("div","leaflet-pane"+(t?" leaflet-"+t.replace("Pane","")+"-pane":""),e||this._mapPane);return t&&(this._panes[t]=i),i},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter:this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var t=this.getPixelBounds();return new P(this.unproject(t.getBottomLeft()),this.unproject(t.getTopRight()))},getMinZoom:function(){return void 0===this.options.minZoom?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return void 0===this.options.maxZoom?void 0===this._layersMaxZoom?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(t,e,i){t=M(t),i=x(i||[0,0]);var n=this.getZoom()||0,s=this.getMinZoom(),o=this.getMaxZoom(),r=t.getNorthWest(),a=t.getSouthEast(),h=this.getSize().subtract(i),l=b(this.project(a,n),this.project(r,n)).getSize(),u=Ce?this.options.zoomSnap:1,c=h.x/l.x,f=h.y/l.y,d=e?Math.max(c,f):Math.min(c,f);return n=this.getScaleZoom(d,n),u&&(n=Math.round(n/(u/100))*(u/100),n=e?Math.ceil(n/u)*u:Math.floor(n/u)*u),Math.max(s,Math.min(o,n))},getSize:function(){return this._size&&!this._sizeChanged||(this._size=new v(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(t,e){var i=this._getTopLeftPoint(t,e);return new w(i,i.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(t){return this.options.crs.getProjectedBounds(void 0===t?this.getZoom():t)},getPane:function(t){return"string"==typeof t?this._panes[t]:t},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(t,e){var i=this.options.crs;return e=void 0===e?this._zoom:e,i.scale(t)/i.scale(e)},getScaleZoom:function(t,e){var i=this.options.crs;e=void 0===e?this._zoom:e;var n=i.zoom(t*i.scale(e));return isNaN(n)?1/0:n},project:function(t,e){return e=void 0===e?this._zoom:e,this.options.crs.latLngToPoint(S(t),e)},unproject:function(t,e){return e=void 0===e?this._zoom:e,this.options.crs.pointToLatLng(x(t),e)},layerPointToLatLng:function(t){var e=x(t).add(this.getPixelOrigin());return this.unproject(e)},latLngToLayerPoint:function(t){return this.project(S(t))._round()._subtract(this.getPixelOrigin())},wrapLatLng:function(t){return this.options.crs.wrapLatLng(S(t))},wrapLatLngBounds:function(t){return this.options.crs.wrapLatLngBounds(M(t))},distance:function(t,e){return this.options.crs.distance(S(t),S(e))},containerPointToLayerPoint:function(t){return x(t).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(t){return x(t).add(this._getMapPanePos())},containerPointToLatLng:function(t){var e=this.containerPointToLayerPoint(x(t));return this.layerPointToLatLng(e)},latLngToContainerPoint:function(t){return this.layerPointToContainerPoint(this.latLngToLayerPoint(S(t)))},mouseEventToContainerPoint:function(t){return $(t,this._container)},mouseEventToLayerPoint:function(t){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(t))},mouseEventToLatLng:function(t){return this.layerPointToLatLng(this.mouseEventToLayerPoint(t))},_initContainer:function(t){var e=this._container=et(t);if(!e)throw new Error("Map container not found.");if(e._leaflet_id)throw new Error("Map container is already initialized.");F(e,"scroll",this._onScroll,this),this._containerId=n(e)},_initLayout:function(){var t=this._container;this._fadeAnimated=this.options.fadeAnimation&&Ce,lt(t,"leaflet-container"+(Be?" leaflet-touch":"")+(De?" leaflet-retina":"")+(de?" leaflet-oldie":"")+(Pe?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var e=it(t,"position");"absolute"!==e&&"relative"!==e&&"fixed"!==e&&(t.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var t=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),_t(this._mapPane,new v(0,0)),this.createPane("tilePane"),this.createPane("shadowPane"),this.createPane("overlayPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(lt(t.markerPane,"leaflet-zoom-hide"),lt(t.shadowPane,"leaflet-zoom-hide"))},_resetView:function(t,e){_t(this._mapPane,new v(0,0));var i=!this._loaded;this._loaded=!0,e=this._limitZoom(e),this.fire("viewprereset");var n=this._zoom!==e;this._moveStart(n,!1)._move(t,e)._moveEnd(n),this.fire("viewreset"),i&&this.fire("load")},_moveStart:function(t,e){return t&&this.fire("zoomstart"),e||this.fire("movestart"),this},_move:function(t,e,i){void 0===e&&(e=this._zoom);var n=this._zoom!==e;return this._zoom=e,this._lastCenter=t,this._pixelOrigin=this._getNewPixelOrigin(t),(n||i&&i.pinch)&&this.fire("zoom",i),this.fire("move",i)},_moveEnd:function(t){return t&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return g(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(t){_t(this._mapPane,this._getMapPanePos().subtract(t))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(t){this._targets={},this._targets[n(this._container)]=this;var e=t?W:F;e(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress",this._handleDOMEvent,this),this.options.trackResize&&e(window,"resize",this._onResize,this),Ce&&this.options.transform3DLimit&&(t?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){g(this._resizeRequest),this._resizeRequest=_(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var t=this._getMapPanePos();Math.max(Math.abs(t.x),Math.abs(t.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(t,e){for(var i,s=[],o="mouseout"===e||"mouseover"===e,r=t.target||t.srcElement,a=!1;r;){if((i=this._targets[n(r)])&&("click"===e||"preclick"===e)&&!t._simulated&&this._draggableMoved(i)){a=!0;break}if(i&&i.listens(e,!0)){if(o&&!tt(r,t))break;if(s.push(i),o)break}if(r===this._container)break;r=r.parentNode}return s.length||a||o||!tt(r,t)||(s=[this]),s},_handleDOMEvent:function(t){if(this._loaded&&!Q(t)){var e=t.type;"mousedown"!==e&&"keypress"!==e||xt(t.target||t.srcElement),this._fireDOMEvent(t,e)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(t,i,n){if("click"===t.type){var s=e({},t);s.type="preclick",this._fireDOMEvent(s,s.type,n)}if(!t._stopped&&(n=(n||[]).concat(this._findEventTargets(t,i))).length){var o=n[0];"contextmenu"===i&&o.listens(i,!0)&&Y(t);var r={originalEvent:t};if("keypress"!==t.type){var a=o.getLatLng&&(!o._radius||o._radius<=10);r.containerPoint=a?this.latLngToContainerPoint(o.getLatLng()):this.mouseEventToContainerPoint(t),r.layerPoint=this.containerPointToLayerPoint(r.containerPoint),r.latlng=a?o.getLatLng():this.layerPointToLatLng(r.layerPoint)}for(var h=0;h<n.length;h++)if(n[h].fire(i,r,!0),r.originalEvent._stopped||!1===n[h].options.bubblingMouseEvents&&-1!==d(this._mouseEvents,i))return}},_draggableMoved:function(t){return(t=t.dragging&&t.dragging.enabled()?t:this).dragging&&t.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var t=0,e=this._handlers.length;t<e;t++)this._handlers[t].disable()},whenReady:function(t,e){return this._loaded?t.call(e||this,{target:this}):this.on("load",t,e),this},_getMapPanePos:function(){return gt(this._mapPane)||new v(0,0)},_moved:function(){var t=this._getMapPanePos();return t&&!t.equals([0,0])},_getTopLeftPoint:function(t,e){return(t&&void 0!==e?this._getNewPixelOrigin(t,e):this.getPixelOrigin()).subtract(this._getMapPanePos())},_getNewPixelOrigin:function(t,e){var i=this.getSize()._divideBy(2);return this.project(t,e)._subtract(i)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(t,e,i){var n=this._getNewPixelOrigin(i,e);return this.project(t,e)._subtract(n)},_latLngBoundsToNewLayerBounds:function(t,e,i){var n=this._getNewPixelOrigin(i,e);return b([this.project(t.getSouthWest(),e)._subtract(n),this.project(t.getNorthWest(),e)._subtract(n),this.project(t.getSouthEast(),e)._subtract(n),this.project(t.getNorthEast(),e)._subtract(n)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(t){return this.latLngToLayerPoint(t).subtract(this._getCenterLayerPoint())},_limitCenter:function(t,e,i){if(!i)return t;var n=this.project(t,e),s=this.getSize().divideBy(2),o=new w(n.subtract(s),n.add(s)),r=this._getBoundsOffset(o,i,e);return r.round().equals([0,0])?t:this.unproject(n.add(r),e)},_limitOffset:function(t,e){if(!e)return t;var i=this.getPixelBounds(),n=new w(i.min.add(t),i.max.add(t));return t.add(this._getBoundsOffset(n,e))},_getBoundsOffset:function(t,e,i){var n=b(this.project(e.getNorthEast(),i),this.project(e.getSouthWest(),i)),s=n.min.subtract(t.min),o=n.max.subtract(t.max);return new v(this._rebound(s.x,-o.x),this._rebound(s.y,-o.y))},_rebound:function(t,e){return t+e>0?Math.round(t-e)/2:Math.max(0,Math.ceil(t))-Math.max(0,Math.floor(e))},_limitZoom:function(t){var e=this.getMinZoom(),i=this.getMaxZoom(),n=Ce?this.options.zoomSnap:1;return n&&(t=Math.round(t/n)*n),Math.max(e,Math.min(i,t))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){ut(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(t,e){var i=this._getCenterOffset(t)._trunc();return!(!0!==(e&&e.animate)&&!this.getSize().contains(i)||(this.panBy(i,e),0))},_createAnimProxy:function(){var t=this._proxy=nt("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(t),this.on("zoomanim",function(t){var e=oi,i=this._proxy.style[e];mt(this._proxy,this.project(t.center,t.zoom),this.getZoomScale(t.zoom,1)),i===this._proxy.style[e]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",function(){var t=this.getCenter(),e=this.getZoom();mt(this._proxy,this.project(t,e),this.getZoomScale(e,1))},this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){st(this._proxy),delete this._proxy},_catchTransitionEnd:function(t){this._animatingZoom&&t.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(t,e,i){if(this._animatingZoom)return!0;if(i=i||{},!this._zoomAnimated||!1===i.animate||this._nothingToAnimate()||Math.abs(e-this._zoom)>this.options.zoomAnimationThreshold)return!1;var n=this.getZoomScale(e),s=this._getCenterOffset(t)._divideBy(1-1/n);return!(!0!==i.animate&&!this.getSize().contains(s)||(_(function(){this._moveStart(!0,!1)._animateZoom(t,e,!0)},this),0))},_animateZoom:function(t,e,n,s){this._mapPane&&(n&&(this._animatingZoom=!0,this._animateToCenter=t,this._animateToZoom=e,lt(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:t,zoom:e,noUpdate:s}),setTimeout(i(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&ut(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom),_(function(){this._moveEnd(!0)},this))}}),pi=y.extend({options:{position:"topright"},initialize:function(t){u(this,t)},getPosition:function(){return this.options.position},setPosition:function(t){var e=this._map;return e&&e.removeControl(this),this.options.position=t,e&&e.addControl(this),this},getContainer:function(){return this._container},addTo:function(t){this.remove(),this._map=t;var e=this._container=this.onAdd(t),i=this.getPosition(),n=t._controlCorners[i];return lt(e,"leaflet-control"),-1!==i.indexOf("bottom")?n.insertBefore(e,n.firstChild):n.appendChild(e),this},remove:function(){return this._map?(st(this._container),this.onRemove&&this.onRemove(this._map),this._map=null,this):this},_refocusOnMap:function(t){this._map&&t&&t.screenX>0&&t.screenY>0&&this._map.getContainer().focus()}}),mi=function(t){return new pi(t)};di.include({addControl:function(t){return t.addTo(this),this},removeControl:function(t){return t.remove(),this},_initControlPos:function(){function t(t,s){var o=i+t+" "+i+s;e[t+s]=nt("div",o,n)}var e=this._controlCorners={},i="leaflet-",n=this._controlContainer=nt("div",i+"control-container",this._container);t("top","left"),t("top","right"),t("bottom","left"),t("bottom","right")},_clearControlPos:function(){for(var t in this._controlCorners)st(this._controlCorners[t]);st(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var _i=pi.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(t,e,i,n){return i<n?-1:n<i?1:0}},initialize:function(t,e,i){for(var n in u(this,i),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,t)this._addLayer(t[n],n);for(n in e)this._addLayer(e[n],n,!0)},onAdd:function(t){this._initLayout(),this._update(),this._map=t,t.on("zoomend",this._checkDisabledLayers,this);for(var e=0;e<this._layers.length;e++)this._layers[e].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(t){return pi.prototype.addTo.call(this,t),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var t=0;t<this._layers.length;t++)this._layers[t].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(t,e){return this._addLayer(t,e),this._map?this._update():this},addOverlay:function(t,e){return this._addLayer(t,e,!0),this._map?this._update():this},removeLayer:function(t){t.off("add remove",this._onLayerChange,this);var e=this._getLayer(n(t));return e&&this._layers.splice(this._layers.indexOf(e),1),this._map?this._update():this},expand:function(){lt(this._container,"leaflet-control-layers-expanded"),this._form.style.height=null;var t=this._map.getSize().y-(this._container.offsetTop+50);return t<this._form.clientHeight?(lt(this._form,"leaflet-control-layers-scrollbar"),this._form.style.height=t+"px"):ut(this._form,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return ut(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var t="leaflet-control-layers",e=this._container=nt("div",t),i=this.options.collapsed;e.setAttribute("aria-haspopup",!0),V(e),q(e);var n=this._form=nt("form",t+"-list");i&&(this._map.on("click",this.collapse,this),_e||F(e,{mouseenter:this.expand,mouseleave:this.collapse},this));var s=this._layersLink=nt("a",t+"-toggle",e);s.href="#",s.title="Layers",Be?(F(s,"click",G),F(s,"click",this.expand,this)):F(s,"focus",this.expand,this),i||this.expand(),this._baseLayersList=nt("div",t+"-base",n),this._separator=nt("div",t+"-separator",n),this._overlaysList=nt("div",t+"-overlays",n),e.appendChild(n)},_getLayer:function(t){for(var e=0;e<this._layers.length;e++)if(this._layers[e]&&n(this._layers[e].layer)===t)return this._layers[e]},_addLayer:function(t,e,n){this._map&&t.on("add remove",this._onLayerChange,this),this._layers.push({layer:t,name:e,overlay:n}),this.options.sortLayers&&this._layers.sort(i(function(t,e){return this.options.sortFunction(t.layer,e.layer,t.name,e.name)},this)),this.options.autoZIndex&&t.setZIndex&&(this._lastZIndex++,t.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;ot(this._baseLayersList),ot(this._overlaysList),this._layerControlInputs=[];var t,e,i,n,s=0;for(i=0;i<this._layers.length;i++)n=this._layers[i],this._addItem(n),e=e||n.overlay,t=t||!n.overlay,s+=n.overlay?0:1;return this.options.hideSingleBase&&(t=t&&s>1,this._baseLayersList.style.display=t?"":"none"),this._separator.style.display=e&&t?"":"none",this},_onLayerChange:function(t){this._handlingClick||this._update();var e=this._getLayer(n(t.target)),i=e.overlay?"add"===t.type?"overlayadd":"overlayremove":"add"===t.type?"baselayerchange":null;i&&this._map.fire(i,e)},_createRadioElement:function(t,e){var i='<input type="radio" class="leaflet-control-layers-selector" name="'+t+'"'+(e?' checked="checked"':"")+"/>",n=document.createElement("div");return n.innerHTML=i,n.firstChild},_addItem:function(t){var e,i=document.createElement("label"),s=this._map.hasLayer(t.layer);t.overlay?((e=document.createElement("input")).type="checkbox",e.className="leaflet-control-layers-selector",e.defaultChecked=s):e=this._createRadioElement("leaflet-base-layers",s),this._layerControlInputs.push(e),e.layerId=n(t.layer),F(e,"click",this._onInputClick,this);var o=document.createElement("span");o.innerHTML=" "+t.name;var r=document.createElement("div");return i.appendChild(r),r.appendChild(e),r.appendChild(o),(t.overlay?this._overlaysList:this._baseLayersList).appendChild(i),this._checkDisabledLayers(),i},_onInputClick:function(){var t,e,i=this._layerControlInputs,n=[],s=[];this._handlingClick=!0;for(var o=i.length-1;o>=0;o--)t=i[o],e=this._getLayer(t.layerId).layer,t.checked?n.push(e):t.checked||s.push(e);for(o=0;o<s.length;o++)this._map.hasLayer(s[o])&&this._map.removeLayer(s[o]);for(o=0;o<n.length;o++)this._map.hasLayer(n[o])||this._map.addLayer(n[o]);this._handlingClick=!1,this._refocusOnMap()},_checkDisabledLayers:function(){for(var t,e,i=this._layerControlInputs,n=this._map.getZoom(),s=i.length-1;s>=0;s--)t=i[s],e=this._getLayer(t.layerId).layer,t.disabled=void 0!==e.options.minZoom&&n<e.options.minZoom||void 0!==e.options.maxZoom&&n>e.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expand:function(){return this.expand()},_collapse:function(){return this.collapse()}}),gi=pi.extend({options:{position:"topleft",zoomInText:"+",zoomInTitle:"Zoom in",zoomOutText:"&#x2212;",zoomOutTitle:"Zoom out"},onAdd:function(t){var e="leaflet-control-zoom",i=nt("div",e+" leaflet-bar"),n=this.options;return this._zoomInButton=this._createButton(n.zoomInText,n.zoomInTitle,e+"-in",i,this._zoomIn),this._zoomOutButton=this._createButton(n.zoomOutText,n.zoomOutTitle,e+"-out",i,this._zoomOut),this._updateDisabled(),t.on("zoomend zoomlevelschange",this._updateDisabled,this),i},onRemove:function(t){t.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(t){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(t.shiftKey?3:1))},_zoomOut:function(t){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(t.shiftKey?3:1))},_createButton:function(t,e,i,n,s){var o=nt("a",i,n);return o.innerHTML=t,o.href="#",o.title=e,o.setAttribute("role","button"),o.setAttribute("aria-label",e),V(o),F(o,"click",G),F(o,"click",s,this),F(o,"click",this._refocusOnMap,this),o},_updateDisabled:function(){var t=this._map,e="leaflet-disabled";ut(this._zoomInButton,e),ut(this._zoomOutButton,e),(this._disabled||t._zoom===t.getMinZoom())&&lt(this._zoomOutButton,e),(this._disabled||t._zoom===t.getMaxZoom())&&lt(this._zoomInButton,e)}});di.mergeOptions({zoomControl:!0}),di.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new gi,this.addControl(this.zoomControl))});var yi=pi.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(t){var e=nt("div","leaflet-control-scale"),i=this.options;return this._addScales(i,"leaflet-control-scale-line",e),t.on(i.updateWhenIdle?"moveend":"move",this._update,this),t.whenReady(this._update,this),e},onRemove:function(t){t.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(t,e,i){t.metric&&(this._mScale=nt("div",e,i)),t.imperial&&(this._iScale=nt("div",e,i))},_update:function(){var t=this._map,e=t.getSize().y/2,i=t.distance(t.containerPointToLatLng([0,e]),t.containerPointToLatLng([this.options.maxWidth,e]));this._updateScales(i)},_updateScales:function(t){this.options.metric&&t&&this._updateMetric(t),this.options.imperial&&t&&this._updateImperial(t)},_updateMetric:function(t){var e=this._getRoundNum(t),i=e<1e3?e+" m":e/1e3+" km";this._updateScale(this._mScale,i,e/t)},_updateImperial:function(t){var e,i,n,s=3.2808399*t;s>5280?(e=s/5280,i=this._getRoundNum(e),this._updateScale(this._iScale,i+" mi",i/e)):(n=this._getRoundNum(s),this._updateScale(this._iScale,n+" ft",n/s))},_updateScale:function(t,e,i){t.style.width=Math.round(this.options.maxWidth*i)+"px",t.innerHTML=e},_getRoundNum:function(t){var e=Math.pow(10,(Math.floor(t)+"").length-1),i=t/e;return e*(i=i>=10?10:i>=5?5:i>=3?3:i>=2?2:1)}}),vi=pi.extend({options:{position:"bottomright",prefix:'<a href="http://leafletjs.com" title="A JS library for interactive maps">Leaflet</a>'},initialize:function(t){u(this,t),this._attributions={}},onAdd:function(t){for(var e in t.attributionControl=this,this._container=nt("div","leaflet-control-attribution"),V(this._container),t._layers)t._layers[e].getAttribution&&this.addAttribution(t._layers[e].getAttribution());return this._update(),this._container},setPrefix:function(t){return this.options.prefix=t,this._update(),this},addAttribution:function(t){return t?(this._attributions[t]||(this._attributions[t]=0),this._attributions[t]++,this._update(),this):this},removeAttribution:function(t){return t?(this._attributions[t]&&(this._attributions[t]--,this._update()),this):this},_update:function(){if(this._map){var t=[];for(var e in this._attributions)this._attributions[e]&&t.push(e);var i=[];this.options.prefix&&i.push(this.options.prefix),t.length&&i.push(t.join(", ")),this._container.innerHTML=i.join(" | ")}}});di.mergeOptions({attributionControl:!0}),di.addInitHook(function(){this.options.attributionControl&&(new vi).addTo(this)}),pi.Layers=_i,pi.Zoom=gi,pi.Scale=yi,pi.Attribution=vi,mi.layers=function(t,e,i){return new _i(t,e,i)},mi.zoom=function(t){return new gi(t)},mi.scale=function(t){return new yi(t)},mi.attribution=function(t){return new vi(t)};var xi=y.extend({initialize:function(t){this._map=t},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});xi.addTo=function(t,e){return t.addHandler(e,this),this};var wi,bi={Events:Qt},Pi=Be?"touchstart mousedown":"mousedown",Mi={mousedown:"mouseup",touchstart:"touchend",pointerdown:"touchend",MSPointerDown:"touchend"},Ti={mousedown:"mousemove",touchstart:"touchmove",pointerdown:"touchmove",MSPointerDown:"touchmove"},Si=te.extend({options:{clickTolerance:3},initialize:function(t,e,i,n){u(this,n),this._element=t,this._dragStartTarget=e||t,this._preventOutline=i},enable:function(){this._enabled||(F(this._dragStartTarget,Pi,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(Si._dragging===this&&this.finishDrag(),W(this._dragStartTarget,Pi,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(t){if(!t._simulated&&this._enabled&&(this._moved=!1,!ht(this._element,"leaflet-zoom-anim")&&!(Si._dragging||t.shiftKey||1!==t.which&&1!==t.button&&!t.touches||(Si._dragging=this,this._preventOutline&&xt(this._element),yt(),re(),this._moving)))){this.fire("down");var e=t.touches?t.touches[0]:t;this._startPoint=new v(e.clientX,e.clientY),F(document,Ti[t.type],this._onMove,this),F(document,Mi[t.type],this._onUp,this)}},_onMove:function(t){if(!t._simulated&&this._enabled)if(t.touches&&t.touches.length>1)this._moved=!0;else{var e=t.touches&&1===t.touches.length?t.touches[0]:t,i=new v(e.clientX,e.clientY).subtract(this._startPoint);(i.x||i.y)&&(Math.abs(i.x)+Math.abs(i.y)<this.options.clickTolerance||(Y(t),this._moved||(this.fire("dragstart"),this._moved=!0,this._startPos=gt(this._element).subtract(i),lt(document.body,"leaflet-dragging"),this._lastTarget=t.target||t.srcElement,window.SVGElementInstance&&this._lastTarget instanceof SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),lt(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(i),this._moving=!0,g(this._animRequest),this._lastEvent=t,this._animRequest=_(this._updatePosition,this,!0)))}},_updatePosition:function(){var t={originalEvent:this._lastEvent};this.fire("predrag",t),_t(this._element,this._newPos),this.fire("drag",t)},_onUp:function(t){!t._simulated&&this._enabled&&this.finishDrag()},finishDrag:function(){for(var t in ut(document.body,"leaflet-dragging"),this._lastTarget&&(ut(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),Ti)W(document,Ti[t],this._onMove,this),W(document,Mi[t],this._onUp,this);vt(),ae(),this._moved&&this._moving&&(g(this._animRequest),this.fire("dragend",{distance:this._newPos.distanceTo(this._startPos)})),this._moving=!1,Si._dragging=!1}}),Li=(Object.freeze||Object)({simplify:bt,pointToSegmentDistance:Pt,closestPointOnSegment:function(t,e,i){return kt(t,e,i)},clipSegment:Mt,_getEdgeIntersection:Tt,_getBitCode:St,_sqClosestPointOnSegment:kt,isFlat:Et,_flat:Ct}),ki=(Object.freeze||Object)({clipPolygon:At}),Ei={project:function(t){return new v(t.lng,t.lat)},unproject:function(t){return new T(t.y,t.x)},bounds:new w([-180,-90],[180,90])},Ci={R:6378137,R_MINOR:6356752.314245179,bounds:new w([-20037508.34279,-15496570.73972],[20037508.34279,18764656.23138]),project:function(t){var e=Math.PI/180,i=this.R,n=t.lat*e,s=this.R_MINOR/i,o=Math.sqrt(1-s*s),r=o*Math.sin(n),a=Math.tan(Math.PI/4-n/2)/Math.pow((1-r)/(1+r),o/2);return n=-i*Math.log(Math.max(a,1e-10)),new v(t.lng*e*i,n)},unproject:function(t){for(var e,i=180/Math.PI,n=this.R,s=this.R_MINOR/n,o=Math.sqrt(1-s*s),r=Math.exp(-t.y/n),a=Math.PI/2-2*Math.atan(r),h=0,l=.1;h<15&&Math.abs(l)>1e-7;h++)e=o*Math.sin(a),e=Math.pow((1-e)/(1+e),o/2),a+=l=Math.PI/2-2*Math.atan(r*e)-a;return new T(a*i,t.x*i/n)}},Ai=(Object.freeze||Object)({LonLat:Ei,Mercator:Ci,SphericalMercator:se}),Oi=e({},ne,{code:"EPSG:3395",projection:Ci,transformation:function(){var t=.5/(Math.PI*Ci.R);return E(t,.5,-t,.5)}()}),Ri=e({},ne,{code:"EPSG:4326",projection:Ei,transformation:E(1/180,1,-1/180,.5)}),zi=e({},ie,{projection:Ei,transformation:E(1,0,-1,0),scale:function(t){return Math.pow(2,t)},zoom:function(t){return Math.log(t)/Math.LN2},distance:function(t,e){var i=e.lng-t.lng,n=e.lat-t.lat;return Math.sqrt(i*i+n*n)},infinite:!0});ie.Earth=ne,ie.EPSG3395=Oi,ie.EPSG3857=le,ie.EPSG900913=ue,ie.EPSG4326=Ri,ie.Simple=zi;var Ii=te.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(t){return t.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(t){return t&&t.removeLayer(this),this},getPane:function(t){return this._map.getPane(t?this.options[t]||t:this.options.pane)},addInteractiveTarget:function(t){return this._map._targets[n(t)]=this,this},removeInteractiveTarget:function(t){return delete this._map._targets[n(t)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(t){var e=t.target;if(e.hasLayer(this)){if(this._map=e,this._zoomAnimated=e._zoomAnimated,this.getEvents){var i=this.getEvents();e.on(i,this),this.once("remove",function(){e.off(i,this)},this)}this.onAdd(e),this.getAttribution&&e.attributionControl&&e.attributionControl.addAttribution(this.getAttribution()),this.fire("add"),e.fire("layeradd",{layer:this})}}});di.include({addLayer:function(t){if(!t._layerAdd)throw new Error("The provided object is not a Layer.");var e=n(t);return this._layers[e]?this:(this._layers[e]=t,t._mapToAdd=this,t.beforeAdd&&t.beforeAdd(this),this.whenReady(t._layerAdd,t),this)},removeLayer:function(t){var e=n(t);return this._layers[e]?(this._loaded&&t.onRemove(this),t.getAttribution&&this.attributionControl&&this.attributionControl.removeAttribution(t.getAttribution()),delete this._layers[e],this._loaded&&(this.fire("layerremove",{layer:t}),t.fire("remove")),t._map=t._mapToAdd=null,this):this},hasLayer:function(t){return!!t&&n(t)in this._layers},eachLayer:function(t,e){for(var i in this._layers)t.call(e,this._layers[i]);return this},_addLayers:function(t){for(var e=0,i=(t=t?Vt(t)?t:[t]:[]).length;e<i;e++)this.addLayer(t[e])},_addZoomLimit:function(t){!isNaN(t.options.maxZoom)&&isNaN(t.options.minZoom)||(this._zoomBoundLayers[n(t)]=t,this._updateZoomLevels())},_removeZoomLimit:function(t){var e=n(t);this._zoomBoundLayers[e]&&(delete this._zoomBoundLayers[e],this._updateZoomLevels())},_updateZoomLevels:function(){var t=1/0,e=-1/0,i=this._getZoomSpan();for(var n in this._zoomBoundLayers){var s=this._zoomBoundLayers[n].options;t=void 0===s.minZoom?t:Math.min(t,s.minZoom),e=void 0===s.maxZoom?e:Math.max(e,s.maxZoom)}this._layersMaxZoom=e===-1/0?void 0:e,this._layersMinZoom=t===1/0?void 0:t,i!==this._getZoomSpan()&&this.fire("zoomlevelschange"),void 0===this.options.maxZoom&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),void 0===this.options.minZoom&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var Bi=Ii.extend({initialize:function(t,e){var i,n;if(u(this,e),this._layers={},t)for(i=0,n=t.length;i<n;i++)this.addLayer(t[i])},addLayer:function(t){var e=this.getLayerId(t);return this._layers[e]=t,this._map&&this._map.addLayer(t),this},removeLayer:function(t){var e=t in this._layers?t:this.getLayerId(t);return this._map&&this._layers[e]&&this._map.removeLayer(this._layers[e]),delete this._layers[e],this},hasLayer:function(t){return!!t&&(t in this._layers||this.getLayerId(t)in this._layers)},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(t){var e,i,n=Array.prototype.slice.call(arguments,1);for(e in this._layers)(i=this._layers[e])[t]&&i[t].apply(i,n);return this},onAdd:function(t){this.eachLayer(t.addLayer,t)},onRemove:function(t){this.eachLayer(t.removeLayer,t)},eachLayer:function(t,e){for(var i in this._layers)t.call(e,this._layers[i]);return this},getLayer:function(t){return this._layers[t]},getLayers:function(){var t=[];return this.eachLayer(t.push,t),t},setZIndex:function(t){return this.invoke("setZIndex",t)},getLayerId:function(t){return n(t)}}),Ni=Bi.extend({addLayer:function(t){return this.hasLayer(t)?this:(t.addEventParent(this),Bi.prototype.addLayer.call(this,t),this.fire("layeradd",{layer:t}))},removeLayer:function(t){return this.hasLayer(t)?(t in this._layers&&(t=this._layers[t]),t.removeEventParent(this),Bi.prototype.removeLayer.call(this,t),this.fire("layerremove",{layer:t})):this},setStyle:function(t){return this.invoke("setStyle",t)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var t=new P;for(var e in this._layers){var i=this._layers[e];t.extend(i.getBounds?i.getBounds():i.getLatLng())}return t}}),Zi=y.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0]},initialize:function(t){u(this,t)},createIcon:function(t){return this._createIcon("icon",t)},createShadow:function(t){return this._createIcon("shadow",t)},_createIcon:function(t,e){var i=this._getIconUrl(t);if(!i){if("icon"===t)throw new Error("iconUrl not set in Icon options (see the docs).");return null}var n=this._createImg(i,e&&"IMG"===e.tagName?e:null);return this._setIconStyles(n,t),n},_setIconStyles:function(t,e){var i=this.options,n=i[e+"Size"];"number"==typeof n&&(n=[n,n]);var s=x(n),o=x("shadow"===e&&i.shadowAnchor||i.iconAnchor||s&&s.divideBy(2,!0));t.className="leaflet-marker-"+e+" "+(i.className||""),o&&(t.style.marginLeft=-o.x+"px",t.style.marginTop=-o.y+"px"),s&&(t.style.width=s.x+"px",t.style.height=s.y+"px")},_createImg:function(t,e){return(e=e||document.createElement("img")).src=t,e},_getIconUrl:function(t){return De&&this.options[t+"RetinaUrl"]||this.options[t+"Url"]}}),Di=Zi.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(t){return Di.imagePath||(Di.imagePath=this._detectIconPath()),(this.options.imagePath||Di.imagePath)+Zi.prototype._getIconUrl.call(this,t)},_detectIconPath:function(){var t=nt("div","leaflet-default-icon-path",document.body),e=it(t,"background-image")||it(t,"backgroundImage");return document.body.removeChild(t),null===e||0!==e.indexOf("url")?"":e.replace(/^url\(["']?/,"").replace(/marker-icon\.png["']?\)$/,"")}}),ji=xi.extend({initialize:function(t){this._marker=t},addHooks:function(){var t=this._marker._icon;this._draggable||(this._draggable=new Si(t,t,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),lt(t,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&ut(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(t){var e=this._marker,i=e._map,n=this._marker.options.autoPanSpeed,s=this._marker.options.autoPanPadding,o=L.DomUtil.getPosition(e._icon),r=i.getPixelBounds(),a=i.getPixelOrigin(),h=b(r.min._subtract(a).add(s),r.max._subtract(a).subtract(s));if(!h.contains(o)){var l=x((Math.max(h.max.x,o.x)-h.max.x)/(r.max.x-h.max.x)-(Math.min(h.min.x,o.x)-h.min.x)/(r.min.x-h.min.x),(Math.max(h.max.y,o.y)-h.max.y)/(r.max.y-h.max.y)-(Math.min(h.min.y,o.y)-h.min.y)/(r.min.y-h.min.y)).multiplyBy(n);i.panBy(l,{animate:!1}),this._draggable._newPos._add(l),this._draggable._startPos._add(l),L.DomUtil.setPosition(e._icon,this._draggable._newPos),this._onDrag(t),this._panRequest=_(this._adjustPan.bind(this,t))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup().fire("movestart").fire("dragstart")},_onPreDrag:function(t){this._marker.options.autoPan&&(g(this._panRequest),this._panRequest=_(this._adjustPan.bind(this,t)))},_onDrag:function(t){var e=this._marker,i=e._shadow,n=gt(e._icon),s=e._map.layerPointToLatLng(n);i&&_t(i,n),e._latlng=s,t.latlng=s,t.oldLatLng=this._oldLatLng,e.fire("move",t).fire("drag",t)},_onDragEnd:function(t){g(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",t)}}),Fi=Ii.extend({options:{icon:new Di,interactive:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10,keyboard:!0,title:"",alt:"",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",bubblingMouseEvents:!1},initialize:function(t,e){u(this,e),this._latlng=S(t)},onAdd:function(t){this._zoomAnimated=this._zoomAnimated&&t.options.markerZoomAnimation,this._zoomAnimated&&t.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(t){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&t.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(t){var e=this._latlng;return this._latlng=S(t),this.update(),this.fire("move",{oldLatLng:e,latlng:this._latlng})},setZIndexOffset:function(t){return this.options.zIndexOffset=t,this.update()},setIcon:function(t){return this.options.icon=t,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var t=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(t)}return this},_initIcon:function(){var t=this.options,e="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),i=t.icon.createIcon(this._icon),n=!1;i!==this._icon&&(this._icon&&this._removeIcon(),n=!0,t.title&&(i.title=t.title),"IMG"===i.tagName&&(i.alt=t.alt||"")),lt(i,e),t.keyboard&&(i.tabIndex="0"),this._icon=i,t.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex});var s=t.icon.createShadow(this._shadow),o=!1;s!==this._shadow&&(this._removeShadow(),o=!0),s&&(lt(s,e),s.alt=""),this._shadow=s,t.opacity<1&&this._updateOpacity(),n&&this.getPane().appendChild(this._icon),this._initInteraction(),s&&o&&this.getPane("shadowPane").appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),st(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&st(this._shadow),this._shadow=null},_setPos:function(t){_t(this._icon,t),this._shadow&&_t(this._shadow,t),this._zIndex=t.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(t){this._icon.style.zIndex=this._zIndex+t},_animateZoom:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center).round();this._setPos(e)},_initInteraction:function(){if(this.options.interactive&&(lt(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),ji)){var t=this.options.draggable;this.dragging&&(t=this.dragging.enabled(),this.dragging.disable()),this.dragging=new ji(this),t&&this.dragging.enable()}},setOpacity:function(t){return this.options.opacity=t,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var t=this.options.opacity;dt(this._icon,t),this._shadow&&dt(this._shadow,t)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}}),Wi=Ii.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(t){this._renderer=t.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(t){return u(this,t),this._renderer&&this._renderer._updateStyle(this),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+this._renderer.options.tolerance}}),Ui=Wi.extend({options:{fill:!0,radius:10},initialize:function(t,e){u(this,e),this._latlng=S(t),this._radius=this.options.radius},setLatLng:function(t){return this._latlng=S(t),this.redraw(),this.fire("move",{latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(t){return this.options.radius=this._radius=t,this.redraw()},getRadius:function(){return this._radius},setStyle:function(t){var e=t&&t.radius||this._radius;return Wi.prototype.setStyle.call(this,t),this.setRadius(e),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var t=this._radius,e=this._radiusY||t,i=this._clickTolerance(),n=[t+i,e+i];this._pxBounds=new w(this._point.subtract(n),this._point.add(n))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(t){return t.distanceTo(this._point)<=this._radius+this._clickTolerance()}}),Hi=Ui.extend({initialize:function(t,i,n){if("number"==typeof i&&(i=e({},n,{radius:i})),u(this,i),this._latlng=S(t),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(t){return this._mRadius=t,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var t=[this._radius,this._radiusY||this._radius];return new P(this._map.layerPointToLatLng(this._point.subtract(t)),this._map.layerPointToLatLng(this._point.add(t)))},setStyle:Wi.prototype.setStyle,_project:function(){var t=this._latlng.lng,e=this._latlng.lat,i=this._map,n=i.options.crs;if(n.distance===ne.distance){var s=Math.PI/180,o=this._mRadius/ne.R/s,r=i.project([e+o,t]),a=i.project([e-o,t]),h=r.add(a).divideBy(2),l=i.unproject(h).lat,u=Math.acos((Math.cos(o*s)-Math.sin(e*s)*Math.sin(l*s))/(Math.cos(e*s)*Math.cos(l*s)))/s;(isNaN(u)||0===u)&&(u=o/Math.cos(Math.PI/180*e)),this._point=h.subtract(i.getPixelOrigin()),this._radius=isNaN(u)?0:h.x-i.project([l,t-u]).x,this._radiusY=h.y-r.y}else{var c=n.unproject(n.project(this._latlng).subtract([this._mRadius,0]));this._point=i.latLngToLayerPoint(this._latlng),this._radius=this._point.x-i.latLngToLayerPoint(c).x}this._updateBounds()}}),Xi=Wi.extend({options:{smoothFactor:1,noClip:!1},initialize:function(t,e){u(this,e),this._setLatLngs(t)},getLatLngs:function(){return this._latlngs},setLatLngs:function(t){return this._setLatLngs(t),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(t){for(var e,i,n=1/0,s=null,o=kt,r=0,a=this._parts.length;r<a;r++)for(var h=this._parts[r],l=1,u=h.length;l<u;l++){var c=o(t,e=h[l-1],i=h[l],!0);c<n&&(n=c,s=o(t,e,i))}return s&&(s.distance=Math.sqrt(n)),s},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");var t,e,i,n,s,o,r,a=this._rings[0],h=a.length;if(!h)return null;for(t=0,e=0;t<h-1;t++)e+=a[t].distanceTo(a[t+1])/2;if(0===e)return this._map.layerPointToLatLng(a[0]);for(t=0,n=0;t<h-1;t++)if(s=a[t],o=a[t+1],(n+=i=s.distanceTo(o))>e)return r=(n-e)/i,this._map.layerPointToLatLng([o.x-r*(o.x-s.x),o.y-r*(o.y-s.y)])},getBounds:function(){return this._bounds},addLatLng:function(t,e){return e=e||this._defaultShape(),t=S(t),e.push(t),this._bounds.extend(t),this.redraw()},_setLatLngs:function(t){this._bounds=new P,this._latlngs=this._convertLatLngs(t)},_defaultShape:function(){return Et(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(t){for(var e=[],i=Et(t),n=0,s=t.length;n<s;n++)i?(e[n]=S(t[n]),this._bounds.extend(e[n])):e[n]=this._convertLatLngs(t[n]);return e},_project:function(){var t=new w;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,t);var e=this._clickTolerance(),i=new v(e,e);this._bounds.isValid()&&t.isValid()&&(t.min._subtract(i),t.max._add(i),this._pxBounds=t)},_projectLatlngs:function(t,e,i){var n,s,o=t[0]instanceof T,r=t.length;if(o){for(s=[],n=0;n<r;n++)s[n]=this._map.latLngToLayerPoint(t[n]),i.extend(s[n]);e.push(s)}else for(n=0;n<r;n++)this._projectLatlngs(t[n],e,i)},_clipPoints:function(){var t=this._renderer._bounds;if(this._parts=[],this._pxBounds&&this._pxBounds.intersects(t))if(this.options.noClip)this._parts=this._rings;else{var e,i,n,s,o,r,a,h=this._parts;for(e=0,n=0,s=this._rings.length;e<s;e++)for(i=0,o=(a=this._rings[e]).length;i<o-1;i++)(r=Mt(a[i],a[i+1],t,i,!0))&&(h[n]=h[n]||[],h[n].push(r[0]),r[1]===a[i+1]&&i!==o-2||(h[n].push(r[1]),n++))}},_simplifyPoints:function(){for(var t=this._parts,e=this.options.smoothFactor,i=0,n=t.length;i<n;i++)t[i]=bt(t[i],e)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(t,e){var i,n,s,o,r,a,h=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(t))return!1;for(i=0,o=this._parts.length;i<o;i++)for(n=0,s=(r=(a=this._parts[i]).length)-1;n<r;s=n++)if((e||0!==n)&&Pt(t,a[s],a[n])<=h)return!0;return!1}});Xi._flat=Ct;var qi=Xi.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");var t,e,i,n,s,o,r,a,h,l=this._rings[0],u=l.length;if(!u)return null;for(o=r=a=0,t=0,e=u-1;t<u;e=t++)i=l[t],n=l[e],s=i.y*n.x-n.y*i.x,r+=(i.x+n.x)*s,a+=(i.y+n.y)*s,o+=3*s;return h=0===o?l[0]:[r/o,a/o],this._map.layerPointToLatLng(h)},_convertLatLngs:function(t){var e=Xi.prototype._convertLatLngs.call(this,t),i=e.length;return i>=2&&e[0]instanceof T&&e[0].equals(e[i-1])&&e.pop(),e},_setLatLngs:function(t){Xi.prototype._setLatLngs.call(this,t),Et(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return Et(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var t=this._renderer._bounds,e=this.options.weight,i=new v(e,e);if(t=new w(t.min.subtract(i),t.max.add(i)),this._parts=[],this._pxBounds&&this._pxBounds.intersects(t))if(this.options.noClip)this._parts=this._rings;else for(var n,s=0,o=this._rings.length;s<o;s++)(n=At(this._rings[s],t,!0)).length&&this._parts.push(n)},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(t){var e,i,n,s,o,r,a,h,l=!1;if(!this._pxBounds.contains(t))return!1;for(s=0,a=this._parts.length;s<a;s++)for(o=0,r=(h=(e=this._parts[s]).length)-1;o<h;r=o++)i=e[o],n=e[r],i.y>t.y!=n.y>t.y&&t.x<(n.x-i.x)*(t.y-i.y)/(n.y-i.y)+i.x&&(l=!l);return l||Xi.prototype._containsPoint.call(this,t,!0)}}),Vi=Ni.extend({initialize:function(t,e){u(this,e),this._layers={},t&&this.addData(t)},addData:function(t){var e,i,n,s=Vt(t)?t:t.features;if(s){for(e=0,i=s.length;e<i;e++)((n=s[e]).geometries||n.geometry||n.features||n.coordinates)&&this.addData(n);return this}var o=this.options;if(o.filter&&!o.filter(t))return this;var r=Ot(t,o);return r?(r.feature=Zt(t),r.defaultOptions=r.options,this.resetStyle(r),o.onEachFeature&&o.onEachFeature(t,r),this.addLayer(r)):this},resetStyle:function(t){return t.options=e({},t.defaultOptions),this._setLayerStyle(t,this.options.style),this},setStyle:function(t){return this.eachLayer(function(e){this._setLayerStyle(e,t)},this)},_setLayerStyle:function(t,e){"function"==typeof e&&(e=e(t.feature)),t.setStyle&&t.setStyle(e)}}),Yi={toGeoJSON:function(t){return Nt(this,{type:"Point",coordinates:It(this.getLatLng(),t)})}};Fi.include(Yi),Hi.include(Yi),Ui.include(Yi),Xi.include({toGeoJSON:function(t){var e=!Et(this._latlngs),i=Bt(this._latlngs,e?1:0,!1,t);return Nt(this,{type:(e?"Multi":"")+"LineString",coordinates:i})}}),qi.include({toGeoJSON:function(t){var e=!Et(this._latlngs),i=e&&!Et(this._latlngs[0]),n=Bt(this._latlngs,i?2:e?1:0,!0,t);return e||(n=[n]),Nt(this,{type:(i?"Multi":"")+"Polygon",coordinates:n})}}),Bi.include({toMultiPoint:function(t){var e=[];return this.eachLayer(function(i){e.push(i.toGeoJSON(t).geometry.coordinates)}),Nt(this,{type:"MultiPoint",coordinates:e})},toGeoJSON:function(t){var e=this.feature&&this.feature.geometry&&this.feature.geometry.type;if("MultiPoint"===e)return this.toMultiPoint(t);var i="GeometryCollection"===e,n=[];return this.eachLayer(function(e){if(e.toGeoJSON){var s=e.toGeoJSON(t);if(i)n.push(s.geometry);else{var o=Zt(s);"FeatureCollection"===o.type?n.push.apply(n,o.features):n.push(o)}}}),i?Nt(this,{geometries:n,type:"GeometryCollection"}):{type:"FeatureCollection",features:n}}});var Gi=Dt,$i=Ii.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(t,e,i){this._url=t,this._bounds=M(e),u(this,i)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(lt(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){st(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(t){return this.options.opacity=t,this._image&&this._updateOpacity(),this},setStyle:function(t){return t.opacity&&this.setOpacity(t.opacity),this},bringToFront:function(){return this._map&&rt(this._image),this},bringToBack:function(){return this._map&&at(this._image),this},setUrl:function(t){return this._url=t,this._image&&(this._image.src=t),this},setBounds:function(t){return this._bounds=M(t),this._map&&this._reset(),this},getEvents:function(){var t={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},setZIndex:function(t){return this.options.zIndex=t,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var t="IMG"===this._url.tagName,e=this._image=t?this._url:nt("img");lt(e,"leaflet-image-layer"),this._zoomAnimated&&lt(e,"leaflet-zoom-animated"),this.options.className&&lt(e,this.options.className),e.onselectstart=r,e.onmousemove=r,e.onload=i(this.fire,this,"load"),e.onerror=i(this._overlayOnError,this,"error"),this.options.crossOrigin&&(e.crossOrigin=""),this.options.zIndex&&this._updateZIndex(),t?this._url=e.src:(e.src=this._url,e.alt=this.options.alt)},_animateZoom:function(t){var e=this._map.getZoomScale(t.zoom),i=this._map._latLngBoundsToNewLayerBounds(this._bounds,t.zoom,t.center).min;mt(this._image,i,e)},_reset:function(){var t=this._image,e=new w(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),i=e.getSize();_t(t,e.min),t.style.width=i.x+"px",t.style.height=i.y+"px"},_updateOpacity:function(){dt(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&void 0!==this.options.zIndex&&null!==this.options.zIndex&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var t=this.options.errorOverlayUrl;t&&this._url!==t&&(this._url=t,this._image.src=t)}}),Ki=$i.extend({options:{autoplay:!0,loop:!0},_initImage:function(){var t="VIDEO"===this._url.tagName,e=this._image=t?this._url:nt("video");if(lt(e,"leaflet-image-layer"),this._zoomAnimated&&lt(e,"leaflet-zoom-animated"),e.onselectstart=r,e.onmousemove=r,e.onloadeddata=i(this.fire,this,"load"),t){for(var n=e.getElementsByTagName("source"),s=[],o=0;o<n.length;o++)s.push(n[o].src);this._url=n.length>0?s:[e.src]}else{Vt(this._url)||(this._url=[this._url]),e.autoplay=!!this.options.autoplay,e.loop=!!this.options.loop;for(var a=0;a<this._url.length;a++){var h=nt("source");h.src=this._url[a],e.appendChild(h)}}}}),Ji=Ii.extend({options:{offset:[0,7],className:"",pane:"popupPane"},initialize:function(t,e){u(this,t),this._source=e},onAdd:function(t){this._zoomAnimated=t._zoomAnimated,this._container||this._initLayout(),t._fadeAnimated&&dt(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),t._fadeAnimated&&dt(this._container,1),this.bringToFront()},onRemove:function(t){t._fadeAnimated?(dt(this._container,0),this._removeTimeout=setTimeout(i(st,void 0,this._container),200)):st(this._container)},getLatLng:function(){return this._latlng},setLatLng:function(t){return this._latlng=S(t),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(t){return this._content=t,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var t={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&rt(this._container),this},bringToBack:function(){return this._map&&at(this._container),this},_updateContent:function(){if(this._content){var t=this._contentNode,e="function"==typeof this._content?this._content(this._source||this):this._content;if("string"==typeof e)t.innerHTML=e;else{for(;t.hasChildNodes();)t.removeChild(t.firstChild);t.appendChild(e)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var t=this._map.latLngToLayerPoint(this._latlng),e=x(this.options.offset),i=this._getAnchor();this._zoomAnimated?_t(this._container,t.add(i)):e=e.add(t).add(i);var n=this._containerBottom=-e.y,s=this._containerLeft=-Math.round(this._containerWidth/2)+e.x;this._container.style.bottom=n+"px",this._container.style.left=s+"px"}},_getAnchor:function(){return[0,0]}}),Qi=Ji.extend({options:{maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(t){return t.openPopup(this),this},onAdd:function(t){Ji.prototype.onAdd.call(this,t),t.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof Wi||this._source.on("preclick",X))},onRemove:function(t){Ji.prototype.onRemove.call(this,t),t.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof Wi||this._source.off("preclick",X))},getEvents:function(){var t=Ji.prototype.getEvents.call(this);return(void 0!==this.options.closeOnClick?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(t.preclick=this._close),this.options.keepInView&&(t.moveend=this._adjustPan),t},_close:function(){this._map&&this._map.closePopup(this)},_initLayout:function(){var t="leaflet-popup",e=this._container=nt("div",t+" "+(this.options.className||"")+" leaflet-zoom-animated"),i=this._wrapper=nt("div",t+"-content-wrapper",e);if(this._contentNode=nt("div",t+"-content",i),V(i),q(this._contentNode),F(i,"contextmenu",X),this._tipContainer=nt("div",t+"-tip-container",e),this._tip=nt("div",t+"-tip",this._tipContainer),this.options.closeButton){var n=this._closeButton=nt("a",t+"-close-button",e);n.href="#close",n.innerHTML="&#215;",F(n,"click",this._onCloseButtonClick,this)}},_updateLayout:function(){var t=this._contentNode,e=t.style;e.width="",e.whiteSpace="nowrap";var i=t.offsetWidth;i=Math.min(i,this.options.maxWidth),i=Math.max(i,this.options.minWidth),e.width=i+1+"px",e.whiteSpace="",e.height="";var n=t.offsetHeight,s=this.options.maxHeight;s&&n>s?(e.height=s+"px",lt(t,"leaflet-popup-scrolled")):ut(t,"leaflet-popup-scrolled"),this._containerWidth=this._container.offsetWidth},_animateZoom:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center),i=this._getAnchor();_t(this._container,e.add(i))},_adjustPan:function(){if(!(!this.options.autoPan||this._map._panAnim&&this._map._panAnim._inProgress)){var t=this._map,e=parseInt(it(this._container,"marginBottom"),10)||0,i=this._container.offsetHeight+e,n=this._containerWidth,s=new v(this._containerLeft,-i-this._containerBottom);s._add(gt(this._container));var o=t.layerPointToContainerPoint(s),r=x(this.options.autoPanPadding),a=x(this.options.autoPanPaddingTopLeft||r),h=x(this.options.autoPanPaddingBottomRight||r),l=t.getSize(),u=0,c=0;o.x+n+h.x>l.x&&(u=o.x+n-l.x+h.x),o.x-u-a.x<0&&(u=o.x-a.x),o.y+i+h.y>l.y&&(c=o.y+i-l.y+h.y),o.y-c-a.y<0&&(c=o.y-a.y),(u||c)&&t.fire("autopanstart").panBy([u,c])}},_onCloseButtonClick:function(t){this._close(),G(t)},_getAnchor:function(){return x(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}});di.mergeOptions({closePopupOnClick:!0}),di.include({openPopup:function(t,e,i){return t instanceof Qi||(t=new Qi(i).setContent(t)),e&&t.setLatLng(e),this.hasLayer(t)?this:(this._popup&&this._popup.options.autoClose&&this.closePopup(),this._popup=t,this.addLayer(t))},closePopup:function(t){return t&&t!==this._popup||(t=this._popup,this._popup=null),t&&this.removeLayer(t),this}}),Ii.include({bindPopup:function(t,e){return t instanceof Qi?(u(t,e),this._popup=t,t._source=this):(this._popup&&!e||(this._popup=new Qi(e,this)),this._popup.setContent(t)),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(t,e){if(t instanceof Ii||(e=t,t=this),t instanceof Ni)for(var i in this._layers){t=this._layers[i];break}return e||(e=t.getCenter?t.getCenter():t.getLatLng()),this._popup&&this._map&&(this._popup._source=t,this._popup.update(),this._map.openPopup(this._popup,e)),this},closePopup:function(){return this._popup&&this._popup._close(),this},togglePopup:function(t){return this._popup&&(this._popup._map?this.closePopup():this.openPopup(t)),this},isPopupOpen:function(){return!!this._popup&&this._popup.isOpen()},setPopupContent:function(t){return this._popup&&this._popup.setContent(t),this},getPopup:function(){return this._popup},_openPopup:function(t){var e=t.layer||t.target;this._popup&&this._map&&(G(t),e instanceof Wi?this.openPopup(t.layer||t.target,t.latlng):this._map.hasLayer(this._popup)&&this._popup._source===e?this.closePopup():this.openPopup(e,t.latlng))},_movePopup:function(t){this._popup.setLatLng(t.latlng)},_onKeyPress:function(t){13===t.originalEvent.keyCode&&this._openPopup(t)}});var tn=Ji.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,interactive:!1,opacity:.9},onAdd:function(t){Ji.prototype.onAdd.call(this,t),this.setOpacity(this.options.opacity),t.fire("tooltipopen",{tooltip:this}),this._source&&this._source.fire("tooltipopen",{tooltip:this},!0)},onRemove:function(t){Ji.prototype.onRemove.call(this,t),t.fire("tooltipclose",{tooltip:this}),this._source&&this._source.fire("tooltipclose",{tooltip:this},!0)},getEvents:function(){var t=Ji.prototype.getEvents.call(this);return Be&&!this.options.permanent&&(t.preclick=this._close),t},_close:function(){this._map&&this._map.closeTooltip(this)},_initLayout:function(){var t="leaflet-tooltip "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=nt("div",t)},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(t){var e=this._map,i=this._container,n=e.latLngToContainerPoint(e.getCenter()),s=e.layerPointToContainerPoint(t),o=this.options.direction,r=i.offsetWidth,a=i.offsetHeight,h=x(this.options.offset),l=this._getAnchor();"top"===o?t=t.add(x(-r/2+h.x,-a+h.y+l.y,!0)):"bottom"===o?t=t.subtract(x(r/2-h.x,-h.y,!0)):"center"===o?t=t.subtract(x(r/2+h.x,a/2-l.y+h.y,!0)):"right"===o||"auto"===o&&s.x<n.x?(o="right",t=t.add(x(h.x+l.x,l.y-a/2+h.y,!0))):(o="left",t=t.subtract(x(r+l.x-h.x,a/2-l.y-h.y,!0))),ut(i,"leaflet-tooltip-right"),ut(i,"leaflet-tooltip-left"),ut(i,"leaflet-tooltip-top"),ut(i,"leaflet-tooltip-bottom"),lt(i,"leaflet-tooltip-"+o),_t(i,t)},_updatePosition:function(){var t=this._map.latLngToLayerPoint(this._latlng);this._setPosition(t)},setOpacity:function(t){this.options.opacity=t,this._container&&dt(this._container,t)},_animateZoom:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center);this._setPosition(e)},_getAnchor:function(){return x(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}});di.include({openTooltip:function(t,e,i){return t instanceof tn||(t=new tn(i).setContent(t)),e&&t.setLatLng(e),this.hasLayer(t)?this:this.addLayer(t)},closeTooltip:function(t){return t&&this.removeLayer(t),this}}),Ii.include({bindTooltip:function(t,e){return t instanceof tn?(u(t,e),this._tooltip=t,t._source=this):(this._tooltip&&!e||(this._tooltip=new tn(e,this)),this._tooltip.setContent(t)),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(t){if(t||!this._tooltipHandlersAdded){var e=t?"off":"on",i={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?i.add=this._openTooltip:(i.mouseover=this._openTooltip,i.mouseout=this.closeTooltip,this._tooltip.options.sticky&&(i.mousemove=this._moveTooltip),Be&&(i.click=this._openTooltip)),this[e](i),this._tooltipHandlersAdded=!t}},openTooltip:function(t,e){if(t instanceof Ii||(e=t,t=this),t instanceof Ni)for(var i in this._layers){t=this._layers[i];break}return e||(e=t.getCenter?t.getCenter():t.getLatLng()),this._tooltip&&this._map&&(this._tooltip._source=t,this._tooltip.update(),this._map.openTooltip(this._tooltip,e),this._tooltip.options.interactive&&this._tooltip._container&&(lt(this._tooltip._container,"leaflet-clickable"),this.addInteractiveTarget(this._tooltip._container))),this},closeTooltip:function(){return this._tooltip&&(this._tooltip._close(),this._tooltip.options.interactive&&this._tooltip._container&&(ut(this._tooltip._container,"leaflet-clickable"),this.removeInteractiveTarget(this._tooltip._container))),this},toggleTooltip:function(t){return this._tooltip&&(this._tooltip._map?this.closeTooltip():this.openTooltip(t)),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(t){return this._tooltip&&this._tooltip.setContent(t),this},getTooltip:function(){return this._tooltip},_openTooltip:function(t){var e=t.layer||t.target;this._tooltip&&this._map&&this.openTooltip(e,this._tooltip.options.sticky?t.latlng:void 0)},_moveTooltip:function(t){var e,i,n=t.latlng;this._tooltip.options.sticky&&t.originalEvent&&(e=this._map.mouseEventToContainerPoint(t.originalEvent),i=this._map.containerPointToLayerPoint(e),n=this._map.layerPointToLatLng(i)),this._tooltip.setLatLng(n)}});var en=Zi.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(t){var e=t&&"DIV"===t.tagName?t:document.createElement("div"),i=this.options;if(e.innerHTML=!1!==i.html?i.html:"",i.bgPos){var n=x(i.bgPos);e.style.backgroundPosition=-n.x+"px "+-n.y+"px"}return this._setIconStyles(e,"icon"),e},createShadow:function(){return null}});Zi.Default=Di;var nn=Ii.extend({options:{tileSize:256,opacity:1,updateWhenIdle:Ae,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(t){u(this,t)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView(),this._update()},beforeAdd:function(t){t._addZoomLimit(this)},onRemove:function(t){this._removeAllTiles(),st(this._container),t._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(rt(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(at(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(t){return this.options.opacity=t,this._updateOpacity(),this},setZIndex:function(t){return this.options.zIndex=t,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){return this._map&&(this._removeAllTiles(),this._update()),this},getEvents:function(){var t={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=s(this._onMoveEnd,this.options.updateInterval,this)),t.move=this._onMove),this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},createTile:function(){return document.createElement("div")},getTileSize:function(){var t=this.options.tileSize;return t instanceof v?t:new v(t,t)},_updateZIndex:function(){this._container&&void 0!==this.options.zIndex&&null!==this.options.zIndex&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(t){for(var e,i=this.getPane().children,n=-t(-1/0,1/0),s=0,o=i.length;s<o;s++)e=i[s].style.zIndex,i[s]!==this._container&&e&&(n=t(n,+e));isFinite(n)&&(this.options.zIndex=n+t(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!de){dt(this._container,this.options.opacity);var t=+new Date,e=!1,i=!1;for(var n in this._tiles){var s=this._tiles[n];if(s.current&&s.loaded){var o=Math.min(1,(t-s.loaded)/200);dt(s.el,o),o<1?e=!0:(s.active?i=!0:this._onOpaqueTile(s),s.active=!0)}}i&&!this._noPrune&&this._pruneTiles(),e&&(g(this._fadeFrame),this._fadeFrame=_(this._updateOpacity,this))}},_onOpaqueTile:r,_initContainer:function(){this._container||(this._container=nt("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var t=this._tileZoom,e=this.options.maxZoom;if(void 0!==t){for(var i in this._levels)this._levels[i].el.children.length||i===t?(this._levels[i].el.style.zIndex=e-Math.abs(t-i),this._onUpdateLevel(i)):(st(this._levels[i].el),this._removeTilesAtZoom(i),this._onRemoveLevel(i),delete this._levels[i]);var n=this._levels[t],s=this._map;return n||((n=this._levels[t]={}).el=nt("div","leaflet-tile-container leaflet-zoom-animated",this._container),n.el.style.zIndex=e,n.origin=s.project(s.unproject(s.getPixelOrigin()),t).round(),n.zoom=t,this._setZoomTransform(n,s.getCenter(),s.getZoom()),n.el.offsetWidth,this._onCreateLevel(n)),this._level=n,n}},_onUpdateLevel:r,_onRemoveLevel:r,_onCreateLevel:r,_pruneTiles:function(){if(this._map){var t,e,i=this._map.getZoom();if(i>this.options.maxZoom||i<this.options.minZoom)this._removeAllTiles();else{for(t in this._tiles)(e=this._tiles[t]).retain=e.current;for(t in this._tiles)if((e=this._tiles[t]).current&&!e.active){var n=e.coords;this._retainParent(n.x,n.y,n.z,n.z-5)||this._retainChildren(n.x,n.y,n.z,n.z+2)}for(t in this._tiles)this._tiles[t].retain||this._removeTile(t)}}},_removeTilesAtZoom:function(t){for(var e in this._tiles)this._tiles[e].coords.z===t&&this._removeTile(e)},_removeAllTiles:function(){for(var t in this._tiles)this._removeTile(t)},_invalidateAll:function(){for(var t in this._levels)st(this._levels[t].el),this._onRemoveLevel(t),delete this._levels[t];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(t,e,i,n){var s=Math.floor(t/2),o=Math.floor(e/2),r=i-1,a=new v(+s,+o);a.z=+r;var h=this._tileCoordsToKey(a),l=this._tiles[h];return l&&l.active?(l.retain=!0,!0):(l&&l.loaded&&(l.retain=!0),r>n&&this._retainParent(s,o,r,n))},_retainChildren:function(t,e,i,n){for(var s=2*t;s<2*t+2;s++)for(var o=2*e;o<2*e+2;o++){var r=new v(s,o);r.z=i+1;var a=this._tileCoordsToKey(r),h=this._tiles[a];h&&h.active?h.retain=!0:(h&&h.loaded&&(h.retain=!0),i+1<n&&this._retainChildren(s,o,i+1,n))}},_resetView:function(t){var e=t&&(t.pinch||t.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),e,e)},_animateZoom:function(t){this._setView(t.center,t.zoom,!0,t.noUpdate)},_clampZoom:function(t){var e=this.options;return void 0!==e.minNativeZoom&&t<e.minNativeZoom?e.minNativeZoom:void 0!==e.maxNativeZoom&&e.maxNativeZoom<t?e.maxNativeZoom:t},_setView:function(t,e,i,n){var s=this._clampZoom(Math.round(e));(void 0!==this.options.maxZoom&&s>this.options.maxZoom||void 0!==this.options.minZoom&&s<this.options.minZoom)&&(s=void 0);var o=this.options.updateWhenZooming&&s!==this._tileZoom;n&&!o||(this._tileZoom=s,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),void 0!==s&&this._update(t),i||this._pruneTiles(),this._noPrune=!!i),this._setZoomTransforms(t,e)},_setZoomTransforms:function(t,e){for(var i in this._levels)this._setZoomTransform(this._levels[i],t,e)},_setZoomTransform:function(t,e,i){var n=this._map.getZoomScale(i,t.zoom),s=t.origin.multiplyBy(n).subtract(this._map._getNewPixelOrigin(e,i)).round();Ce?mt(t.el,s,n):_t(t.el,s)},_resetGrid:function(){var t=this._map,e=t.options.crs,i=this._tileSize=this.getTileSize(),n=this._tileZoom,s=this._map.getPixelWorldBounds(this._tileZoom);s&&(this._globalTileRange=this._pxBoundsToTileRange(s)),this._wrapX=e.wrapLng&&!this.options.noWrap&&[Math.floor(t.project([0,e.wrapLng[0]],n).x/i.x),Math.ceil(t.project([0,e.wrapLng[1]],n).x/i.y)],this._wrapY=e.wrapLat&&!this.options.noWrap&&[Math.floor(t.project([e.wrapLat[0],0],n).y/i.x),Math.ceil(t.project([e.wrapLat[1],0],n).y/i.y)]},_onMoveEnd:function(){this._map&&!this._map._animatingZoom&&this._update()},_getTiledPixelBounds:function(t){var e=this._map,i=e._animatingZoom?Math.max(e._animateToZoom,e.getZoom()):e.getZoom(),n=e.getZoomScale(i,this._tileZoom),s=e.project(t,this._tileZoom).floor(),o=e.getSize().divideBy(2*n);return new w(s.subtract(o),s.add(o))},_update:function(t){var e=this._map;if(e){var i=this._clampZoom(e.getZoom());if(void 0===t&&(t=e.getCenter()),void 0!==this._tileZoom){var n=this._getTiledPixelBounds(t),s=this._pxBoundsToTileRange(n),o=s.getCenter(),r=[],a=this.options.keepBuffer,h=new w(s.getBottomLeft().subtract([a,-a]),s.getTopRight().add([a,-a]));if(!(isFinite(s.min.x)&&isFinite(s.min.y)&&isFinite(s.max.x)&&isFinite(s.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var l in this._tiles){var u=this._tiles[l].coords;u.z===this._tileZoom&&h.contains(new v(u.x,u.y))||(this._tiles[l].current=!1)}if(Math.abs(i-this._tileZoom)>1)this._setView(t,i);else{for(var c=s.min.y;c<=s.max.y;c++)for(var f=s.min.x;f<=s.max.x;f++){var d=new v(f,c);if(d.z=this._tileZoom,this._isValidTile(d)){var p=this._tiles[this._tileCoordsToKey(d)];p?p.current=!0:r.push(d)}}if(r.sort(function(t,e){return t.distanceTo(o)-e.distanceTo(o)}),0!==r.length){this._loading||(this._loading=!0,this.fire("loading"));var m=document.createDocumentFragment();for(f=0;f<r.length;f++)this._addTile(r[f],m);this._level.el.appendChild(m)}}}}},_isValidTile:function(t){var e=this._map.options.crs;if(!e.infinite){var i=this._globalTileRange;if(!e.wrapLng&&(t.x<i.min.x||t.x>i.max.x)||!e.wrapLat&&(t.y<i.min.y||t.y>i.max.y))return!1}if(!this.options.bounds)return!0;var n=this._tileCoordsToBounds(t);return M(this.options.bounds).overlaps(n)},_keyToBounds:function(t){return this._tileCoordsToBounds(this._keyToTileCoords(t))},_tileCoordsToNwSe:function(t){var e=this._map,i=this.getTileSize(),n=t.scaleBy(i),s=n.add(i);return[e.unproject(n,t.z),e.unproject(s,t.z)]},_tileCoordsToBounds:function(t){var e=this._tileCoordsToNwSe(t),i=new P(e[0],e[1]);return this.options.noWrap||(i=this._map.wrapLatLngBounds(i)),i},_tileCoordsToKey:function(t){return t.x+":"+t.y+":"+t.z},_keyToTileCoords:function(t){var e=t.split(":"),i=new v(+e[0],+e[1]);return i.z=+e[2],i},_removeTile:function(t){var e=this._tiles[t];e&&(ve||e.el.setAttribute("src",Yt),st(e.el),delete this._tiles[t],this.fire("tileunload",{tile:e.el,coords:this._keyToTileCoords(t)}))},_initTile:function(t){lt(t,"leaflet-tile");var e=this.getTileSize();t.style.width=e.x+"px",t.style.height=e.y+"px",t.onselectstart=r,t.onmousemove=r,de&&this.options.opacity<1&&dt(t,this.options.opacity),_e&&!ge&&(t.style.WebkitBackfaceVisibility="hidden")},_addTile:function(t,e){var n=this._getTilePos(t),s=this._tileCoordsToKey(t),o=this.createTile(this._wrapCoords(t),i(this._tileReady,this,t));this._initTile(o),this.createTile.length<2&&_(i(this._tileReady,this,t,null,o)),_t(o,n),this._tiles[s]={el:o,coords:t,current:!0},e.appendChild(o),this.fire("tileloadstart",{tile:o,coords:t})},_tileReady:function(t,e,n){if(this._map){e&&this.fire("tileerror",{error:e,tile:n,coords:t});var s=this._tileCoordsToKey(t);(n=this._tiles[s])&&(n.loaded=+new Date,this._map._fadeAnimated?(dt(n.el,0),g(this._fadeFrame),this._fadeFrame=_(this._updateOpacity,this)):(n.active=!0,this._pruneTiles()),e||(lt(n.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:n.el,coords:t})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),de||!this._map._fadeAnimated?_(this._pruneTiles,this):setTimeout(i(this._pruneTiles,this),250)))}},_getTilePos:function(t){return t.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(t){var e=new v(this._wrapX?o(t.x,this._wrapX):t.x,this._wrapY?o(t.y,this._wrapY):t.y);return e.z=t.z,e},_pxBoundsToTileRange:function(t){var e=this.getTileSize();return new w(t.min.unscaleBy(e).floor(),t.max.unscaleBy(e).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var t in this._tiles)if(!this._tiles[t].loaded)return!1;return!0}}),sn=nn.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1},initialize:function(t,e){this._url=t,(e=u(this,e)).detectRetina&&De&&e.maxZoom>0&&(e.tileSize=Math.floor(e.tileSize/2),e.zoomReverse?(e.zoomOffset--,e.minZoom++):(e.zoomOffset++,e.maxZoom--),e.minZoom=Math.max(0,e.minZoom)),"string"==typeof e.subdomains&&(e.subdomains=e.subdomains.split("")),_e||this.on("tileunload",this._onTileRemove)},setUrl:function(t,e){return this._url=t,e||this.redraw(),this},createTile:function(t,e){var n=document.createElement("img");return F(n,"load",i(this._tileOnLoad,this,e,n)),F(n,"error",i(this._tileOnError,this,e,n)),this.options.crossOrigin&&(n.crossOrigin=""),n.alt="",n.setAttribute("role","presentation"),n.src=this.getTileUrl(t),n},getTileUrl:function(t){var i={r:De?"@2x":"",s:this._getSubdomain(t),x:t.x,y:t.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var n=this._globalTileRange.max.y-t.y;this.options.tms&&(i.y=n),i["-y"]=n}return f(this._url,e(i,this.options))},_tileOnLoad:function(t,e){de?setTimeout(i(t,this,null,e),0):t(null,e)},_tileOnError:function(t,e,i){var n=this.options.errorTileUrl;n&&e.getAttribute("src")!==n&&(e.src=n),t(i,e)},_onTileRemove:function(t){t.tile.onload=null},_getZoomForUrl:function(){var t=this._tileZoom,e=this.options.maxZoom,i=this.options.zoomReverse,n=this.options.zoomOffset;return i&&(t=e-t),t+n},_getSubdomain:function(t){var e=Math.abs(t.x+t.y)%this.options.subdomains.length;return this.options.subdomains[e]},_abortLoading:function(){var t,e;for(t in this._tiles)this._tiles[t].coords.z!==this._tileZoom&&((e=this._tiles[t].el).onload=r,e.onerror=r,e.complete||(e.src=Yt,st(e),delete this._tiles[t]))}}),on=sn.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(t,i){this._url=t;var n=e({},this.defaultWmsParams);for(var s in i)s in this.options||(n[s]=i[s]);var o=(i=u(this,i)).detectRetina&&De?2:1,r=this.getTileSize();n.width=r.x*o,n.height=r.y*o,this.wmsParams=n},onAdd:function(t){this._crs=this.options.crs||t.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var e=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[e]=this._crs.code,sn.prototype.onAdd.call(this,t)},getTileUrl:function(t){var e=this._tileCoordsToNwSe(t),i=this._crs,n=b(i.project(e[0]),i.project(e[1])),s=n.min,o=n.max,r=(this._wmsVersion>=1.3&&this._crs===Ri?[s.y,s.x,o.y,o.x]:[s.x,s.y,o.x,o.y]).join(","),a=L.TileLayer.prototype.getTileUrl.call(this,t);return a+c(this.wmsParams,a,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+r},setParams:function(t,i){return e(this.wmsParams,t),i||this.redraw(),this}});sn.WMS=on,jt.wms=function(t,e){return new on(t,e)};var rn=Ii.extend({options:{padding:.1,tolerance:0},initialize:function(t){u(this,t),n(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),this._zoomAnimated&&lt(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var t={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(t.zoomanim=this._onAnimZoom),t},_onAnimZoom:function(t){this._updateTransform(t.center,t.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(t,e){var i=this._map.getZoomScale(e,this._zoom),n=gt(this._container),s=this._map.getSize().multiplyBy(.5+this.options.padding),o=this._map.project(this._center,e),r=this._map.project(t,e).subtract(o),a=s.multiplyBy(-i).add(n).add(s).subtract(r);Ce?mt(this._container,a,i):_t(this._container,a)},_reset:function(){for(var t in this._update(),this._updateTransform(this._center,this._zoom),this._layers)this._layers[t]._reset()},_onZoomEnd:function(){for(var t in this._layers)this._layers[t]._project()},_updatePaths:function(){for(var t in this._layers)this._layers[t]._update()},_update:function(){var t=this.options.padding,e=this._map.getSize(),i=this._map.containerPointToLayerPoint(e.multiplyBy(-t)).round();this._bounds=new w(i,i.add(e.multiplyBy(1+2*t)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),an=rn.extend({getEvents:function(){var t=rn.prototype.getEvents.call(this);return t.viewprereset=this._onViewPreReset,t},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){rn.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var t=this._container=document.createElement("canvas");F(t,"mousemove",s(this._onMouseMove,32,this),this),F(t,"click dblclick mousedown mouseup contextmenu",this._onClick,this),F(t,"mouseout",this._handleMouseOut,this),this._ctx=t.getContext("2d")},_destroyContainer:function(){delete this._ctx,st(this._container),W(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){for(var t in this._redrawBounds=null,this._layers)this._layers[t]._update();this._redraw()}},_update:function(){if(!this._map._animatingZoom||!this._bounds){this._drawnLayers={},rn.prototype._update.call(this);var t=this._bounds,e=this._container,i=t.getSize(),n=De?2:1;_t(e,t.min),e.width=n*i.x,e.height=n*i.y,e.style.width=i.x+"px",e.style.height=i.y+"px",De&&this._ctx.scale(2,2),this._ctx.translate(-t.min.x,-t.min.y),this.fire("update")}},_reset:function(){rn.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(t){this._updateDashArray(t),this._layers[n(t)]=t;var e=t._order={layer:t,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=e),this._drawLast=e,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(t){this._requestRedraw(t)},_removePath:function(t){var e=t._order,i=e.next,n=e.prev;i?i.prev=n:this._drawLast=n,n?n.next=i:this._drawFirst=i,delete t._order,delete this._layers[L.stamp(t)],this._requestRedraw(t)},_updatePath:function(t){this._extendRedrawBounds(t),t._project(),t._update(),this._requestRedraw(t)},_updateStyle:function(t){this._updateDashArray(t),this._requestRedraw(t)},_updateDashArray:function(t){if(t.options.dashArray){var e,i=t.options.dashArray.split(","),n=[];for(e=0;e<i.length;e++)n.push(Number(i[e]));t.options._dashArray=n}},_requestRedraw:function(t){this._map&&(this._extendRedrawBounds(t),this._redrawRequest=this._redrawRequest||_(this._redraw,this))},_extendRedrawBounds:function(t){if(t._pxBounds){var e=(t.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new w,this._redrawBounds.extend(t._pxBounds.min.subtract([e,e])),this._redrawBounds.extend(t._pxBounds.max.add([e,e]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var t=this._redrawBounds;if(t){var e=t.getSize();this._ctx.clearRect(t.min.x,t.min.y,e.x,e.y)}else this._ctx.clearRect(0,0,this._container.width,this._container.height)},_draw:function(){var t,e=this._redrawBounds;if(this._ctx.save(),e){var i=e.getSize();this._ctx.beginPath(),this._ctx.rect(e.min.x,e.min.y,i.x,i.y),this._ctx.clip()}this._drawing=!0;for(var n=this._drawFirst;n;n=n.next)t=n.layer,(!e||t._pxBounds&&t._pxBounds.intersects(e))&&t._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(t,e){if(this._drawing){var i,n,s,o,r=t._parts,a=r.length,h=this._ctx;if(a){for(this._drawnLayers[t._leaflet_id]=t,h.beginPath(),i=0;i<a;i++){for(n=0,s=r[i].length;n<s;n++)o=r[i][n],h[n?"lineTo":"moveTo"](o.x,o.y);e&&h.closePath()}this._fillStroke(h,t)}}},_updateCircle:function(t){if(this._drawing&&!t._empty()){var e=t._point,i=this._ctx,n=Math.max(Math.round(t._radius),1),s=(Math.max(Math.round(t._radiusY),1)||n)/n;this._drawnLayers[t._leaflet_id]=t,1!==s&&(i.save(),i.scale(1,s)),i.beginPath(),i.arc(e.x,e.y/s,n,0,2*Math.PI,!1),1!==s&&i.restore(),this._fillStroke(i,t)}},_fillStroke:function(t,e){var i=e.options;i.fill&&(t.globalAlpha=i.fillOpacity,t.fillStyle=i.fillColor||i.color,t.fill(i.fillRule||"evenodd")),i.stroke&&0!==i.weight&&(t.setLineDash&&t.setLineDash(e.options&&e.options._dashArray||[]),t.globalAlpha=i.opacity,t.lineWidth=i.weight,t.strokeStyle=i.color,t.lineCap=i.lineCap,t.lineJoin=i.lineJoin,t.stroke())},_onClick:function(t){for(var e,i,n=this._map.mouseEventToLayerPoint(t),s=this._drawFirst;s;s=s.next)(e=s.layer).options.interactive&&e._containsPoint(n)&&!this._map._draggableMoved(e)&&(i=e);i&&(J(t),this._fireEvent([i],t))},_onMouseMove:function(t){if(this._map&&!this._map.dragging.moving()&&!this._map._animatingZoom){var e=this._map.mouseEventToLayerPoint(t);this._handleMouseHover(t,e)}},_handleMouseOut:function(t){var e=this._hoveredLayer;e&&(ut(this._container,"leaflet-interactive"),this._fireEvent([e],t,"mouseout"),this._hoveredLayer=null)},_handleMouseHover:function(t,e){for(var i,n,s=this._drawFirst;s;s=s.next)(i=s.layer).options.interactive&&i._containsPoint(e)&&(n=i);n!==this._hoveredLayer&&(this._handleMouseOut(t),n&&(lt(this._container,"leaflet-interactive"),this._fireEvent([n],t,"mouseover"),this._hoveredLayer=n)),this._hoveredLayer&&this._fireEvent([this._hoveredLayer],t)},_fireEvent:function(t,e,i){this._map._fireDOMEvent(e,i||e.type,t)},_bringToFront:function(t){var e=t._order,i=e.next,n=e.prev;i&&(i.prev=n,n?n.next=i:i&&(this._drawFirst=i),e.prev=this._drawLast,this._drawLast.next=e,e.next=null,this._drawLast=e,this._requestRedraw(t))},_bringToBack:function(t){var e=t._order,i=e.next,n=e.prev;n&&(n.next=i,i?i.prev=n:n&&(this._drawLast=n),e.prev=null,e.next=this._drawFirst,this._drawFirst.prev=e,this._drawFirst=e,this._requestRedraw(t))}}),hn=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(t){return document.createElement("<lvml:"+t+' class="lvml">')}}catch(t){return function(t){return document.createElement("<"+t+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}}(),ln={_initContainer:function(){this._container=nt("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(rn.prototype._update.call(this),this.fire("update"))},_initPath:function(t){var e=t._container=hn("shape");lt(e,"leaflet-vml-shape "+(this.options.className||"")),e.coordsize="1 1",t._path=hn("path"),e.appendChild(t._path),this._updateStyle(t),this._layers[n(t)]=t},_addPath:function(t){var e=t._container;this._container.appendChild(e),t.options.interactive&&t.addInteractiveTarget(e)},_removePath:function(t){var e=t._container;st(e),t.removeInteractiveTarget(e),delete this._layers[n(t)]},_updateStyle:function(t){var e=t._stroke,i=t._fill,n=t.options,s=t._container;s.stroked=!!n.stroke,s.filled=!!n.fill,n.stroke?(e||(e=t._stroke=hn("stroke")),s.appendChild(e),e.weight=n.weight+"px",e.color=n.color,e.opacity=n.opacity,n.dashArray?e.dashStyle=Vt(n.dashArray)?n.dashArray.join(" "):n.dashArray.replace(/( *, *)/g," "):e.dashStyle="",e.endcap=n.lineCap.replace("butt","flat"),e.joinstyle=n.lineJoin):e&&(s.removeChild(e),t._stroke=null),n.fill?(i||(i=t._fill=hn("fill")),s.appendChild(i),i.color=n.fillColor||n.color,i.opacity=n.fillOpacity):i&&(s.removeChild(i),t._fill=null)},_updateCircle:function(t){var e=t._point.round(),i=Math.round(t._radius),n=Math.round(t._radiusY||i);this._setPath(t,t._empty()?"M0 0":"AL "+e.x+","+e.y+" "+i+","+n+" 0,23592600")},_setPath:function(t,e){t._path.v=e},_bringToFront:function(t){rt(t._container)},_bringToBack:function(t){at(t._container)}},un=We?hn:C,cn=rn.extend({getEvents:function(){var t=rn.prototype.getEvents.call(this);return t.zoomstart=this._onZoomStart,t},_initContainer:function(){this._container=un("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=un("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){st(this._container),W(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_onZoomStart:function(){this._update()},_update:function(){if(!this._map._animatingZoom||!this._bounds){rn.prototype._update.call(this);var t=this._bounds,e=t.getSize(),i=this._container;this._svgSize&&this._svgSize.equals(e)||(this._svgSize=e,i.setAttribute("width",e.x),i.setAttribute("height",e.y)),_t(i,t.min),i.setAttribute("viewBox",[t.min.x,t.min.y,e.x,e.y].join(" ")),this.fire("update")}},_initPath:function(t){var e=t._path=un("path");t.options.className&&lt(e,t.options.className),t.options.interactive&&lt(e,"leaflet-interactive"),this._updateStyle(t),this._layers[n(t)]=t},_addPath:function(t){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(t._path),t.addInteractiveTarget(t._path)},_removePath:function(t){st(t._path),t.removeInteractiveTarget(t._path),delete this._layers[n(t)]},_updatePath:function(t){t._project(),t._update()},_updateStyle:function(t){var e=t._path,i=t.options;e&&(i.stroke?(e.setAttribute("stroke",i.color),e.setAttribute("stroke-opacity",i.opacity),e.setAttribute("stroke-width",i.weight),e.setAttribute("stroke-linecap",i.lineCap),e.setAttribute("stroke-linejoin",i.lineJoin),i.dashArray?e.setAttribute("stroke-dasharray",i.dashArray):e.removeAttribute("stroke-dasharray"),i.dashOffset?e.setAttribute("stroke-dashoffset",i.dashOffset):e.removeAttribute("stroke-dashoffset")):e.setAttribute("stroke","none"),i.fill?(e.setAttribute("fill",i.fillColor||i.color),e.setAttribute("fill-opacity",i.fillOpacity),e.setAttribute("fill-rule",i.fillRule||"evenodd")):e.setAttribute("fill","none"))},_updatePoly:function(t,e){this._setPath(t,A(t._parts,e))},_updateCircle:function(t){var e=t._point,i=Math.max(Math.round(t._radius),1),n="a"+i+","+(Math.max(Math.round(t._radiusY),1)||i)+" 0 1,0 ",s=t._empty()?"M0 0":"M"+(e.x-i)+","+e.y+n+2*i+",0 "+n+2*-i+",0 ";this._setPath(t,s)},_setPath:function(t,e){t._path.setAttribute("d",e)},_bringToFront:function(t){rt(t._path)},_bringToBack:function(t){at(t._path)}});We&&cn.include(ln),di.include({getRenderer:function(t){var e=t.options.renderer||this._getPaneRenderer(t.options.pane)||this.options.renderer||this._renderer;return e||(e=this._renderer=this.options.preferCanvas&&Ft()||Wt()),this.hasLayer(e)||this.addLayer(e),e},_getPaneRenderer:function(t){if("overlayPane"===t||void 0===t)return!1;var e=this._paneRenderers[t];return void 0===e&&(e=cn&&Wt({pane:t})||an&&Ft({pane:t}),this._paneRenderers[t]=e),e}});var fn=qi.extend({initialize:function(t,e){qi.prototype.initialize.call(this,this._boundsToLatLngs(t),e)},setBounds:function(t){return this.setLatLngs(this._boundsToLatLngs(t))},_boundsToLatLngs:function(t){return[(t=M(t)).getSouthWest(),t.getNorthWest(),t.getNorthEast(),t.getSouthEast()]}});cn.create=un,cn.pointsToPath=A,Vi.geometryToLayer=Ot,Vi.coordsToLatLng=Rt,Vi.coordsToLatLngs=zt,Vi.latLngToCoords=It,Vi.latLngsToCoords=Bt,Vi.getFeature=Nt,Vi.asFeature=Zt,di.mergeOptions({boxZoom:!0});var dn=xi.extend({initialize:function(t){this._map=t,this._container=t._container,this._pane=t._panes.overlayPane,this._resetStateTimeout=0,t.on("unload",this._destroy,this)},addHooks:function(){F(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){W(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){st(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){0!==this._resetStateTimeout&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(t){if(!t.shiftKey||1!==t.which&&1!==t.button)return!1;this._clearDeferredResetState(),this._resetState(),re(),yt(),this._startPoint=this._map.mouseEventToContainerPoint(t),F(document,{contextmenu:G,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(t){this._moved||(this._moved=!0,this._box=nt("div","leaflet-zoom-box",this._container),lt(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(t);var e=new w(this._point,this._startPoint),i=e.getSize();_t(this._box,e.min),this._box.style.width=i.x+"px",this._box.style.height=i.y+"px"},_finish:function(){this._moved&&(st(this._box),ut(this._container,"leaflet-crosshair")),ae(),vt(),W(document,{contextmenu:G,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(t){if((1===t.which||1===t.button)&&(this._finish(),this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(i(this._resetState,this),0);var e=new P(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(e).fire("boxzoomend",{boxZoomBounds:e})}},_onKeyDown:function(t){27===t.keyCode&&this._finish()}});di.addInitHook("addHandler","boxZoom",dn),di.mergeOptions({doubleClickZoom:!0});var pn=xi.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(t){var e=this._map,i=e.getZoom(),n=e.options.zoomDelta,s=t.originalEvent.shiftKey?i-n:i+n;"center"===e.options.doubleClickZoom?e.setZoom(s):e.setZoomAround(t.containerPoint,s)}});di.addInitHook("addHandler","doubleClickZoom",pn),di.mergeOptions({dragging:!0,inertia:!ge,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var mn=xi.extend({addHooks:function(){if(!this._draggable){var t=this._map;this._draggable=new Si(t._mapPane,t._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),t.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),t.on("zoomend",this._onZoomEnd,this),t.whenReady(this._onZoomEnd,this))}lt(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){ut(this._map._container,"leaflet-grab"),ut(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var t=this._map;if(t._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var e=M(this._map.options.maxBounds);this._offsetLimit=b(this._map.latLngToContainerPoint(e.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(e.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;t.fire("movestart").fire("dragstart"),t.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(t){if(this._map.options.inertia){var e=this._lastTime=+new Date,i=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(i),this._times.push(e),this._prunePositions(e)}this._map.fire("move",t).fire("drag",t)},_prunePositions:function(t){for(;this._positions.length>1&&t-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var t=this._map.getSize().divideBy(2),e=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=e.subtract(t).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(t,e){return t-(t-e)*this._viscosity},_onPreDragLimit:function(){if(this._viscosity&&this._offsetLimit){var t=this._draggable._newPos.subtract(this._draggable._startPos),e=this._offsetLimit;t.x<e.min.x&&(t.x=this._viscousLimit(t.x,e.min.x)),t.y<e.min.y&&(t.y=this._viscousLimit(t.y,e.min.y)),t.x>e.max.x&&(t.x=this._viscousLimit(t.x,e.max.x)),t.y>e.max.y&&(t.y=this._viscousLimit(t.y,e.max.y)),this._draggable._newPos=this._draggable._startPos.add(t)}},_onPreDragWrap:function(){var t=this._worldWidth,e=Math.round(t/2),i=this._initialWorldOffset,n=this._draggable._newPos.x,s=(n-e+i)%t+e-i,o=(n+e+i)%t-e-i,r=Math.abs(s+i)<Math.abs(o+i)?s:o;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=r},_onDragEnd:function(t){var e=this._map,i=e.options,n=!i.inertia||this._times.length<2;if(e.fire("dragend",t),n)e.fire("moveend");else{this._prunePositions(+new Date);var s=this._lastPos.subtract(this._positions[0]),o=(this._lastTime-this._times[0])/1e3,r=i.easeLinearity,a=s.multiplyBy(r/o),h=a.distanceTo([0,0]),l=Math.min(i.inertiaMaxSpeed,h),u=a.multiplyBy(l/h),c=l/(i.inertiaDeceleration*r),f=u.multiplyBy(-c/2).round();f.x||f.y?(f=e._limitOffset(f,e.options.maxBounds),_(function(){e.panBy(f,{duration:c,easeLinearity:r,noMoveStart:!0,animate:!0})})):e.fire("moveend")}}});di.addInitHook("addHandler","dragging",mn),di.mergeOptions({keyboard:!0,keyboardPanDelta:80});var _n=xi.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(t){this._map=t,this._setPanDelta(t.options.keyboardPanDelta),this._setZoomDelta(t.options.zoomDelta)},addHooks:function(){var t=this._map._container;t.tabIndex<=0&&(t.tabIndex="0"),F(t,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),W(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var t=document.body,e=document.documentElement,i=t.scrollTop||e.scrollTop,n=t.scrollLeft||e.scrollLeft;this._map._container.focus(),window.scrollTo(n,i)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(t){var e,i,n=this._panKeys={},s=this.keyCodes;for(e=0,i=s.left.length;e<i;e++)n[s.left[e]]=[-1*t,0];for(e=0,i=s.right.length;e<i;e++)n[s.right[e]]=[t,0];for(e=0,i=s.down.length;e<i;e++)n[s.down[e]]=[0,t];for(e=0,i=s.up.length;e<i;e++)n[s.up[e]]=[0,-1*t]},_setZoomDelta:function(t){var e,i,n=this._zoomKeys={},s=this.keyCodes;for(e=0,i=s.zoomIn.length;e<i;e++)n[s.zoomIn[e]]=t;for(e=0,i=s.zoomOut.length;e<i;e++)n[s.zoomOut[e]]=-t},_addHooks:function(){F(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){W(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(t){if(!(t.altKey||t.ctrlKey||t.metaKey)){var e,i=t.keyCode,n=this._map;if(i in this._panKeys){if(n._panAnim&&n._panAnim._inProgress)return;e=this._panKeys[i],t.shiftKey&&(e=x(e).multiplyBy(3)),n.panBy(e),n.options.maxBounds&&n.panInsideBounds(n.options.maxBounds)}else if(i in this._zoomKeys)n.setZoom(n.getZoom()+(t.shiftKey?3:1)*this._zoomKeys[i]);else{if(27!==i||!n._popup||!n._popup.options.closeOnEscapeKey)return;n.closePopup()}G(t)}}});di.addInitHook("addHandler","keyboard",_n),di.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var gn=xi.extend({addHooks:function(){F(this._map._container,"mousewheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){W(this._map._container,"mousewheel",this._onWheelScroll,this)},_onWheelScroll:function(t){var e=K(t),n=this._map.options.wheelDebounceTime;this._delta+=e,this._lastMousePos=this._map.mouseEventToContainerPoint(t),this._startTime||(this._startTime=+new Date);var s=Math.max(n-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(i(this._performZoom,this),s),G(t)},_performZoom:function(){var t=this._map,e=t.getZoom(),i=this._map.options.zoomSnap||0;t._stop();var n=this._delta/(4*this._map.options.wheelPxPerZoomLevel),s=4*Math.log(2/(1+Math.exp(-Math.abs(n))))/Math.LN2,o=i?Math.ceil(s/i)*i:s,r=t._limitZoom(e+(this._delta>0?o:-o))-e;this._delta=0,this._startTime=null,r&&("center"===t.options.scrollWheelZoom?t.setZoom(e+r):t.setZoomAround(this._lastMousePos,e+r))}});di.addInitHook("addHandler","scrollWheelZoom",gn),di.mergeOptions({tap:!0,tapTolerance:15});var yn=xi.extend({addHooks:function(){F(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){W(this._map._container,"touchstart",this._onDown,this)},_onDown:function(t){if(t.touches){if(Y(t),this._fireClick=!0,t.touches.length>1)return this._fireClick=!1,void clearTimeout(this._holdTimeout);var e=t.touches[0],n=e.target;this._startPos=this._newPos=new v(e.clientX,e.clientY),n.tagName&&"a"===n.tagName.toLowerCase()&&lt(n,"leaflet-active"),this._holdTimeout=setTimeout(i(function(){this._isTapValid()&&(this._fireClick=!1,this._onUp(),this._simulateEvent("contextmenu",e))},this),1e3),this._simulateEvent("mousedown",e),F(document,{touchmove:this._onMove,touchend:this._onUp},this)}},_onUp:function(t){if(clearTimeout(this._holdTimeout),W(document,{touchmove:this._onMove,touchend:this._onUp},this),this._fireClick&&t&&t.changedTouches){var e=t.changedTouches[0],i=e.target;i&&i.tagName&&"a"===i.tagName.toLowerCase()&&ut(i,"leaflet-active"),this._simulateEvent("mouseup",e),this._isTapValid()&&this._simulateEvent("click",e)}},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_onMove:function(t){var e=t.touches[0];this._newPos=new v(e.clientX,e.clientY),this._simulateEvent("mousemove",e)},_simulateEvent:function(t,e){var i=document.createEvent("MouseEvents");i._simulated=!0,e.target._simulatedClick=!0,i.initMouseEvent(t,!0,!0,window,1,e.screenX,e.screenY,e.clientX,e.clientY,!1,!1,!1,!1,0,null),e.target.dispatchEvent(i)}});Be&&!Ie&&di.addInitHook("addHandler","tap",yn),di.mergeOptions({touchZoom:Be&&!ge,bounceAtZoomLimits:!0});var vn=xi.extend({addHooks:function(){lt(this._map._container,"leaflet-touch-zoom"),F(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){ut(this._map._container,"leaflet-touch-zoom"),W(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(t){var e=this._map;if(t.touches&&2===t.touches.length&&!e._animatingZoom&&!this._zooming){var i=e.mouseEventToContainerPoint(t.touches[0]),n=e.mouseEventToContainerPoint(t.touches[1]);this._centerPoint=e.getSize()._divideBy(2),this._startLatLng=e.containerPointToLatLng(this._centerPoint),"center"!==e.options.touchZoom&&(this._pinchStartLatLng=e.containerPointToLatLng(i.add(n)._divideBy(2))),this._startDist=i.distanceTo(n),this._startZoom=e.getZoom(),this._moved=!1,this._zooming=!0,e._stop(),F(document,"touchmove",this._onTouchMove,this),F(document,"touchend",this._onTouchEnd,this),Y(t)}},_onTouchMove:function(t){if(t.touches&&2===t.touches.length&&this._zooming){var e=this._map,n=e.mouseEventToContainerPoint(t.touches[0]),s=e.mouseEventToContainerPoint(t.touches[1]),o=n.distanceTo(s)/this._startDist;if(this._zoom=e.getScaleZoom(o,this._startZoom),!e.options.bounceAtZoomLimits&&(this._zoom<e.getMinZoom()&&o<1||this._zoom>e.getMaxZoom()&&o>1)&&(this._zoom=e._limitZoom(this._zoom)),"center"===e.options.touchZoom){if(this._center=this._startLatLng,1===o)return}else{var r=n._add(s)._divideBy(2)._subtract(this._centerPoint);if(1===o&&0===r.x&&0===r.y)return;this._center=e.unproject(e.project(this._pinchStartLatLng,this._zoom).subtract(r),this._zoom)}this._moved||(e._moveStart(!0,!1),this._moved=!0),g(this._animRequest);var a=i(e._move,e,this._center,this._zoom,{pinch:!0,round:!1});this._animRequest=_(a,this,!0),Y(t)}},_onTouchEnd:function(){this._moved&&this._zooming?(this._zooming=!1,g(this._animRequest),W(document,"touchmove",this._onTouchMove),W(document,"touchend",this._onTouchEnd),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))):this._zooming=!1}});di.addInitHook("addHandler","touchZoom",vn),di.BoxZoom=dn,di.DoubleClickZoom=pn,di.Drag=mn,di.Keyboard=_n,di.ScrollWheelZoom=gn,di.Tap=yn,di.TouchZoom=vn;var xn=window.L;window.L=t,Object.freeze=Ut,t.version="1.3.1",t.noConflict=function(){return window.L=xn,this},t.Control=pi,t.control=mi,t.Browser=Ue,t.Evented=te,t.Mixin=bi,t.Util=Jt,t.Class=y,t.Handler=xi,t.extend=e,t.bind=i,t.stamp=n,t.setOptions=u,t.DomEvent=si,t.DomUtil=ci,t.PosAnimation=fi,t.Draggable=Si,t.LineUtil=Li,t.PolyUtil=ki,t.Point=v,t.point=x,t.Bounds=w,t.bounds=b,t.Transformation=k,t.transformation=E,t.Projection=Ai,t.LatLng=T,t.latLng=S,t.LatLngBounds=P,t.latLngBounds=M,t.CRS=ie,t.GeoJSON=Vi,t.geoJSON=Dt,t.geoJson=Gi,t.Layer=Ii,t.LayerGroup=Bi,t.layerGroup=function(t,e){return new Bi(t,e)},t.FeatureGroup=Ni,t.featureGroup=function(t){return new Ni(t)},t.ImageOverlay=$i,t.imageOverlay=function(t,e,i){return new $i(t,e,i)},t.VideoOverlay=Ki,t.videoOverlay=function(t,e,i){return new Ki(t,e,i)},t.DivOverlay=Ji,t.Popup=Qi,t.popup=function(t,e){return new Qi(t,e)},t.Tooltip=tn,t.tooltip=function(t,e){return new tn(t,e)},t.Icon=Zi,t.icon=function(t){return new Zi(t)},t.DivIcon=en,t.divIcon=function(t){return new en(t)},t.Marker=Fi,t.marker=function(t,e){return new Fi(t,e)},t.TileLayer=sn,t.tileLayer=jt,t.GridLayer=nn,t.gridLayer=function(t){return new nn(t)},t.SVG=cn,t.svg=Wt,t.Renderer=rn,t.Canvas=an,t.canvas=Ft,t.Path=Wi,t.CircleMarker=Ui,t.circleMarker=function(t,e){return new Ui(t,e)},t.Circle=Hi,t.circle=function(t,e,i){return new Hi(t,e,i)},t.Polyline=Xi,t.polyline=function(t,e){return new Xi(t,e)},t.Polygon=qi,t.polygon=function(t,e){return new qi(t,e)},t.Rectangle=fn,t.rectangle=function(t,e){return new fn(t,e)},t.Map=di,t.map=function(t,e){return new di(t,e)}}),function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e():"function"==typeof define&&define.amd?define(e):e()}(0,function(){"use strict";class t{constructor(t,e,i,n){this.RoughSegmentRelationConst={LEFT:0,RIGHT:1,INTERSECTS:2,AHEAD:3,BEHIND:4,SEPARATE:5,UNDEFINED:6},this.px1=t,this.py1=e,this.px2=i,this.py2=n,this.xi=Number.MAX_VALUE,this.yi=Number.MAX_VALUE,this.a=n-e,this.b=t-i,this.c=i*e-t*n,this._undefined=0==this.a&&0==this.b&&0==this.c}isUndefined(){return this._undefined}compare(t){if(this.isUndefined()||t.isUndefined())return this.RoughSegmentRelationConst.UNDEFINED;var e=Number.MAX_VALUE,i=Number.MAX_VALUE,n=0,s=0,o=this.a,r=this.b,a=this.c;return Math.abs(r)>1e-5&&(e=-o/r,n=-a/r),Math.abs(t.b)>1e-5&&(i=-t.a/t.b,s=-t.c/t.b),e==Number.MAX_VALUE?i==Number.MAX_VALUE?-a/o!=-t.c/t.a?this.RoughSegmentRelationConst.SEPARATE:this.py1>=Math.min(t.py1,t.py2)&&this.py1<=Math.max(t.py1,t.py2)?(this.xi=this.px1,this.yi=this.py1,this.RoughSegmentRelationConst.INTERSECTS):this.py2>=Math.min(t.py1,t.py2)&&this.py2<=Math.max(t.py1,t.py2)?(this.xi=this.px2,this.yi=this.py2,this.RoughSegmentRelationConst.INTERSECTS):this.RoughSegmentRelationConst.SEPARATE:(this.xi=this.px1,this.yi=i*this.xi+s,(this.py1-this.yi)*(this.yi-this.py2)<-1e-5||(t.py1-this.yi)*(this.yi-t.py2)<-1e-5?this.RoughSegmentRelationConst.SEPARATE:Math.abs(t.a)<1e-5&&(t.px1-this.xi)*(this.xi-t.px2)<-1e-5?this.RoughSegmentRelationConst.SEPARATE:this.RoughSegmentRelationConst.INTERSECTS):i==Number.MAX_VALUE?(this.xi=t.px1,this.yi=e*this.xi+n,(t.py1-this.yi)*(this.yi-t.py2)<-1e-5||(this.py1-this.yi)*(this.yi-this.py2)<-1e-5?this.RoughSegmentRelationConst.SEPARATE:Math.abs(o)<1e-5&&(this.px1-this.xi)*(this.xi-this.px2)<-1e-5?this.RoughSegmentRelationConst.SEPARATE:this.RoughSegmentRelationConst.INTERSECTS):e==i?n!=s?this.RoughSegmentRelationConst.SEPARATE:this.px1>=Math.min(t.px1,t.px2)&&this.px1<=Math.max(t.py1,t.py2)?(this.xi=this.px1,this.yi=this.py1,this.RoughSegmentRelationConst.INTERSECTS):this.px2>=Math.min(t.px1,t.px2)&&this.px2<=Math.max(t.px1,t.px2)?(this.xi=this.px2,this.yi=this.py2,this.RoughSegmentRelationConst.INTERSECTS):this.RoughSegmentRelationConst.SEPARATE:(this.xi=(s-n)/(e-i),this.yi=e*this.xi+n,(this.px1-this.xi)*(this.xi-this.px2)<-1e-5||(t.px1-this.xi)*(this.xi-t.px2)<-1e-5?this.RoughSegmentRelationConst.SEPARATE:this.RoughSegmentRelationConst.INTERSECTS)}getLength(){return this._getLength(this.px1,this.py1,this.px2,this.py2)}_getLength(t,e,i,n){var s=i-t,o=n-e;return Math.sqrt(s*s+o*o)}}class e{constructor(e,i,n,s,o,r,a,h){this.top=e,this.bottom=i,this.left=n,this.right=s,this.gap=o,this.sinAngle=r,this.tanAngle=h,Math.abs(r)<1e-4?this.pos=n+o:Math.abs(r)>.9999?this.pos=e+o:(this.deltaX=(i-e)*Math.abs(h),this.pos=n-Math.abs(this.deltaX),this.hGap=Math.abs(o/a),this.sLeft=new t(n,i,n,e),this.sRight=new t(s,i,s,e))}getNextLine(){if(Math.abs(this.sinAngle)<1e-4){if(this.pos<this.right){let t=[this.pos,this.top,this.pos,this.bottom];return this.pos+=this.gap,t}}else if(Math.abs(this.sinAngle)>.9999){if(this.pos<this.bottom){let t=[this.left,this.pos,this.right,this.pos];return this.pos+=this.gap,t}}else{let e=this.pos-this.deltaX/2,i=this.pos+this.deltaX/2,n=this.bottom,s=this.top;if(this.pos<this.right+this.deltaX){for(;e<this.left&&i<this.left||e>this.right&&i>this.right;)if(this.pos+=this.hGap,e=this.pos-this.deltaX/2,i=this.pos+this.deltaX/2,this.pos>this.right+this.deltaX)return null;let o=new t(e,n,i,s);2==o.compare(this.sLeft)&&(e=o.xi,n=o.yi),2==o.compare(this.sRight)&&(i=o.xi,s=o.yi),this.tanAngle>0&&(e=this.right-(e-this.left),i=this.right-(i-this.left));let r=[e,n,i,s];return this.pos+=this.hGap,r}}return null}}class i{constructor(t,e){this.type=t,this.text=e}isType(t){return this.type===t}}class n{constructor(t){this.PARAMS={A:["rx","ry","x-axis-rotation","large-arc-flag","sweep-flag","x","y"],a:["rx","ry","x-axis-rotation","large-arc-flag","sweep-flag","x","y"],C:["x1","y1","x2","y2","x","y"],c:["x1","y1","x2","y2","x","y"],H:["x"],h:["x"],L:["x","y"],l:["x","y"],M:["x","y"],m:["x","y"],Q:["x1","y1","x","y"],q:["x1","y1","x","y"],S:["x2","y2","x","y"],s:["x2","y2","x","y"],T:["x","y"],t:["x","y"],V:["y"],v:["y"],Z:[],z:[]},this.COMMAND=0,this.NUMBER=1,this.EOD=2,this.segments=[],this.d=t||"",this.parseData(t),this.processPoints()}loadFromSegments(t){this.segments=t,this.processPoints()}processPoints(){let t=null,e=[0,0];for(let i=0;i<this.segments.length;i++){let n=this.segments[i];switch(n.key){case"M":case"L":case"T":n.point=[n.data[0],n.data[1]];break;case"m":case"l":case"t":n.point=[n.data[0]+e[0],n.data[1]+e[1]];break;case"H":n.point=[n.data[0],e[1]];break;case"h":n.point=[n.data[0]+e[0],e[1]];break;case"V":n.point=[e[0],n.data[0]];break;case"v":n.point=[e[0],n.data[0]+e[1]];break;case"z":case"Z":t&&(n.point=[t[0],t[1]]);break;case"C":n.point=[n.data[4],n.data[5]];break;case"c":n.point=[n.data[4]+e[0],n.data[5]+e[1]];break;case"S":n.point=[n.data[2],n.data[3]];break;case"s":n.point=[n.data[2]+e[0],n.data[3]+e[1]];break;case"Q":n.point=[n.data[2],n.data[3]];break;case"q":n.point=[n.data[2]+e[0],n.data[3]+e[1]];break;case"A":n.point=[n.data[5],n.data[6]];break;case"a":n.point=[n.data[5]+e[0],n.data[6]+e[1]]}"m"!==n.key&&"M"!==n.key||(t=null),n.point&&(e=n.point,t||(t=n.point)),"z"!==n.key&&"Z"!==n.key||(t=null)}}get closed(){if(void 0===this._closed){this._closed=!1;for(let t of this.segments)"z"===t.key.toLowerCase()&&(this._closed=!0)}return this._closed}parseData(t){var e=this.tokenize(t),i=0,n=e[i],s="BOD";for(this.segments=new Array;!n.isType(this.EOD);){var o,r=new Array;if("BOD"==s){if("M"!=n.text&&"m"!=n.text)return this.parseData("M0,0"+t);i++,o=this.PARAMS[n.text].length,s=n.text}else n.isType(this.NUMBER)?o=this.PARAMS[s].length:(i++,o=this.PARAMS[n.text].length,s=n.text);if(i+o<e.length){for(var a=i;a<i+o;a++){var h=e[a];if(!h.isType(this.NUMBER))return void console.error("Parameter type is not a number: "+s+","+h.text);r[r.length]=h.text}var l;if(!this.PARAMS[s])return void console.error("Unsupported segment type: "+s);l={key:s,data:r},this.segments.push(l),n=e[i+=o],"M"==s&&(s="L"),"m"==s&&(s="l")}else console.error("Path data ended before all parameters were found")}}tokenize(t){for(var e=new Array;""!=t;)if(t.match(/^([ \t\r\n,]+)/))t=t.substr(RegExp.$1.length);else if(t.match(/^([aAcChHlLmMqQsStTvVzZ])/))e[e.length]=new i(this.COMMAND,RegExp.$1),t=t.substr(RegExp.$1.length);else{if(!t.match(/^(([-+]?[0-9]+(\.[0-9]*)?|[-+]?\.[0-9]+)([eE][-+]?[0-9]+)?)/))return console.error("Unrecognized segment command: "+t),null;e[e.length]=new i(this.NUMBER,parseFloat(RegExp.$1)),t=t.substr(RegExp.$1.length)}return e[e.length]=new i(this.EOD,null),e}}class s{constructor(t){this.d=t,this.parsed=new n(t),this._position=[0,0],this.bezierReflectionPoint=null,this.quadReflectionPoint=null,this._first=null}get segments(){return this.parsed.segments}get closed(){return this.parsed.closed}get linearPoints(){if(!this._linearPoints){const t=[];let e=[];for(let i of this.parsed.segments){let n=i.key.toLowerCase();("m"!==n&&"z"!==n||(e.length&&(t.push(e),e=[]),"z"!==n))&&(i.point&&e.push(i.point))}e.length&&(t.push(e),e=[]),this._linearPoints=t}return this._linearPoints}get first(){return this._first}set first(t){this._first=t}setPosition(t,e){this._position=[t,e],this._first||(this._first=[t,e])}get position(){return this._position}get x(){return this._position[0]}get y(){return this._position[1]}}class o{constructor(t,e,i,n,s,o){const r=Math.PI/180;if(this._segIndex=0,this._numSegs=0,t[0]==e[0]&&t[1]==e[1])return;this._rx=Math.abs(i[0]),this._ry=Math.abs(i[1]),this._sinPhi=Math.sin(n*r),this._cosPhi=Math.cos(n*r);var a,h=this._cosPhi*(t[0]-e[0])/2+this._sinPhi*(t[1]-e[1])/2,l=-this._sinPhi*(t[0]-e[0])/2+this._cosPhi*(t[1]-e[1])/2,u=this._rx*this._rx*this._ry*this._ry-this._rx*this._rx*l*l-this._ry*this._ry*h*h;if(u<0){let t=Math.sqrt(1-u/(this._rx*this._rx*this._ry*this._ry));this._rx=t,this._ry=t,a=0}else a=(s==o?-1:1)*Math.sqrt(u/(this._rx*this._rx*l*l+this._ry*this._ry*h*h));let c=a*this._rx*l/this._ry,f=-a*this._ry*h/this._rx;this._C=[0,0],this._C[0]=this._cosPhi*c-this._sinPhi*f+(t[0]+e[0])/2,this._C[1]=this._sinPhi*c+this._cosPhi*f+(t[1]+e[1])/2,this._theta=this.calculateVectorAngle(1,0,(h-c)/this._rx,(l-f)/this._ry);let d=this.calculateVectorAngle((h-c)/this._rx,(l-f)/this._ry,(-h-c)/this._rx,(-l-f)/this._ry);!o&&d>0?d-=2*Math.PI:o&&d<0&&(d+=2*Math.PI),this._numSegs=Math.ceil(Math.abs(d/(Math.PI/2))),this._delta=d/this._numSegs,this._T=8/3*Math.sin(this._delta/4)*Math.sin(this._delta/4)/Math.sin(this._delta/2),this._from=t}getNextSegment(){var t,e,i;if(this._segIndex==this._numSegs)return null;let n=Math.cos(this._theta),s=Math.sin(this._theta),o=this._theta+this._delta,r=Math.cos(o),a=Math.sin(o);return i=[this._cosPhi*this._rx*r-this._sinPhi*this._ry*a+this._C[0],this._sinPhi*this._rx*r+this._cosPhi*this._ry*a+this._C[1]],t=[this._from[0]+this._T*(-this._cosPhi*this._rx*s-this._sinPhi*this._ry*n),this._from[1]+this._T*(-this._sinPhi*this._rx*s+this._cosPhi*this._ry*n)],e=[i[0]+this._T*(this._cosPhi*this._rx*a+this._sinPhi*this._ry*r),i[1]+this._T*(this._sinPhi*this._rx*a-this._cosPhi*this._ry*r)],this._theta=o,this._from=[i[0],i[1]],this._segIndex++,{cp1:t,cp2:e,to:i}}calculateVectorAngle(t,e,i,n){let s=Math.atan2(e,t),o=Math.atan2(n,i);return o>=s?o-s:2*Math.PI-(s-o)}}class r{constructor(t,e){this.sets=t,this.closed=e}fit(t){let e=[];for(const i of this.sets){let n=i.length,s=Math.floor(t*n);if(s<5){if(n<=5)continue;s=5}e.push(this.reduce(i,s))}let i="";for(const t of e){for(let e=0;e<t.length;e++){let n=t[e];i+=0===e?"M"+n[0]+","+n[1]:"L"+n[0]+","+n[1]}this.closed&&(i+="z ")}return i}distance(t,e){return Math.sqrt(Math.pow(t[0]-e[0],2)+Math.pow(t[1]-e[1],2))}reduce(t,e){if(t.length<=e)return t;let i=t.slice(0);for(;i.length>e;){let t=-1,e=-1;for(let n=1;n<i.length-1;n++){let s=this.distance(i[n-1],i[n]),o=this.distance(i[n],i[n+1]),r=this.distance(i[n-1],i[n+1]),a=(s+o+r)/2,h=Math.sqrt(a*(a-s)*(a-o)*(a-r));(t<0||h<t)&&(t=h,e=n)}if(!(e>0))break;i.splice(e,1)}return i}}class a{line(t,e,i,n,s){return{type:"path",ops:this._doubleLine(t,e,i,n,s)}}linearPath(t,e,i){const n=(t||[]).length;if(n>2){let s=[];for(let e=0;e<n-1;e++)s=s.concat(this._doubleLine(t[e][0],t[e][1],t[e+1][0],t[e+1][1],i));return e&&(s=s.concat(this._doubleLine(t[n-1][0],t[n-1][1],t[0][0],t[0][1],i))),{type:"path",ops:s}}if(2===n)return this.line(t[0][0],t[0][1],t[1][0],t[1][1],i)}polygon(t,e){return this.linearPath(t,!0,e)}rectangle(t,e,i,n,s){let o=[[t,e],[t+i,e],[t+i,e+n],[t,e+n]];return this.polygon(o,s)}curve(t,e){let i=this._curveWithOffset(t,1*(1+.2*e.roughness),e),n=this._curveWithOffset(t,1.5*(1+.22*e.roughness),e);return{type:"path",ops:i.concat(n)}}ellipse(t,e,i,n,s){const o=2*Math.PI/s.curveStepCount;let r=Math.abs(i/2),a=Math.abs(n/2);r+=this._getOffset(.05*-r,.05*r,s),a+=this._getOffset(.05*-a,.05*a,s);let h=this._ellipse(o,t,e,r,a,1,o*this._getOffset(.1,this._getOffset(.4,1,s),s),s),l=this._ellipse(o,t,e,r,a,1.5,0,s);return{type:"path",ops:h.concat(l)}}arc(t,e,i,n,s,o,r,a,h){let l=t,u=e,c=Math.abs(i/2),f=Math.abs(n/2);c+=this._getOffset(.01*-c,.01*c,h),f+=this._getOffset(.01*-f,.01*f,h);let d=s,p=o;for(;d<0;)d+=2*Math.PI,p+=2*Math.PI;p-d>2*Math.PI&&(d=0,p=2*Math.PI);let m=2*Math.PI/h.curveStepCount,_=Math.min(m/2,(p-d)/2),g=this._arc(_,l,u,c,f,d,p,1,h),y=this._arc(_,l,u,c,f,d,p,1.5,h),v=g.concat(y);return r&&(a?v=(v=v.concat(this._doubleLine(l,u,l+c*Math.cos(d),u+f*Math.sin(d),h))).concat(this._doubleLine(l,u,l+c*Math.cos(p),u+f*Math.sin(p),h)):(v.push({op:"lineTo",data:[l,u]}),v.push({op:"lineTo",data:[l+c*Math.cos(d),u+f*Math.sin(d)]}))),{type:"path",ops:v}}hachureFillArc(t,e,i,n,s,o,r){let a=t,h=e,l=Math.abs(i/2),u=Math.abs(n/2);l+=this._getOffset(.01*-l,.01*l,r),u+=this._getOffset(.01*-u,.01*u,r);let c=s,f=o;for(;c<0;)c+=2*Math.PI,f+=2*Math.PI;f-c>2*Math.PI&&(c=0,f=2*Math.PI);let d=(f-c)/r.curveStepCount,p=[],m=[];for(let t=c;t<=f;t+=d)p.push(a+l*Math.cos(t)),m.push(h+u*Math.sin(t));return p.push(a+l*Math.cos(f)),m.push(h+u*Math.sin(f)),p.push(a),m.push(h),this.hachureFillShape(p,m,r)}solidFillShape(t,e,i){let n=[];if(t&&e&&t.length&&e.length&&t.length===e.length){let o=i.maxRandomnessOffset||0;const r=t.length;if(r>2){n.push({op:"move",data:[t[0]+this._getOffset(-o,o,i),e[0]+this._getOffset(-o,o,i)]});for(var s=1;s<r;s++)n.push({op:"lineTo",data:[t[s]+this._getOffset(-o,o,i),e[s]+this._getOffset(-o,o,i)]})}}return{type:"fillPath",ops:n}}hachureFillShape(t,i,n){let s=[];if(t&&i&&t.length&&i.length){let o=t[0],r=t[0],a=i[0],h=i[0];for(let e=1;e<t.length;e++)o=Math.min(o,t[e]),r=Math.max(r,t[e]),a=Math.min(a,i[e]),h=Math.max(h,i[e]);const l=n.hachureAngle;let u=n.hachureGap;u<0&&(u=4*n.strokeWidth),u=Math.max(u,.1);const c=l%180*(Math.PI/180),f=Math.cos(c),d=Math.sin(c),p=Math.tan(c),m=new e(a-1,h+1,o-1,r+1,u,d,f,p);let _;for(;null!=(_=m.getNextLine());){let e=this._getIntersectingLines(_,t,i);for(let t=0;t<e.length;t++)if(t<e.length-1){let i=e[t],o=e[t+1];s=s.concat(this._doubleLine(i[0],i[1],o[0],o[1],n))}}}return{type:"path",ops:s}}hachureFillEllipse(t,e,i,n,s){let o=[],r=Math.abs(i/2),a=Math.abs(n/2);r+=this._getOffset(.05*-r,.05*r,s),a+=this._getOffset(.05*-a,.05*a,s);let h=s.hachureAngle,l=s.hachureGap;l<=0&&(l=4*s.strokeWidth);let u=s.fillWeight;u<0&&(u=s.strokeWidth/2);let c=h%180*(Math.PI/180),f=Math.tan(c),d=a/r,p=Math.sqrt(d*f*d*f+1),m=d*f/p,_=1/p,g=l/(r*a/Math.sqrt(a*_*(a*_)+r*m*(r*m))/r),y=Math.sqrt(r*r-(t-r+g)*(t-r+g));for(var v=t-r+g;v<t+r;v+=g){y=Math.sqrt(r*r-(t-v)*(t-v));let i=this._affine(v,e-y,t,e,m,_,d),n=this._affine(v,e+y,t,e,m,_,d);o=o.concat(this._doubleLine(i[0],i[1],n[0],n[1],s))}return{type:"path",ops:o}}svgPath(t,e){t=(t||"").replace(/\n/g," ").replace(/(-)/g," -").replace(/(-\s)/g,"-").replace("/(ss)/g"," ");let i=new s(t);if(e.simplification){let t=new r(i.linearPoints,i.closed).fit(e.simplification);i=new s(t)}let n=[],o=i.segments||[];for(let t=0;t<o.length;t++){let s=o[t],r=t>0?o[t-1]:null,a=this._processSegment(i,s,r,e);a&&a.length&&(n=n.concat(a))}return{type:"path",ops:n}}_bezierTo(t,e,i,n,s,o,r,a){let h=[],l=[a.maxRandomnessOffset||1,(a.maxRandomnessOffset||1)+.5],u=null;for(let c=0;c<2;c++)0===c?h.push({op:"move",data:[r.x,r.y]}):h.push({op:"move",data:[r.x+this._getOffset(-l[0],l[0],a),r.y+this._getOffset(-l[0],l[0],a)]}),u=[s+this._getOffset(-l[c],l[c],a),o+this._getOffset(-l[c],l[c],a)],h.push({op:"bcurveTo",data:[t+this._getOffset(-l[c],l[c],a),e+this._getOffset(-l[c],l[c],a),i+this._getOffset(-l[c],l[c],a),n+this._getOffset(-l[c],l[c],a),u[0],u[1]]});return r.setPosition(u[0],u[1]),h}_processSegment(t,e,i,n){let s=[];switch(e.key){case"M":case"m":{let i="m"===e.key;if(e.data.length>=2){let o=+e.data[0],r=+e.data[1];i&&(o+=t.x,r+=t.y);let a=1*(n.maxRandomnessOffset||0);o+=this._getOffset(-a,a,n),r+=this._getOffset(-a,a,n),t.setPosition(o,r),s.push({op:"move",data:[o,r]})}break}case"L":case"l":{let i="l"===e.key;if(e.data.length>=2){let o=+e.data[0],r=+e.data[1];i&&(o+=t.x,r+=t.y),s=s.concat(this._doubleLine(t.x,t.y,o,r,n)),t.setPosition(o,r)}break}case"H":case"h":{const i="h"===e.key;if(e.data.length){let o=+e.data[0];i&&(o+=t.x),s=s.concat(this._doubleLine(t.x,t.y,o,t.y,n)),t.setPosition(o,t.y)}break}case"V":case"v":{const i="v"===e.key;if(e.data.length){let o=+e.data[0];i&&(o+=t.y),s=s.concat(this._doubleLine(t.x,t.y,t.x,o,n)),t.setPosition(t.x,o)}break}case"Z":case"z":t.first&&(s=s.concat(this._doubleLine(t.x,t.y,t.first[0],t.first[1],n)),t.setPosition(t.first[0],t.first[1]),t.first=null);break;case"C":case"c":{const i="c"===e.key;if(e.data.length>=6){let o=+e.data[0],r=+e.data[1],a=+e.data[2],h=+e.data[3],l=+e.data[4],u=+e.data[5];i&&(o+=t.x,a+=t.x,l+=t.x,r+=t.y,h+=t.y,u+=t.y);let c=this._bezierTo(o,r,a,h,l,u,t,n);s=s.concat(c),t.bezierReflectionPoint=[l+(l-a),u+(u-h)]}break}case"S":case"s":{const o="s"===e.key;if(e.data.length>=4){let a=+e.data[0],h=+e.data[1],l=+e.data[2],u=+e.data[3];o&&(a+=t.x,l+=t.x,h+=t.y,u+=t.y);let c=a,f=h,d=i?i.key:"";var r=null;"c"!=d&&"C"!=d&&"s"!=d&&"S"!=d||(r=t.bezierReflectionPoint),r&&(c=r[0],f=r[1]);let p=this._bezierTo(c,f,a,h,l,u,t,n);s=s.concat(p),t.bezierReflectionPoint=[l+(l-a),u+(u-h)]}break}case"Q":case"q":{const i="q"===e.key;if(e.data.length>=4){let o=+e.data[0],r=+e.data[1],a=+e.data[2],h=+e.data[3];i&&(o+=t.x,a+=t.x,r+=t.y,h+=t.y);let l=1*(1+.2*n.roughness),u=1.5*(1+.22*n.roughness);s.push({op:"move",data:[t.x+this._getOffset(-l,l,n),t.y+this._getOffset(-l,l,n)]});let c=[a+this._getOffset(-l,l,n),h+this._getOffset(-l,l,n)];s.push({op:"qcurveTo",data:[o+this._getOffset(-l,l,n),r+this._getOffset(-l,l,n),c[0],c[1]]}),s.push({op:"move",data:[t.x+this._getOffset(-u,u,n),t.y+this._getOffset(-u,u,n)]}),c=[a+this._getOffset(-u,u,n),h+this._getOffset(-u,u,n)],s.push({op:"qcurveTo",data:[o+this._getOffset(-u,u,n),r+this._getOffset(-u,u,n),c[0],c[1]]}),t.setPosition(c[0],c[1]),t.quadReflectionPoint=[a+(a-o),h+(h-r)]}break}case"T":case"t":{const o="t"===e.key;if(e.data.length>=2){let a=+e.data[0],h=+e.data[1];o&&(a+=t.x,h+=t.y);let l=a,u=h,c=i?i.key:"";r=null;"q"!=c&&"Q"!=c&&"t"!=c&&"T"!=c||(r=t.quadReflectionPoint),r&&(l=r[0],u=r[1]);let f=1*(1+.2*n.roughness),d=1.5*(1+.22*n.roughness);s.push({op:"move",data:[t.x+this._getOffset(-f,f,n),t.y+this._getOffset(-f,f,n)]});let p=[a+this._getOffset(-f,f,n),h+this._getOffset(-f,f,n)];s.push({op:"qcurveTo",data:[l+this._getOffset(-f,f,n),u+this._getOffset(-f,f,n),p[0],p[1]]}),s.push({op:"move",data:[t.x+this._getOffset(-d,d,n),t.y+this._getOffset(-d,d,n)]}),p=[a+this._getOffset(-d,d,n),h+this._getOffset(-d,d,n)],s.push({op:"qcurveTo",data:[l+this._getOffset(-d,d,n),u+this._getOffset(-d,d,n),p[0],p[1]]}),t.setPosition(p[0],p[1]),t.quadReflectionPoint=[a+(a-l),h+(h-u)]}break}case"A":case"a":{const i="a"===e.key;if(e.data.length>=7){let r=+e.data[0],a=+e.data[1],h=+e.data[2],l=+e.data[3],u=+e.data[4],c=+e.data[5],f=+e.data[6];if(i&&(c+=t.x,f+=t.y),c==t.x&&f==t.y)break;if(0==r||0==a)s=s.concat(this._doubleLine(t.x,t.y,c,f,n)),t.setPosition(c,f);else{n.maxRandomnessOffset;for(let e=0;e<1;e++){let e=new o([t.x,t.y],[c,f],[r,a],h,!!l,!!u),i=e.getNextSegment();for(;i;){let o=this._bezierTo(i.cp1[0],i.cp1[1],i.cp2[0],i.cp2[1],i.to[0],i.to[1],t,n);s=s.concat(o),i=e.getNextSegment()}}}}break}}return s}_getOffset(t,e,i){return i.roughness*(Math.random()*(e-t)+t)}_affine(t,e,i,n,s,o,r){return[-i*o-n*s+i+o*t+s*e,r*(i*s-n*o)+n+-r*s*t+r*o*e]}_doubleLine(t,e,i,n,s){const o=this._line(t,e,i,n,s,!0,!1),r=this._line(t,e,i,n,s,!0,!0);return o.concat(r)}_line(t,e,i,n,s,o,r){const a=Math.pow(t-i,2)+Math.pow(e-n,2);let h=s.maxRandomnessOffset||0;h*h*100>a&&(h=Math.sqrt(a)/10);const l=h/2,u=.2+.2*Math.random();let c=s.bowing*s.maxRandomnessOffset*(n-e)/200,f=s.bowing*s.maxRandomnessOffset*i/200;c=this._getOffset(-c,c,s),f=this._getOffset(-f,f,s);let d=[];return o&&(r?d.push({op:"move",data:[t+this._getOffset(-l,l,s),e+this._getOffset(-l,l,s)]}):d.push({op:"move",data:[t+this._getOffset(-h,h,s),e+this._getOffset(-h,h,s)]})),r?d.push({op:"bcurveTo",data:[c+t+(i-t)*u+this._getOffset(-l,l,s),f+e+(n-e)*u+this._getOffset(-l,l,s),c+t+2*(i-t)*u+this._getOffset(-l,l,s),f+e+2*(n-e)*u+this._getOffset(-l,l,s),i+this._getOffset(-l,l,s),n+this._getOffset(-l,l,s)]}):d.push({op:"bcurveTo",data:[c+t+(i-t)*u+this._getOffset(-h,h,s),f+e+(n-e)*u+this._getOffset(-h,h,s),c+t+2*(i-t)*u+this._getOffset(-h,h,s),f+e+2*(n-e)*u+this._getOffset(-h,h,s),i+this._getOffset(-h,h,s),n+this._getOffset(-h,h,s)]}),d}_curve(t,e,i){const n=t.length;let s=[];if(n>3){const o=[],r=1-i.curveTightness;s.push({op:"move",data:[t[1][0],t[1][1]]});for(let e=1;e+2<n;e++){const i=t[e];o[0]=[i[0],i[1]],o[1]=[i[0]+(r*t[e+1][0]-r*t[e-1][0])/6,i[1]+(r*t[e+1][1]-r*t[e-1][1])/6],o[2]=[t[e+1][0]+(r*t[e][0]-r*t[e+2][0])/6,t[e+1][1]+(r*t[e][1]-r*t[e+2][1])/6],o[3]=[t[e+1][0],t[e+1][1]],s.push({op:"bcurveTo",data:[o[1][0],o[1][1],o[2][0],o[2][1],o[3][0],o[3][1]]})}if(e&&2===e.length){let t=i.maxRandomnessOffset;s.push({ops:"lineTo",data:[e[0]+this._getOffset(-t,t,i),e[1]+ +this._getOffset(-t,t,i)]})}}else 3===n?(s.push({op:"move",data:[t[1][0],t[1][1]]}),s.push({op:"bcurveTo",data:[t[1][0],t[1][1],t[2][0],t[2][1],t[2][0],t[2][1]]})):2===n&&(s=s.concat(this._doubleLine(t[0][0],t[0][1],t[1][0],t[1][1],i)));return s}_ellipse(t,e,i,n,s,o,r,a){const h=this._getOffset(-.5,.5,a)-Math.PI/2,l=[];l.push([this._getOffset(-o,o,a)+e+.9*n*Math.cos(h-t),this._getOffset(-o,o,a)+i+.9*s*Math.sin(h-t)]);for(let r=h;r<2*Math.PI+h-.01;r+=t)l.push([this._getOffset(-o,o,a)+e+n*Math.cos(r),this._getOffset(-o,o,a)+i+s*Math.sin(r)]);return l.push([this._getOffset(-o,o,a)+e+n*Math.cos(h+2*Math.PI+.5*r),this._getOffset(-o,o,a)+i+s*Math.sin(h+2*Math.PI+.5*r)]),l.push([this._getOffset(-o,o,a)+e+.98*n*Math.cos(h+r),this._getOffset(-o,o,a)+i+.98*s*Math.sin(h+r)]),l.push([this._getOffset(-o,o,a)+e+.9*n*Math.cos(h+.5*r),this._getOffset(-o,o,a)+i+.9*s*Math.sin(h+.5*r)]),this._curve(l,null,a)}_curveWithOffset(t,e,i){const n=[];n.push([t[0][0]+this._getOffset(-e,e,i),t[0][1]+this._getOffset(-e,e,i)]),n.push([t[0][0]+this._getOffset(-e,e,i),t[0][1]+this._getOffset(-e,e,i)]);for(let s=1;s<t.length;s++)n.push([t[s][0]+this._getOffset(-e,e,i),t[s][1]+this._getOffset(-e,e,i)]),s===t.length-1&&n.push([t[s][0]+this._getOffset(-e,e,i),t[s][1]+this._getOffset(-e,e,i)]);return this._curve(n,null,i)}_arc(t,e,i,n,s,o,r,a,h){const l=o+this._getOffset(-.1,.1,h),u=[];u.push([this._getOffset(-a,a,h)+e+.9*n*Math.cos(l-t),this._getOffset(-a,a,h)+i+.9*s*Math.sin(l-t)]);for(let o=l;o<=r;o+=t)u.push([this._getOffset(-a,a,h)+e+n*Math.cos(o),this._getOffset(-a,a,h)+i+s*Math.sin(o)]);return u.push([e+n*Math.cos(r),i+s*Math.sin(r)]),u.push([e+n*Math.cos(r),i+s*Math.sin(r)]),this._curve(u,null,h)}_getIntersectingLines(e,i,n){let s=[];for(var o=new t(e[0],e[1],e[2],e[3]),r=0;r<i.length;r++){let e=new t(i[r],n[r],i[(r+1)%i.length],n[(r+1)%i.length]);2==o.compare(e)&&s.push([o.xi,o.yi])}return s}}self._roughScript=self.document&&self.document.currentScript&&self.document.currentScript.src;class h{constructor(t,e){this.config=e||{},this.canvas=t,this.ctx=this.canvas.getContext("2d"),this.defaultOptions={maxRandomnessOffset:2,roughness:1,bowing:1,stroke:"#000",strokeWidth:1,curveTightness:0,curveStepCount:9,fill:null,fillStyle:"hachure",fillWeight:-1,hachureAngle:-41,hachureGap:-1},this.config.options&&(this.defaultOptions=this._options(this.config.options))}static createRenderer(){return new a}async lib(){if(!this._renderer)if(window.workly&&!this.config.noWorker){Function.prototype.toString;const t=this.config.worklyURL||"https://cdn.jsdelivr.net/gh/pshihn/workly/dist/workly.min.js",e=this.config.roughURL||self._roughScript;if(e&&t){let i=`importScripts('${t}', '${e}');\nworkly.expose(self.rough.createRenderer());`,n=URL.createObjectURL(new Blob([i]));this._renderer=workly.proxy(n)}else this._renderer=new a}else this._renderer=new a;return this._renderer}async line(t,e,i,n,s){let o=this._options(s),r=await this.lib(),a=await r.line(t,e,i,n,o);this._draw(this.ctx,a,o)}async rectangle(t,e,i,n,s){let o=this._options(s),r=await this.lib();if(o.fill){let s=this.ctx;const a=[t,t+i,t+i,t],h=[e,e,e+n,e+n];if("solid"===o.fillStyle){let t=await r.solidFillShape(a,h,o);this._fill(s,t,o)}else{let t=await r.hachureFillShape(a,h,o);this._fillSketch(s,t,o)}}let a=await r.rectangle(t,e,i,n,o);this._draw(this.ctx,a,o)}async ellipse(t,e,i,n,s){let o=this._options(s),r=await this.lib();if(o.fill)if("solid"===o.fillStyle){let s=await r.ellipse(t,e,i,n,o);this._fill(this.ctx,s,o)}else{let s=await r.hachureFillEllipse(t,e,i,n,o);this._fillSketch(this.ctx,s,o)}let a=await r.ellipse(t,e,i,n,o);this._draw(this.ctx,a,o)}async circle(t,e,i,n){return await this.ellipse(t,e,i,i,n)}async linearPath(t,e){let i=this._options(e),n=await this.lib(),s=await n.linearPath(t,!1,i);this._draw(this.ctx,s,i)}async polygon(t,e){let i=this._options(e),n=await this.lib();if(i.fill){let e=[],s=[];for(let i of t)e.push(i[0]),s.push(i[1]);if("solid"===i.fillStyle){let t=await n.solidFillShape(e,s,i);this._fill(this.ctx,t,i)}else{let t=await n.hachureFillShape(e,s,i);this._fillSketch(this.ctx,t,i)}}let s=await n.linearPath(t,!0,i);this._draw(this.ctx,s,i)}async arc(t,e,i,n,s,o,r,a){let h=this._options(a),l=await this.lib();if(r&&h.fill)if("solid"===h.fillStyle){let r=await l.arc(t,e,i,n,s,o,!0,!1,h);this._fill(this.ctx,r,h)}else{let r=await l.hachureFillArc(t,e,i,n,s,o,h);this._fillSketch(this.ctx,r,h)}let u=await l.arc(t,e,i,n,s,o,r,!0,h);this._draw(this.ctx,u,h)}async curve(t,e){let i=this._options(e),n=await this.lib(),s=await n.curve(t,i);this._draw(this.ctx,s,i)}async path(t,e){if(!t)return;let i=this._options(e),n=await this.lib();if(i.fill)if("solid"===i.fillStyle){this.ctx.save(),this.ctx.fillStyle=i.fill;let e=new Path2D(t);this.ctx.fill(e),this.ctx.restore()}else{let e=[0,0];try{const i="http://www.w3.org/2000/svg";let n=document.createElementNS(i,"svg");n.setAttribute("width","0"),n.setAttribute("height","0");let s=document.createElementNS(i,"path");s.setAttribute("d",t),n.appendChild(s),document.body.appendChild(n);let o=s.getBBox();o&&(e[0]=o.width||0,e[1]=o.height||0),document.body.removeChild(n)}catch(t){}e[0]*e[1]||(e=[this.canvas.width||100,this.canvas.height||100]),e[0]=Math.min(4*e[0],this.canvas.width),e[1]=Math.min(4*e[1],this.canvas.height);let s=[0,e[0],e[0],0],o=[0,0,e[1],e[1]],r=await n.hachureFillShape(s,o,i),a=document.createElement("canvas");a.width=e[0],a.height=e[1],this._fillSketch(a.getContext("2d"),r,i),this.ctx.save(),this.ctx.fillStyle=this.ctx.createPattern(a,"repeat");let h=new Path2D(t);this.ctx.fill(h),this.ctx.restore()}let s=await n.svgPath(t,i);this._draw(this.ctx,s,i)}_options(t){return t?Object.assign({},this.defaultOptions,t):this.defaultOptions}_draw(t,e,i){t.save(),t.strokeStyle=i.stroke,t.lineWidth=i.strokeWidth,this._drawToContext(t,e),t.restore()}_fillSketch(t,e,i){let n=i.fillWeight;n<0&&(n=i.strokeWidth/2),t.save(),t.strokeStyle=i.fill,t.lineWidth=n,this._drawToContext(t,e),t.restore()}_fill(t,e,i){t.save(),t.fillStyle=i.fill,e.type="fillPath",this._drawToContext(t,e,i),t.restore()}_drawToContext(t,e){if("path"===e.type||"fillPath"===e.type){t.beginPath();for(let i of e.ops){const e=i.data;switch(i.op){case"move":t.moveTo(e[0],e[1]);break;case"bcurveTo":t.bezierCurveTo(e[0],e[1],e[2],e[3],e[4],e[5]);break;case"qcurveTo":t.quadraticCurveTo(e[0],e[1],e[2],e[3]);break;case"lineTo":t.lineTo(e[0],e[1])}}"fillPath"===e.type?t.fill():t.stroke()}}}var l={canvas:(t,e)=>new h(t,e),createRenderer:()=>h.createRenderer()},u=L.Canvas.extend({_initContainer:function(){L.Canvas.prototype._initContainer.call(this),this._rc=l.canvas(this._container)},_updatePoly:function(t,e){if(this._drawing){var i=t._parts,n=i.length;this._ctx;if(n){this._drawnLayers[t._leaflet_id]=t;var s=L.SVG.pointsToPath(i,e);console.log(e);var o=t.options,r={};r.roughness=o.roughness||1,r.bowing=o.bowing||1,r.stroke=o.strokeColor||"#000000",r.strokeWidth=o.strokeWidth||1,e&&(r.fill=o.fillColor||o.color,r.fillStyle=o.fillStyle||"",r.fillWeight=o.fillWeight||"",r.hachureAngle=o.hachureAngle||-41,r.hachureGap=o.hachureGap||4),r.curveStepCount=o.curveStepCount||9,console.log(r),this._rc.path(s,r)}}}});L.Canvas.RoughCanvas=u,L.Canvas.roughCanvas=(()=>new u)}),function(t,e){"function"==typeof define&&define.amd?define(function(){return e(t,t.document)}):"object"==typeof exports?module.exports=t.document?e(t,t.document):function(t){return e(t,t.document)}:t.SVG=e(t,t.document)}("undefined"!=typeof window?window:this,function(t,e){function i(t,e,i,n){return i+n.replace(d.regex.dots," .")}function n(t){return t.toLowerCase().replace(/-(.)/g,function(t,e){return e.toUpperCase()})}function s(t){return t.charAt(0).toUpperCase()+t.slice(1)}function o(t){var e=t.toString(16);return 1==e.length?"0"+e:e}function r(t,e,i){if(null==e||null==i){var n=t.bbox();null==e?e=n.width/n.height*i:null==i&&(i=n.height/n.width*e)}return{width:e,height:i}}function a(t,e,i){return{x:e*t.a+i*t.c+0,y:e*t.b+i*t.d+0}}function h(t){return{a:t[0],b:t[1],c:t[2],d:t[3],e:t[4],f:t[5]}}function l(t,e){t.cx=null==t.cx?e.bbox().cx:t.cx,t.cy=null==t.cy?e.bbox().cy:t.cy}function u(e){for(var i=e.childNodes.length-1;i>=0;i--)e.childNodes[i]instanceof t.SVGElement&&u(e.childNodes[i]);return d.adopt(e).id(d.eid(e.nodeName))}function c(t){return null==t.x&&(t.x=0,t.y=0,t.width=0,t.height=0),t.w=t.width,t.h=t.height,t.x2=t.x+t.width,t.y2=t.y+t.height,t.cx=t.x+t.width/2,t.cy=t.y+t.height/2,t}function f(t){return Math.abs(t)>1e-37?t:0}var d=this.SVG=function(t){if(d.supported)return t=new d.Doc(t),d.parser.draw||d.prepare(),t};if(d.ns="http://www.w3.org/2000/svg",d.xmlns="http://www.w3.org/2000/xmlns/",d.xlink="http://www.w3.org/1999/xlink",d.svgjs="http://svgjs.com/svgjs",d.supported=!!e.createElementNS&&!!e.createElementNS(d.ns,"svg").createSVGRect,!d.supported)return!1;d.did=1e3,d.eid=function(t){return"Svgjs"+s(t)+d.did++},d.create=function(t){var i=e.createElementNS(this.ns,t);return i.setAttribute("id",this.eid(t)),i},d.extend=function(){var t,e,i,n;for(e=(t=[].slice.call(arguments)).pop(),n=t.length-1;n>=0;n--)if(t[n])for(i in e)t[n].prototype[i]=e[i];d.Set&&d.Set.inherit&&d.Set.inherit()},d.invent=function(t){var e="function"==typeof t.create?t.create:function(){this.constructor.call(this,d.create(t.create))};return t.inherit&&(e.prototype=new t.inherit),t.extend&&d.extend(e,t.extend),t.construct&&d.extend(t.parent||d.Container,t.construct),e},d.adopt=function(e){return e?e.instance?e.instance:((i="svg"==e.nodeName?e.parentNode instanceof t.SVGElement?new d.Nested:new d.Doc:"linearGradient"==e.nodeName?new d.Gradient("linear"):"radialGradient"==e.nodeName?new d.Gradient("radial"):d[s(e.nodeName)]?new(d[s(e.nodeName)]):new d.Element(e)).type=e.nodeName,i.node=e,e.instance=i,i instanceof d.Doc&&i.namespace().defs(),i.setData(JSON.parse(e.getAttribute("svgjs:data"))||{}),i):null;var i},d.prepare=function(){var t=e.getElementsByTagName("body")[0],i=(t?new d.Doc(t):d.adopt(e.documentElement).nested()).size(2,0);d.parser={body:t||e.documentElement,draw:i.style("opacity:0;position:absolute;left:-100%;top:-100%;overflow:hidden").node,poly:i.polyline().node,path:i.path().node,native:d.create("svg")}},d.parser={native:d.create("svg")},e.addEventListener("DOMContentLoaded",function(){d.parser.draw||d.prepare()},!1),d.regex={numberAndUnit:/^([+-]?(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?)([a-z%]*)$/i,hex:/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i,rgb:/rgb\((\d+),(\d+),(\d+)\)/,reference:/#([a-z0-9\-_]+)/i,transforms:/\)\s*,?\s*/,whitespace:/\s/g,isHex:/^#[a-f0-9]{3,6}$/i,isRgb:/^rgb\(/,isCss:/[^:]+:[^;]+;?/,isBlank:/^(\s+)?$/,isNumber:/^[+-]?(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,isPercent:/^-?[\d\.]+%$/,isImage:/\.(jpg|jpeg|png|gif|svg)(\?[^=]+.*)?/i,delimiter:/[\s,]+/,hyphen:/([^e])\-/gi,pathLetters:/[MLHVCSQTAZ]/gi,isPathLetter:/[MLHVCSQTAZ]/i,numbersWithDots:/((\d?\.\d+(?:e[+-]?\d+)?)((?:\.\d+(?:e[+-]?\d+)?)+))+/gi,dots:/\./g},d.utils={map:function(t,e){var i,n=t.length,s=[];for(i=0;i<n;i++)s.push(e(t[i]));return s},filter:function(t,e){var i,n=t.length,s=[];for(i=0;i<n;i++)e(t[i])&&s.push(t[i]);return s},radians:function(t){return t%360*Math.PI/180},degrees:function(t){return 180*t/Math.PI%360},filterSVGElements:function(e){return this.filter(e,function(e){return e instanceof t.SVGElement})}},d.defaults={attrs:{"fill-opacity":1,"stroke-opacity":1,"stroke-width":0,"stroke-linejoin":"miter","stroke-linecap":"butt",fill:"#000000",stroke:"#000000",opacity:1,x:0,y:0,cx:0,cy:0,width:0,height:0,r:0,rx:0,ry:0,offset:0,"stop-opacity":1,"stop-color":"#000000","font-size":16,"font-family":"Helvetica, Arial, sans-serif","text-anchor":"start"}},d.Color=function(t){var e;this.r=0,this.g=0,this.b=0,t&&("string"==typeof t?d.regex.isRgb.test(t)?(e=d.regex.rgb.exec(t.replace(d.regex.whitespace,"")),this.r=parseInt(e[1]),this.g=parseInt(e[2]),this.b=parseInt(e[3])):d.regex.isHex.test(t)&&(e=d.regex.hex.exec(function(t){return 4==t.length?["#",t.substring(1,2),t.substring(1,2),t.substring(2,3),t.substring(2,3),t.substring(3,4),t.substring(3,4)].join(""):t}(t)),this.r=parseInt(e[1],16),this.g=parseInt(e[2],16),this.b=parseInt(e[3],16)):"object"==typeof t&&(this.r=t.r,this.g=t.g,this.b=t.b))},d.extend(d.Color,{toString:function(){return this.toHex()},toHex:function(){return"#"+o(this.r)+o(this.g)+o(this.b)},toRgb:function(){return"rgb("+[this.r,this.g,this.b].join()+")"},brightness:function(){return this.r/255*.3+this.g/255*.59+this.b/255*.11},morph:function(t){return this.destination=new d.Color(t),this},at:function(t){return this.destination?(t=t<0?0:t>1?1:t,new d.Color({r:~~(this.r+(this.destination.r-this.r)*t),g:~~(this.g+(this.destination.g-this.g)*t),b:~~(this.b+(this.destination.b-this.b)*t)})):this}}),d.Color.test=function(t){return t+="",d.regex.isHex.test(t)||d.regex.isRgb.test(t)},d.Color.isRgb=function(t){return t&&"number"==typeof t.r&&"number"==typeof t.g&&"number"==typeof t.b},d.Color.isColor=function(t){return d.Color.isRgb(t)||d.Color.test(t)},d.Array=function(t,e){0==(t=(t||[]).valueOf()).length&&e&&(t=e.valueOf()),this.value=this.parse(t)},d.extend(d.Array,{morph:function(t){if(this.destination=this.parse(t),this.value.length!=this.destination.length){for(var e=this.value[this.value.length-1],i=this.destination[this.destination.length-1];this.value.length>this.destination.length;)this.destination.push(i);for(;this.value.length<this.destination.length;)this.value.push(e)}return this},settle:function(){for(var t=0,e=this.value.length,i=[];t<e;t++)-1==i.indexOf(this.value[t])&&i.push(this.value[t]);return this.value=i},at:function(t){if(!this.destination)return this;for(var e=0,i=this.value.length,n=[];e<i;e++)n.push(this.value[e]+(this.destination[e]-this.value[e])*t);return new d.Array(n)},toString:function(){return this.value.join(" ")},valueOf:function(){return this.value},parse:function(t){return t=t.valueOf(),Array.isArray(t)?t:this.split(t)},split:function(t){return t.trim().split(d.regex.delimiter).map(parseFloat)},reverse:function(){return this.value.reverse(),this},clone:function(){var t=new this.constructor;return t.value=function t(e){for(var i=e.slice(0),n=i.length;n--;)Array.isArray(i[n])&&(i[n]=t(i[n]));return i}(this.value),t}}),d.PointArray=function(t,e){d.Array.call(this,t,e||[[0,0]])},d.PointArray.prototype=new d.Array,d.PointArray.prototype.constructor=d.PointArray,d.extend(d.PointArray,{toString:function(){for(var t=0,e=this.value.length,i=[];t<e;t++)i.push(this.value[t].join(","));return i.join(" ")},toLine:function(){return{x1:this.value[0][0],y1:this.value[0][1],x2:this.value[1][0],y2:this.value[1][1]}},at:function(t){if(!this.destination)return this;for(var e=0,i=this.value.length,n=[];e<i;e++)n.push([this.value[e][0]+(this.destination[e][0]-this.value[e][0])*t,this.value[e][1]+(this.destination[e][1]-this.value[e][1])*t]);return new d.PointArray(n)},parse:function(t){var e=[];if(t=t.valueOf(),Array.isArray(t)){if(Array.isArray(t[0]))return t}else t=t.trim().split(d.regex.delimiter).map(parseFloat);t.length%2!=0&&t.pop();for(var i=0,n=t.length;i<n;i+=2)e.push([t[i],t[i+1]]);return e},move:function(t,e){var i=this.bbox();if(t-=i.x,e-=i.y,!isNaN(t)&&!isNaN(e))for(var n=this.value.length-1;n>=0;n--)this.value[n]=[this.value[n][0]+t,this.value[n][1]+e];return this},size:function(t,e){var i,n=this.bbox();for(i=this.value.length-1;i>=0;i--)n.width&&(this.value[i][0]=(this.value[i][0]-n.x)*t/n.width+n.x),n.height&&(this.value[i][1]=(this.value[i][1]-n.y)*e/n.height+n.y);return this},bbox:function(){return d.parser.poly.setAttribute("points",this.toString()),d.parser.poly.getBBox()}});for(var p={M:function(t,e,i){return e.x=i.x=t[0],e.y=i.y=t[1],["M",e.x,e.y]},L:function(t,e){return e.x=t[0],e.y=t[1],["L",t[0],t[1]]},H:function(t,e){return e.x=t[0],["H",t[0]]},V:function(t,e){return e.y=t[0],["V",t[0]]},C:function(t,e){return e.x=t[4],e.y=t[5],["C",t[0],t[1],t[2],t[3],t[4],t[5]]},S:function(t,e){return e.x=t[2],e.y=t[3],["S",t[0],t[1],t[2],t[3]]},Q:function(t,e){return e.x=t[2],e.y=t[3],["Q",t[0],t[1],t[2],t[3]]},T:function(t,e){return e.x=t[0],e.y=t[1],["T",t[0],t[1]]},Z:function(t,e,i){return e.x=i.x,e.y=i.y,["Z"]},A:function(t,e){return e.x=t[5],e.y=t[6],["A",t[0],t[1],t[2],t[3],t[4],t[5],t[6]]}},m="mlhvqtcsaz".split(""),_=0,g=m.length;_<g;++_)p[m[_]]=function(t){return function(e,i,n){if("H"==t)e[0]=e[0]+i.x;else if("V"==t)e[0]=e[0]+i.y;else if("A"==t)e[5]=e[5]+i.x,e[6]=e[6]+i.y;else for(var s=0,o=e.length;s<o;++s)e[s]=e[s]+(s%2?i.y:i.x);return p[t](e,i,n)}}(m[_].toUpperCase());d.PathArray=function(t,e){d.Array.call(this,t,e||[["M",0,0]])},d.PathArray.prototype=new d.Array,d.PathArray.prototype.constructor=d.PathArray,d.extend(d.PathArray,{toString:function(){return function(t){for(var e=0,i=t.length,n="";e<i;e++)n+=t[e][0],null!=t[e][1]&&(n+=t[e][1],null!=t[e][2]&&(n+=" ",n+=t[e][2],null!=t[e][3]&&(n+=" ",n+=t[e][3],n+=" ",n+=t[e][4],null!=t[e][5]&&(n+=" ",n+=t[e][5],n+=" ",n+=t[e][6],null!=t[e][7]&&(n+=" ",n+=t[e][7])))));return n+" "}(this.value)},move:function(t,e){var i=this.bbox();if(t-=i.x,e-=i.y,!isNaN(t)&&!isNaN(e))for(var n,s=this.value.length-1;s>=0;s--)"M"==(n=this.value[s][0])||"L"==n||"T"==n?(this.value[s][1]+=t,this.value[s][2]+=e):"H"==n?this.value[s][1]+=t:"V"==n?this.value[s][1]+=e:"C"==n||"S"==n||"Q"==n?(this.value[s][1]+=t,this.value[s][2]+=e,this.value[s][3]+=t,this.value[s][4]+=e,"C"==n&&(this.value[s][5]+=t,this.value[s][6]+=e)):"A"==n&&(this.value[s][6]+=t,this.value[s][7]+=e);return this},size:function(t,e){var i,n,s=this.bbox();for(i=this.value.length-1;i>=0;i--)"M"==(n=this.value[i][0])||"L"==n||"T"==n?(this.value[i][1]=(this.value[i][1]-s.x)*t/s.width+s.x,this.value[i][2]=(this.value[i][2]-s.y)*e/s.height+s.y):"H"==n?this.value[i][1]=(this.value[i][1]-s.x)*t/s.width+s.x:"V"==n?this.value[i][1]=(this.value[i][1]-s.y)*e/s.height+s.y:"C"==n||"S"==n||"Q"==n?(this.value[i][1]=(this.value[i][1]-s.x)*t/s.width+s.x,this.value[i][2]=(this.value[i][2]-s.y)*e/s.height+s.y,this.value[i][3]=(this.value[i][3]-s.x)*t/s.width+s.x,this.value[i][4]=(this.value[i][4]-s.y)*e/s.height+s.y,"C"==n&&(this.value[i][5]=(this.value[i][5]-s.x)*t/s.width+s.x,this.value[i][6]=(this.value[i][6]-s.y)*e/s.height+s.y)):"A"==n&&(this.value[i][1]=this.value[i][1]*t/s.width,this.value[i][2]=this.value[i][2]*e/s.height,this.value[i][6]=(this.value[i][6]-s.x)*t/s.width+s.x,this.value[i][7]=(this.value[i][7]-s.y)*e/s.height+s.y);return this},equalCommands:function(t){var e,i,n;for(t=new d.PathArray(t),n=this.value.length===t.value.length,e=0,i=this.value.length;n&&e<i;e++)n=this.value[e][0]===t.value[e][0];return n},morph:function(t){return t=new d.PathArray(t),this.equalCommands(t)?this.destination=t:this.destination=null,this},at:function(t){if(!this.destination)return this;var e,i,n,s,o=this.value,r=this.destination.value,a=[],h=new d.PathArray;for(e=0,i=o.length;e<i;e++){for(a[e]=[o[e][0]],n=1,s=o[e].length;n<s;n++)a[e][n]=o[e][n]+(r[e][n]-o[e][n])*t;"A"===a[e][0]&&(a[e][4]=+(0!=a[e][4]),a[e][5]=+(0!=a[e][5]))}return h.value=a,h},parse:function(t){if(t instanceof d.PathArray)return t.valueOf();var e,n={M:2,L:2,H:1,V:1,C:6,S:4,Q:4,T:2,A:7,Z:0};t="string"==typeof t?t.replace(d.regex.numbersWithDots,i).replace(d.regex.pathLetters," $& ").replace(d.regex.hyphen,"$1 -").trim().split(d.regex.delimiter):t.reduce(function(t,e){return[].concat.call(t,e)},[]);var s=[],o=new d.Point,r=new d.Point,a=0,h=t.length;do{d.regex.isPathLetter.test(t[a])?(e=t[a],++a):"M"==e?e="L":"m"==e&&(e="l"),s.push(p[e].call(null,t.slice(a,a+=n[e.toUpperCase()]).map(parseFloat),o,r))}while(h>a);return s},bbox:function(){return d.parser.path.setAttribute("d",this.toString()),d.parser.path.getBBox()}}),d.Number=d.invent({create:function(t,e){this.value=0,this.unit=e||"","number"==typeof t?this.value=isNaN(t)?0:isFinite(t)?t:t<0?-3.4e38:3.4e38:"string"==typeof t?(e=t.match(d.regex.numberAndUnit))&&(this.value=parseFloat(e[1]),"%"==e[5]?this.value/=100:"s"==e[5]&&(this.value*=1e3),this.unit=e[5]):t instanceof d.Number&&(this.value=t.valueOf(),this.unit=t.unit)},extend:{toString:function(){return("%"==this.unit?~~(1e8*this.value)/1e6:"s"==this.unit?this.value/1e3:this.value)+this.unit},toJSON:function(){return this.toString()},valueOf:function(){return this.value},plus:function(t){return t=new d.Number(t),new d.Number(this+t,this.unit||t.unit)},minus:function(t){return t=new d.Number(t),new d.Number(this-t,this.unit||t.unit)},times:function(t){return t=new d.Number(t),new d.Number(this*t,this.unit||t.unit)},divide:function(t){return t=new d.Number(t),new d.Number(this/t,this.unit||t.unit)},to:function(t){var e=new d.Number(this);return"string"==typeof t&&(e.unit=t),e},morph:function(t){return this.destination=new d.Number(t),t.relative&&(this.destination.value+=this.value),this},at:function(t){return this.destination?new d.Number(this.destination).minus(this).times(t).plus(this):this}}}),d.Element=d.invent({create:function(t){this._stroke=d.defaults.attrs.stroke,this._event=null,this.dom={},(this.node=t)&&(this.type=t.nodeName,this.node.instance=this,this._stroke=t.getAttribute("stroke")||this._stroke)},extend:{x:function(t){return this.attr("x",t)},y:function(t){return this.attr("y",t)},cx:function(t){return null==t?this.x()+this.width()/2:this.x(t-this.width()/2)},cy:function(t){return null==t?this.y()+this.height()/2:this.y(t-this.height()/2)},move:function(t,e){return this.x(t).y(e)},center:function(t,e){return this.cx(t).cy(e)},width:function(t){return this.attr("width",t)},height:function(t){return this.attr("height",t)},size:function(t,e){var i=r(this,t,e);return this.width(new d.Number(i.width)).height(new d.Number(i.height))},clone:function(t,e){this.writeDataToDom();var i=u(this.node.cloneNode(!0));return t?t.add(i):this.after(i),i},remove:function(){return this.parent()&&this.parent().removeElement(this),this},replace:function(t){return this.after(t).remove(),t},addTo:function(t){return t.put(this)},putIn:function(t){return t.add(this)},id:function(t){return this.attr("id",t)},inside:function(t,e){var i=this.bbox();return t>i.x&&e>i.y&&t<i.x+i.width&&e<i.y+i.height},show:function(){return this.style("display","")},hide:function(){return this.style("display","none")},visible:function(){return"none"!=this.style("display")},toString:function(){return this.attr("id")},classes:function(){var t=this.attr("class");return null==t?[]:t.trim().split(d.regex.delimiter)},hasClass:function(t){return-1!=this.classes().indexOf(t)},addClass:function(t){if(!this.hasClass(t)){var e=this.classes();e.push(t),this.attr("class",e.join(" "))}return this},removeClass:function(t){return this.hasClass(t)&&this.attr("class",this.classes().filter(function(e){return e!=t}).join(" ")),this},toggleClass:function(t){return this.hasClass(t)?this.removeClass(t):this.addClass(t)},reference:function(t){return d.get(this.attr(t))},parent:function(e){var i=this;if(!i.node.parentNode)return null;if(i=d.adopt(i.node.parentNode),!e)return i;for(;i&&i.node instanceof t.SVGElement;){if("string"==typeof e?i.matches(e):i instanceof e)return i;if("#document"==i.node.parentNode.nodeName)return null;i=d.adopt(i.node.parentNode)}},doc:function(){return this instanceof d.Doc?this:this.parent(d.Doc)},parents:function(t){var e=[],i=this;do{if(!(i=i.parent(t))||!i.node)break;e.push(i)}while(i.parent);return e},matches:function(t){return function(t,e){return(t.matches||t.matchesSelector||t.msMatchesSelector||t.mozMatchesSelector||t.webkitMatchesSelector||t.oMatchesSelector).call(t,e)}(this.node,t)},native:function(){return this.node},svg:function(t){var i=e.createElement("svg");if(!(t&&this instanceof d.Parent))return i.appendChild(t=e.createElement("svg")),this.writeDataToDom(),t.appendChild(this.node.cloneNode(!0)),i.innerHTML.replace(/^<svg>/,"").replace(/<\/svg>$/,"");i.innerHTML="<svg>"+t.replace(/\n/,"").replace(/<([\w:-]+)([^<]+?)\/>/g,"<$1$2></$1>")+"</svg>";for(var n=0,s=i.firstChild.childNodes.length;n<s;n++)this.node.appendChild(i.firstChild.firstChild);return this},writeDataToDom:function(){(this.each||this.lines)&&(this.each?this:this.lines()).each(function(){this.writeDataToDom()});return this.node.removeAttribute("svgjs:data"),Object.keys(this.dom).length&&this.node.setAttribute("svgjs:data",JSON.stringify(this.dom)),this},setData:function(t){return this.dom=t,this},is:function(t){return function(t,e){return t instanceof e}(this,t)}}}),d.easing={"-":function(t){return t},"<>":function(t){return-Math.cos(t*Math.PI)/2+.5},">":function(t){return Math.sin(t*Math.PI/2)},"<":function(t){return 1-Math.cos(t*Math.PI/2)}},d.morph=function(t){return function(e,i){return new d.MorphObj(e,i).at(t)}},d.Situation=d.invent({create:function(t){this.init=!1,this.reversed=!1,this.reversing=!1,this.duration=new d.Number(t.duration).valueOf(),this.delay=new d.Number(t.delay).valueOf(),this.start=+new Date+this.delay,this.finish=this.start+this.duration,this.ease=t.ease,this.loop=0,this.loops=!1,this.animations={},this.attrs={},this.styles={},this.transforms=[],this.once={}}}),d.FX=d.invent({create:function(t){this._target=t,this.situations=[],this.active=!1,this.situation=null,this.paused=!1,this.lastPos=0,this.pos=0,this.absPos=0,this._speed=1},extend:{animate:function(t,e,i){"object"==typeof t&&(e=t.ease,i=t.delay,t=t.duration);var n=new d.Situation({duration:t||1e3,delay:i||0,ease:d.easing[e||"-"]||e});return this.queue(n),this},delay:function(t){var e=new d.Situation({duration:t,delay:0,ease:d.easing["-"]});return this.queue(e)},target:function(t){return t&&t instanceof d.Element?(this._target=t,this):this._target},timeToAbsPos:function(t){return(t-this.situation.start)/(this.situation.duration/this._speed)},absPosToTime:function(t){return this.situation.duration/this._speed*t+this.situation.start},startAnimFrame:function(){this.stopAnimFrame(),this.animationFrame=t.requestAnimationFrame(function(){this.step()}.bind(this))},stopAnimFrame:function(){t.cancelAnimationFrame(this.animationFrame)},start:function(){return!this.active&&this.situation&&(this.active=!0,this.startCurrent()),this},startCurrent:function(){return this.situation.start=+new Date+this.situation.delay/this._speed,this.situation.finish=this.situation.start+this.situation.duration/this._speed,this.initAnimations().step()},queue:function(t){return("function"==typeof t||t instanceof d.Situation)&&this.situations.push(t),this.situation||(this.situation=this.situations.shift()),this},dequeue:function(){return this.stop(),this.situation=this.situations.shift(),this.situation&&(this.situation instanceof d.Situation?this.start():this.situation.call(this)),this},initAnimations:function(){var t,e,i,n=this.situation;if(n.init)return this;for(t in n.animations)for(i=this.target()[t](),Array.isArray(i)||(i=[i]),Array.isArray(n.animations[t])||(n.animations[t]=[n.animations[t]]),e=i.length;e--;)n.animations[t][e]instanceof d.Number&&(i[e]=new d.Number(i[e])),n.animations[t][e]=i[e].morph(n.animations[t][e]);for(t in n.attrs)n.attrs[t]=new d.MorphObj(this.target().attr(t),n.attrs[t]);for(t in n.styles)n.styles[t]=new d.MorphObj(this.target().style(t),n.styles[t]);return n.initialTransformation=this.target().matrixify(),n.init=!0,this},clearQueue:function(){return this.situations=[],this},clearCurrent:function(){return this.situation=null,this},stop:function(t,e){var i=this.active;return this.active=!1,e&&this.clearQueue(),t&&this.situation&&(!i&&this.startCurrent(),this.atEnd()),this.stopAnimFrame(),this.clearCurrent()},reset:function(){if(this.situation){var t=this.situation;this.stop(),this.situation=t,this.atStart()}return this},finish:function(){for(this.stop(!0,!1);this.dequeue().situation&&this.stop(!0,!1););return this.clearQueue().clearCurrent(),this},atStart:function(){return this.at(0,!0)},atEnd:function(){return!0===this.situation.loops&&(this.situation.loops=this.situation.loop+1),"number"==typeof this.situation.loops?this.at(this.situation.loops,!0):this.at(1,!0)},at:function(t,e){var i=this.situation.duration/this._speed;return this.absPos=t,e||(this.situation.reversed&&(this.absPos=1-this.absPos),this.absPos+=this.situation.loop),this.situation.start=+new Date-this.absPos*i,this.situation.finish=this.situation.start+i,this.step(!0)},speed:function(t){return 0===t?this.pause():t?(this._speed=t,this.at(this.absPos,!0)):this._speed},loop:function(t,e){var i=this.last();return i.loops=null==t||t,i.loop=0,e&&(i.reversing=!0),this},pause:function(){return this.paused=!0,this.stopAnimFrame(),this},play:function(){return this.paused?(this.paused=!1,this.at(this.absPos,!0)):this},reverse:function(t){var e=this.last();return e.reversed=void 0===t?!e.reversed:t,this},progress:function(t){return t?this.situation.ease(this.pos):this.pos},after:function(t){var e=this.last();return this.target().on("finished.fx",function i(n){n.detail.situation==e&&(t.call(this,e),this.off("finished.fx",i))}),this._callStart()},during:function(t){var e=this.last(),i=function(i){i.detail.situation==e&&t.call(this,i.detail.pos,d.morph(i.detail.pos),i.detail.eased,e)};return this.target().off("during.fx",i).on("during.fx",i),this.after(function(){this.off("during.fx",i)}),this._callStart()},afterAll:function(t){var e=function e(i){t.call(this),this.off("allfinished.fx",e)};return this.target().off("allfinished.fx",e).on("allfinished.fx",e),this._callStart()},duringAll:function(t){var e=function(e){t.call(this,e.detail.pos,d.morph(e.detail.pos),e.detail.eased,e.detail.situation)};return this.target().off("during.fx",e).on("during.fx",e),this.afterAll(function(){this.off("during.fx",e)}),this._callStart()},last:function(){return this.situations.length?this.situations[this.situations.length-1]:this.situation},add:function(t,e,i){return this.last()[i||"animations"][t]=e,this._callStart()},step:function(t){var e,i,n;(t||(this.absPos=this.timeToAbsPos(+new Date)),!1!==this.situation.loops)?(e=Math.max(this.absPos,0),i=Math.floor(e),!0===this.situation.loops||i<this.situation.loops?(this.pos=e-i,n=this.situation.loop,this.situation.loop=i):(this.absPos=this.situation.loops,this.pos=1,n=this.situation.loop-1,this.situation.loop=this.situation.loops),this.situation.reversing&&(this.situation.reversed=this.situation.reversed!=Boolean((this.situation.loop-n)%2))):(this.absPos=Math.min(this.absPos,1),this.pos=this.absPos);this.pos<0&&(this.pos=0),this.situation.reversed&&(this.pos=1-this.pos);var s=this.situation.ease(this.pos);for(var o in this.situation.once)o>this.lastPos&&o<=s&&(this.situation.once[o].call(this.target(),this.pos,s),delete this.situation.once[o]);return this.active&&this.target().fire("during",{pos:this.pos,eased:s,fx:this,situation:this.situation}),this.situation?(this.eachAt(),1==this.pos&&!this.situation.reversed||this.situation.reversed&&0==this.pos?(this.stopAnimFrame(),this.target().fire("finished",{fx:this,situation:this.situation}),this.situations.length||(this.target().fire("allfinished"),this.situations.length||(this.target().off(".fx"),this.active=!1)),this.active?this.dequeue():this.clearCurrent()):!this.paused&&this.active&&this.startAnimFrame(),this.lastPos=s,this):this},eachAt:function(){var t,e,i,n=this,s=this.target(),o=this.situation;for(t in o.animations)i=[].concat(o.animations[t]).map(function(t){return"string"!=typeof t&&t.at?t.at(o.ease(n.pos),n.pos):t}),s[t].apply(s,i);for(t in o.attrs)i=[t].concat(o.attrs[t]).map(function(t){return"string"!=typeof t&&t.at?t.at(o.ease(n.pos),n.pos):t}),s.attr.apply(s,i);for(t in o.styles)i=[t].concat(o.styles[t]).map(function(t){return"string"!=typeof t&&t.at?t.at(o.ease(n.pos),n.pos):t}),s.style.apply(s,i);if(o.transforms.length){for(i=o.initialTransformation,t=0,e=o.transforms.length;t<e;t++){var r=o.transforms[t];r instanceof d.Matrix?i=r.relative?i.multiply((new d.Matrix).morph(r).at(o.ease(this.pos))):i.morph(r).at(o.ease(this.pos)):(r.relative||r.undo(i.extract()),i=i.multiply(r.at(o.ease(this.pos))))}s.matrix(i)}return this},once:function(t,e,i){var n=this.last();return i||(t=n.ease(t)),n.once[t]=e,this},_callStart:function(){return setTimeout(function(){this.start()}.bind(this),0),this}},parent:d.Element,construct:{animate:function(t,e,i){return(this.fx||(this.fx=new d.FX(this))).animate(t,e,i)},delay:function(t){return(this.fx||(this.fx=new d.FX(this))).delay(t)},stop:function(t,e){return this.fx&&this.fx.stop(t,e),this},finish:function(){return this.fx&&this.fx.finish(),this},pause:function(){return this.fx&&this.fx.pause(),this},play:function(){return this.fx&&this.fx.play(),this},speed:function(t){if(this.fx){if(null==t)return this.fx.speed();this.fx.speed(t)}return this}}}),d.MorphObj=d.invent({create:function(t,e){return d.Color.isColor(e)?new d.Color(t).morph(e):d.regex.delimiter.test(t)?d.regex.pathLetters.test(t)?new d.PathArray(t).morph(e):new d.Array(t).morph(e):d.regex.numberAndUnit.test(e)?new d.Number(t).morph(e):(this.value=t,void(this.destination=e))},extend:{at:function(t,e){return e<1?this.value:this.destination},valueOf:function(){return this.value}}}),d.extend(d.FX,{attr:function(t,e,i){if("object"==typeof t)for(var n in t)this.attr(n,t[n]);else this.add(t,e,"attrs");return this},style:function(t,e){if("object"==typeof t)for(var i in t)this.style(i,t[i]);else this.add(t,e,"styles");return this},x:function(t,e){if(this.target()instanceof d.G)return this.transform({x:t},e),this;var i=new d.Number(t);return i.relative=e,this.add("x",i)},y:function(t,e){if(this.target()instanceof d.G)return this.transform({y:t},e),this;var i=new d.Number(t);return i.relative=e,this.add("y",i)},cx:function(t){return this.add("cx",new d.Number(t))},cy:function(t){return this.add("cy",new d.Number(t))},move:function(t,e){return this.x(t).y(e)},center:function(t,e){return this.cx(t).cy(e)},size:function(t,e){var i;this.target()instanceof d.Text?this.attr("font-size",t):(t&&e||(i=this.target().bbox()),t||(t=i.width/i.height*e),e||(e=i.height/i.width*t),this.add("width",new d.Number(t)).add("height",new d.Number(e)));return this},width:function(t){return this.add("width",new d.Number(t))},height:function(t){return this.add("height",new d.Number(t))},plot:function(t,e,i,n){return 4==arguments.length?this.plot([t,e,i,n]):this.add("plot",new(this.target().morphArray)(t))},leading:function(t){return this.target().leading?this.add("leading",new d.Number(t)):this},viewbox:function(t,e,i,n){return this.target()instanceof d.Container&&this.add("viewbox",new d.ViewBox(t,e,i,n)),this},update:function(t){if(this.target()instanceof d.Stop){if("number"==typeof t||t instanceof d.Number)return this.update({offset:arguments[0],color:arguments[1],opacity:arguments[2]});null!=t.opacity&&this.attr("stop-opacity",t.opacity),null!=t.color&&this.attr("stop-color",t.color),null!=t.offset&&this.attr("offset",t.offset)}return this}}),d.Box=d.invent({create:function(t,e,i,n){return"object"!=typeof t||t instanceof d.Element?(4==arguments.length&&(this.x=t,this.y=e,this.width=i,this.height=n),void c(this)):d.Box.call(this,null!=t.left?t.left:t.x,null!=t.top?t.top:t.y,t.width,t.height)},extend:{merge:function(t){var e=new this.constructor;return e.x=Math.min(this.x,t.x),e.y=Math.min(this.y,t.y),e.width=Math.max(this.x+this.width,t.x+t.width)-e.x,e.height=Math.max(this.y+this.height,t.y+t.height)-e.y,c(e)},transform:function(t){var e,i=1/0,n=-1/0,s=1/0,o=-1/0;return[new d.Point(this.x,this.y),new d.Point(this.x2,this.y),new d.Point(this.x,this.y2),new d.Point(this.x2,this.y2)].forEach(function(e){e=e.transform(t),i=Math.min(i,e.x),n=Math.max(n,e.x),s=Math.min(s,e.y),o=Math.max(o,e.y)}),(e=new this.constructor).x=i,e.width=n-i,e.y=s,e.height=o-s,c(e),e}}}),d.BBox=d.invent({create:function(t){if(d.Box.apply(this,[].slice.call(arguments)),t instanceof d.Element){var i;try{if(e.documentElement.contains){if(!e.documentElement.contains(t.node))throw new Exception("Element not in the dom")}else{for(var n=t.node;n.parentNode;)n=n.parentNode;if(n!=e)throw new Exception("Element not in the dom")}i=t.node.getBBox()}catch(e){if(t instanceof d.Shape){var s=t.clone(d.parser.draw.instance).show();i=s.node.getBBox(),s.remove()}else i={x:t.node.clientLeft,y:t.node.clientTop,width:t.node.clientWidth,height:t.node.clientHeight}}d.Box.call(this,i)}},inherit:d.Box,parent:d.Element,construct:{bbox:function(){return new d.BBox(this)}}}),d.BBox.prototype.constructor=d.BBox,d.extend(d.Element,{tbox:function(){return console.warn("Use of TBox is deprecated and mapped to RBox. Use .rbox() instead."),this.rbox(this.doc())}}),d.RBox=d.invent({create:function(t){d.Box.apply(this,[].slice.call(arguments)),t instanceof d.Element&&d.Box.call(this,t.node.getBoundingClientRect())},inherit:d.Box,parent:d.Element,extend:{addOffset:function(){return this.x+=t.pageXOffset,this.y+=t.pageYOffset,this}},construct:{rbox:function(t){return t?new d.RBox(this).transform(t.screenCTM().inverse()):new d.RBox(this).addOffset()}}}),d.RBox.prototype.constructor=d.RBox,d.Matrix=d.invent({create:function(t){var e,i=h([1,0,0,1,0,0]);for(t=t instanceof d.Element?t.matrixify():"string"==typeof t?h(t.split(d.regex.delimiter).map(parseFloat)):6==arguments.length?h([].slice.call(arguments)):Array.isArray(t)?h(t):"object"==typeof t?t:i,e=v.length-1;e>=0;--e)this[v[e]]=null!=t[v[e]]?t[v[e]]:i[v[e]]},extend:{extract:function(){var t=a(this,0,1),e=a(this,1,0),i=180/Math.PI*Math.atan2(t.y,t.x)-90;return{x:this.e,y:this.f,transformedX:(this.e*Math.cos(i*Math.PI/180)+this.f*Math.sin(i*Math.PI/180))/Math.sqrt(this.a*this.a+this.b*this.b),transformedY:(this.f*Math.cos(i*Math.PI/180)+this.e*Math.sin(-i*Math.PI/180))/Math.sqrt(this.c*this.c+this.d*this.d),skewX:-i,skewY:180/Math.PI*Math.atan2(e.y,e.x),scaleX:Math.sqrt(this.a*this.a+this.b*this.b),scaleY:Math.sqrt(this.c*this.c+this.d*this.d),rotation:i,a:this.a,b:this.b,c:this.c,d:this.d,e:this.e,f:this.f,matrix:new d.Matrix(this)}},clone:function(){return new d.Matrix(this)},morph:function(t){return this.destination=new d.Matrix(t),this},at:function(t){return this.destination?new d.Matrix({a:this.a+(this.destination.a-this.a)*t,b:this.b+(this.destination.b-this.b)*t,c:this.c+(this.destination.c-this.c)*t,d:this.d+(this.destination.d-this.d)*t,e:this.e+(this.destination.e-this.e)*t,f:this.f+(this.destination.f-this.f)*t}):this},multiply:function(t){return new d.Matrix(this.native().multiply(function(t){return t instanceof d.Matrix||(t=new d.Matrix(t)),t}(t).native()))},inverse:function(){return new d.Matrix(this.native().inverse())},translate:function(t,e){return new d.Matrix(this.native().translate(t||0,e||0))},scale:function(t,e,i,n){return 1==arguments.length?e=t:3==arguments.length&&(n=i,i=e,e=t),this.around(i,n,new d.Matrix(t,0,0,e,0,0))},rotate:function(t,e,i){return t=d.utils.radians(t),this.around(e,i,new d.Matrix(Math.cos(t),Math.sin(t),-Math.sin(t),Math.cos(t),0,0))},flip:function(t,e){return"x"==t?this.scale(-1,1,e,0):"y"==t?this.scale(1,-1,0,e):this.scale(-1,-1,t,null!=e?e:t)},skew:function(t,e,i,n){return 1==arguments.length?e=t:3==arguments.length&&(n=i,i=e,e=t),t=d.utils.radians(t),e=d.utils.radians(e),this.around(i,n,new d.Matrix(1,Math.tan(e),Math.tan(t),1,0,0))},skewX:function(t,e,i){return this.skew(t,0,e,i)},skewY:function(t,e,i){return this.skew(0,t,e,i)},around:function(t,e,i){return this.multiply(new d.Matrix(1,0,0,1,t||0,e||0)).multiply(i).multiply(new d.Matrix(1,0,0,1,-t||0,-e||0))},native:function(){for(var t=d.parser.native.createSVGMatrix(),e=v.length-1;e>=0;e--)t[v[e]]=this[v[e]];return t},toString:function(){return"matrix("+f(this.a)+","+f(this.b)+","+f(this.c)+","+f(this.d)+","+f(this.e)+","+f(this.f)+")"}},parent:d.Element,construct:{ctm:function(){return new d.Matrix(this.node.getCTM())},screenCTM:function(){if(this instanceof d.Nested){var t=this.rect(1,1),e=t.node.getScreenCTM();return t.remove(),new d.Matrix(e)}return new d.Matrix(this.node.getScreenCTM())}}}),d.Point=d.invent({create:function(t,e){var i;i=Array.isArray(t)?{x:t[0],y:t[1]}:"object"==typeof t?{x:t.x,y:t.y}:null!=t?{x:t,y:null!=e?e:t}:{x:0,y:0},this.x=i.x,this.y=i.y},extend:{clone:function(){return new d.Point(this)},morph:function(t,e){return this.destination=new d.Point(t,e),this},at:function(t){return this.destination?new d.Point({x:this.x+(this.destination.x-this.x)*t,y:this.y+(this.destination.y-this.y)*t}):this},native:function(){var t=d.parser.native.createSVGPoint();return t.x=this.x,t.y=this.y,t},transform:function(t){return new d.Point(this.native().matrixTransform(t.native()))}}}),d.extend(d.Element,{point:function(t,e){return new d.Point(t,e).transform(this.screenCTM().inverse())}}),d.extend(d.Element,{attr:function(t,e,i){if(null==t){for(t={},i=(e=this.node.attributes).length-1;i>=0;i--)t[e[i].nodeName]=d.regex.isNumber.test(e[i].nodeValue)?parseFloat(e[i].nodeValue):e[i].nodeValue;return t}if("object"==typeof t)for(e in t)this.attr(e,t[e]);else if(null===e)this.node.removeAttribute(t);else{if(null==e)return null==(e=this.node.getAttribute(t))?d.defaults.attrs[t]:d.regex.isNumber.test(e)?parseFloat(e):e;"stroke-width"==t?this.attr("stroke",parseFloat(e)>0?this._stroke:null):"stroke"==t&&(this._stroke=e),"fill"!=t&&"stroke"!=t||(d.regex.isImage.test(e)&&(e=this.doc().defs().image(e,0,0)),e instanceof d.Image&&(e=this.doc().defs().pattern(0,0,function(){this.add(e)}))),"number"==typeof e?e=new d.Number(e):d.Color.isColor(e)?e=new d.Color(e):Array.isArray(e)&&(e=new d.Array(e)),"leading"==t?this.leading&&this.leading(e):"string"==typeof i?this.node.setAttributeNS(i,t,e.toString()):this.node.setAttribute(t,e.toString()),!this.rebuild||"font-size"!=t&&"x"!=t||this.rebuild(t,e)}return this}}),d.extend(d.Element,{transform:function(t,e){var i,n,s=this;if("object"!=typeof t)return i=new d.Matrix(s).extract(),"string"==typeof t?i[t]:i;if(i=new d.Matrix(s),e=!!e||!!t.relative,null!=t.a)i=e?i.multiply(new d.Matrix(t)):new d.Matrix(t);else if(null!=t.rotation)l(t,s),i=e?i.rotate(t.rotation,t.cx,t.cy):i.rotate(t.rotation-i.extract().rotation,t.cx,t.cy);else if(null!=t.scale||null!=t.scaleX||null!=t.scaleY){if(l(t,s),t.scaleX=null!=t.scale?t.scale:null!=t.scaleX?t.scaleX:1,t.scaleY=null!=t.scale?t.scale:null!=t.scaleY?t.scaleY:1,!e){var o=i.extract();t.scaleX=1*t.scaleX/o.scaleX,t.scaleY=1*t.scaleY/o.scaleY}i=i.scale(t.scaleX,t.scaleY,t.cx,t.cy)}else if(null!=t.skew||null!=t.skewX||null!=t.skewY){if(l(t,s),t.skewX=null!=t.skew?t.skew:null!=t.skewX?t.skewX:0,t.skewY=null!=t.skew?t.skew:null!=t.skewY?t.skewY:0,!e){o=i.extract();i=i.multiply((new d.Matrix).skew(o.skewX,o.skewY,t.cx,t.cy).inverse())}i=i.skew(t.skewX,t.skewY,t.cx,t.cy)}else t.flip?("x"==t.flip||"y"==t.flip?t.offset=null==t.offset?s.bbox()["c"+t.flip]:t.offset:null==t.offset?(n=s.bbox(),t.flip=n.cx,t.offset=n.cy):t.flip=t.offset,i=(new d.Matrix).flip(t.flip,t.offset)):null==t.x&&null==t.y||(e?i=i.translate(t.x,t.y):(null!=t.x&&(i.e=t.x),null!=t.y&&(i.f=t.y)));return this.attr("transform",i)}}),d.extend(d.FX,{transform:function(t,e){var i,n,s=this.target();return"object"!=typeof t?(i=new d.Matrix(s).extract(),"string"==typeof t?i[t]:i):(e=!!e||!!t.relative,null!=t.a?i=new d.Matrix(t):null!=t.rotation?(l(t,s),i=new d.Rotate(t.rotation,t.cx,t.cy)):null!=t.scale||null!=t.scaleX||null!=t.scaleY?(l(t,s),t.scaleX=null!=t.scale?t.scale:null!=t.scaleX?t.scaleX:1,t.scaleY=null!=t.scale?t.scale:null!=t.scaleY?t.scaleY:1,i=new d.Scale(t.scaleX,t.scaleY,t.cx,t.cy)):null!=t.skewX||null!=t.skewY?(l(t,s),t.skewX=null!=t.skewX?t.skewX:0,t.skewY=null!=t.skewY?t.skewY:0,i=new d.Skew(t.skewX,t.skewY,t.cx,t.cy)):t.flip?("x"==t.flip||"y"==t.flip?t.offset=null==t.offset?s.bbox()["c"+t.flip]:t.offset:null==t.offset?(n=s.bbox(),t.flip=n.cx,t.offset=n.cy):t.flip=t.offset,i=(new d.Matrix).flip(t.flip,t.offset)):null==t.x&&null==t.y||(i=new d.Translate(t.x,t.y)),i?(i.relative=e,this.last().transforms.push(i),this._callStart()):this)}}),d.extend(d.Element,{untransform:function(){return this.attr("transform",null)},matrixify:function(){return(this.attr("transform")||"").split(d.regex.transforms).slice(0,-1).map(function(t){var e=t.trim().split("(");return[e[0],e[1].split(d.regex.delimiter).map(function(t){return parseFloat(t)})]}).reduce(function(t,e){return"matrix"==e[0]?t.multiply(h(e[1])):t[e[0]].apply(t,e[1])},new d.Matrix)},toParent:function(t){if(this==t)return this;var e=this.screenCTM(),i=t.screenCTM().inverse();return this.addTo(t).untransform().transform(i.multiply(e)),this},toDoc:function(){return this.toParent(this.doc())}}),d.Transformation=d.invent({create:function(t,e){if(arguments.length>1&&"boolean"!=typeof e)return this.constructor.call(this,[].slice.call(arguments));if(Array.isArray(t))for(var i=0,n=this.arguments.length;i<n;++i)this[this.arguments[i]]=t[i];else if("object"==typeof t)for(i=0,n=this.arguments.length;i<n;++i)this[this.arguments[i]]=t[this.arguments[i]];this.inversed=!1,!0===e&&(this.inversed=!0)},extend:{arguments:[],method:"",at:function(t){for(var e=[],i=0,n=this.arguments.length;i<n;++i)e.push(this[this.arguments[i]]);var s=this._undo||new d.Matrix;return s=(new d.Matrix).morph(d.Matrix.prototype[this.method].apply(s,e)).at(t),this.inversed?s.inverse():s},undo:function(t){for(var e=0,i=this.arguments.length;e<i;++e)t[this.arguments[e]]=void 0===this[this.arguments[e]]?0:t[this.arguments[e]];return t.cx=this.cx,t.cy=this.cy,this._undo=new(d[s(this.method)])(t,!0).at(1),this}}}),d.Translate=d.invent({parent:d.Matrix,inherit:d.Transformation,create:function(t,e){this.constructor.apply(this,[].slice.call(arguments))},extend:{arguments:["transformedX","transformedY"],method:"translate"}}),d.Rotate=d.invent({parent:d.Matrix,inherit:d.Transformation,create:function(t,e){this.constructor.apply(this,[].slice.call(arguments))},extend:{arguments:["rotation","cx","cy"],method:"rotate",at:function(t){var e=(new d.Matrix).rotate((new d.Number).morph(this.rotation-(this._undo?this._undo.rotation:0)).at(t),this.cx,this.cy);return this.inversed?e.inverse():e},undo:function(t){return this._undo=t,this}}}),d.Scale=d.invent({parent:d.Matrix,inherit:d.Transformation,create:function(t,e){this.constructor.apply(this,[].slice.call(arguments))},extend:{arguments:["scaleX","scaleY","cx","cy"],method:"scale"}}),d.Skew=d.invent({parent:d.Matrix,inherit:d.Transformation,create:function(t,e){this.constructor.apply(this,[].slice.call(arguments))},extend:{arguments:["skewX","skewY","cx","cy"],method:"skew"}}),d.extend(d.Element,{style:function(t,e){if(0==arguments.length)return this.node.style.cssText||"";if(arguments.length<2)if("object"==typeof t)for(e in t)this.style(e,t[e]);else{if(!d.regex.isCss.test(t))return this.node.style[n(t)];for(t=t.split(/\s*;\s*/).filter(function(t){return!!t}).map(function(t){return t.split(/\s*:\s*/)});e=t.pop();)this.style(e[0],e[1])}else this.node.style[n(t)]=null===e||d.regex.isBlank.test(e)?"":e;return this}}),d.Parent=d.invent({create:function(t){this.constructor.call(this,t)},inherit:d.Element,extend:{children:function(){return d.utils.map(d.utils.filterSVGElements(this.node.childNodes),function(t){return d.adopt(t)})},add:function(t,e){return null==e?this.node.appendChild(t.node):t.node!=this.node.childNodes[e]&&this.node.insertBefore(t.node,this.node.childNodes[e]),this},put:function(t,e){return this.add(t,e),t},has:function(t){return this.index(t)>=0},index:function(t){return[].slice.call(this.node.childNodes).indexOf(t.node)},get:function(t){return d.adopt(this.node.childNodes[t])},first:function(){return this.get(0)},last:function(){return this.get(this.node.childNodes.length-1)},each:function(t,e){var i,n,s=this.children();for(i=0,n=s.length;i<n;i++)s[i]instanceof d.Element&&t.apply(s[i],[i,s]),e&&s[i]instanceof d.Container&&s[i].each(t,e);return this},removeElement:function(t){return this.node.removeChild(t.node),this},clear:function(){for(;this.node.hasChildNodes();)this.node.removeChild(this.node.lastChild);return delete this._defs,this},defs:function(){return this.doc().defs()}}}),d.extend(d.Parent,{ungroup:function(t,e){return 0===e||this instanceof d.Defs||this.node==d.parser.draw?this:(t=t||(this instanceof d.Doc?this:this.parent(d.Parent)),e=e||1/0,this.each(function(){return this instanceof d.Defs?this:this instanceof d.Parent?this.ungroup(t,e-1):this.toParent(t)}),this.node.firstChild||this.remove(),this)},flatten:function(t,e){return this.ungroup(t,e)}}),d.Container=d.invent({create:function(t){this.constructor.call(this,t)},inherit:d.Parent}),d.ViewBox=d.invent({create:function(t){var e,i,n,s,o,r,a,h=1,l=1,u=/[+-]?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?/gi;if(t instanceof d.Element){for(r=t,a=t,o=(t.attr("viewBox")||"").match(u),t.bbox,n=new d.Number(t.width()),s=new d.Number(t.height());"%"==n.unit;)h*=n.value,n=new d.Number(r instanceof d.Doc?r.parent().offsetWidth:r.parent().width()),r=r.parent();for(;"%"==s.unit;)l*=s.value,s=new d.Number(a instanceof d.Doc?a.parent().offsetHeight:a.parent().height()),a=a.parent();this.x=0,this.y=0,this.width=n*h,this.height=s*l,this.zoom=1,o&&(e=parseFloat(o[0]),i=parseFloat(o[1]),n=parseFloat(o[2]),s=parseFloat(o[3]),this.zoom=this.width/this.height>n/s?this.height/s:this.width/n,this.x=e,this.y=i,this.width=n,this.height=s)}else t="string"==typeof t?t.match(u).map(function(t){return parseFloat(t)}):Array.isArray(t)?t:"object"==typeof t?[t.x,t.y,t.width,t.height]:4==arguments.length?[].slice.call(arguments):[0,0,0,0],this.x=t[0],this.y=t[1],this.width=t[2],this.height=t[3]},extend:{toString:function(){return this.x+" "+this.y+" "+this.width+" "+this.height},morph:function(t,e,i,n){return this.destination=new d.ViewBox(t,e,i,n),this},at:function(t){return this.destination?new d.ViewBox([this.x+(this.destination.x-this.x)*t,this.y+(this.destination.y-this.y)*t,this.width+(this.destination.width-this.width)*t,this.height+(this.destination.height-this.height)*t]):this}},parent:d.Container,construct:{viewbox:function(t,e,i,n){return 0==arguments.length?new d.ViewBox(this):this.attr("viewBox",new d.ViewBox(t,e,i,n))}}}),["click","dblclick","mousedown","mouseup","mouseover","mouseout","mousemove","touchstart","touchmove","touchleave","touchend","touchcancel"].forEach(function(t){d.Element.prototype[t]=function(e){return d.on(this.node,t,e),this}}),d.listeners=[],d.handlerMap=[],d.listenerId=0,d.on=function(t,e,i,n,s){var o=i.bind(n||t.instance||t),r=(d.handlerMap.indexOf(t)+1||d.handlerMap.push(t))-1,a=e.split(".")[0],h=e.split(".")[1]||"*";d.listeners[r]=d.listeners[r]||{},d.listeners[r][a]=d.listeners[r][a]||{},d.listeners[r][a][h]=d.listeners[r][a][h]||{},i._svgjsListenerId||(i._svgjsListenerId=++d.listenerId),d.listeners[r][a][h][i._svgjsListenerId]=o,t.addEventListener(a,o,s||!1)},d.off=function(t,e,i){var n=d.handlerMap.indexOf(t),s=e&&e.split(".")[0],o=e&&e.split(".")[1],r="";if(-1!=n)if(i){if("function"==typeof i&&(i=i._svgjsListenerId),!i)return;d.listeners[n][s]&&d.listeners[n][s][o||"*"]&&(t.removeEventListener(s,d.listeners[n][s][o||"*"][i],!1),delete d.listeners[n][s][o||"*"][i])}else if(o&&s){if(d.listeners[n][s]&&d.listeners[n][s][o]){for(i in d.listeners[n][s][o])d.off(t,[s,o].join("."),i);delete d.listeners[n][s][o]}}else if(o)for(e in d.listeners[n])for(r in d.listeners[n][e])o===r&&d.off(t,[e,o].join("."));else if(s){if(d.listeners[n][s]){for(r in d.listeners[n][s])d.off(t,[s,r].join("."));delete d.listeners[n][s]}}else{for(e in d.listeners[n])d.off(t,e);delete d.listeners[n],delete d.handlerMap[n]}},d.extend(d.Element,{on:function(t,e,i,n){return d.on(this.node,t,e,i,n),this},off:function(t,e){return d.off(this.node,t,e),this},fire:function(e,i){return e instanceof t.Event?this.node.dispatchEvent(e):this.node.dispatchEvent(e=new t.CustomEvent(e,{detail:i,cancelable:!0})),this._event=e,this},event:function(){return this._event}}),d.Defs=d.invent({create:"defs",inherit:d.Container}),d.G=d.invent({create:"g",inherit:d.Container,extend:{x:function(t){return null==t?this.transform("x"):this.transform({x:t-this.x()},!0)},y:function(t){return null==t?this.transform("y"):this.transform({y:t-this.y()},!0)},cx:function(t){return null==t?this.gbox().cx:this.x(t-this.gbox().width/2)},cy:function(t){return null==t?this.gbox().cy:this.y(t-this.gbox().height/2)},gbox:function(){var t=this.bbox(),e=this.transform();return t.x+=e.x,t.x2+=e.x,t.cx+=e.x,t.y+=e.y,t.y2+=e.y,t.cy+=e.y,t}},construct:{group:function(){return this.put(new d.G)}}}),d.extend(d.Element,{siblings:function(){return this.parent().children()},position:function(){return this.parent().index(this)},next:function(){return this.siblings()[this.position()+1]},previous:function(){return this.siblings()[this.position()-1]},forward:function(){var t=this.position()+1,e=this.parent();return e.removeElement(this).add(this,t),e instanceof d.Doc&&e.node.appendChild(e.defs().node),this},backward:function(){var t=this.position();return t>0&&this.parent().removeElement(this).add(this,t-1),this},front:function(){var t=this.parent();return t.node.appendChild(this.node),t instanceof d.Doc&&t.node.appendChild(t.defs().node),this},back:function(){return this.position()>0&&this.parent().removeElement(this).add(this,0),this},before:function(t){t.remove();var e=this.position();return this.parent().add(t,e),this},after:function(t){t.remove();var e=this.position();return this.parent().add(t,e+1),this}}),d.Mask=d.invent({create:function(){this.constructor.call(this,d.create("mask")),this.targets=[]},inherit:d.Container,extend:{remove:function(){for(var t=this.targets.length-1;t>=0;t--)this.targets[t]&&this.targets[t].unmask();return this.targets=[],this.parent().removeElement(this),this}},construct:{mask:function(){return this.defs().put(new d.Mask)}}}),d.extend(d.Element,{maskWith:function(t){return this.masker=t instanceof d.Mask?t:this.parent().mask().add(t),this.masker.targets.push(this),this.attr("mask",'url("#'+this.masker.attr("id")+'")')},unmask:function(){return delete this.masker,this.attr("mask",null)}}),d.ClipPath=d.invent({create:function(){this.constructor.call(this,d.create("clipPath")),this.targets=[]},inherit:d.Container,extend:{remove:function(){for(var t=this.targets.length-1;t>=0;t--)this.targets[t]&&this.targets[t].unclip();return this.targets=[],this.parent().removeElement(this),this}},construct:{clip:function(){return this.defs().put(new d.ClipPath)}}}),d.extend(d.Element,{clipWith:function(t){return this.clipper=t instanceof d.ClipPath?t:this.parent().clip().add(t),this.clipper.targets.push(this),this.attr("clip-path",'url("#'+this.clipper.attr("id")+'")')},unclip:function(){return delete this.clipper,this.attr("clip-path",null)}}),d.Gradient=d.invent({create:function(t){this.constructor.call(this,d.create(t+"Gradient")),this.type=t},inherit:d.Container,extend:{at:function(t,e,i){return this.put(new d.Stop).update(t,e,i)},update:function(t){return this.clear(),"function"==typeof t&&t.call(this,this),this},fill:function(){return"url(#"+this.id()+")"},toString:function(){return this.fill()},attr:function(t,e,i){return"transform"==t&&(t="gradientTransform"),d.Container.prototype.attr.call(this,t,e,i)}},construct:{gradient:function(t,e){return this.defs().gradient(t,e)}}}),d.extend(d.Gradient,d.FX,{from:function(t,e){return"radial"==(this._target||this).type?this.attr({fx:new d.Number(t),fy:new d.Number(e)}):this.attr({x1:new d.Number(t),y1:new d.Number(e)})},to:function(t,e){return"radial"==(this._target||this).type?this.attr({cx:new d.Number(t),cy:new d.Number(e)}):this.attr({x2:new d.Number(t),y2:new d.Number(e)})}}),d.extend(d.Defs,{gradient:function(t,e){return this.put(new d.Gradient(t)).update(e)}}),d.Stop=d.invent({create:"stop",inherit:d.Element,extend:{update:function(t){return("number"==typeof t||t instanceof d.Number)&&(t={offset:arguments[0],color:arguments[1],opacity:arguments[2]}),null!=t.opacity&&this.attr("stop-opacity",t.opacity),null!=t.color&&this.attr("stop-color",t.color),null!=t.offset&&this.attr("offset",new d.Number(t.offset)),this}}}),d.Pattern=d.invent({create:"pattern",inherit:d.Container,extend:{fill:function(){return"url(#"+this.id()+")"},update:function(t){return this.clear(),"function"==typeof t&&t.call(this,this),this},toString:function(){return this.fill()},attr:function(t,e,i){return"transform"==t&&(t="patternTransform"),d.Container.prototype.attr.call(this,t,e,i)}},construct:{pattern:function(t,e,i){return this.defs().pattern(t,e,i)}}}),d.extend(d.Defs,{pattern:function(t,e,i){return this.put(new d.Pattern).update(i).attr({x:0,y:0,width:t,height:e,patternUnits:"userSpaceOnUse"})}}),d.Doc=d.invent({create:function(t){t&&("svg"==(t="string"==typeof t?e.getElementById(t):t).nodeName?this.constructor.call(this,t):(this.constructor.call(this,d.create("svg")),t.appendChild(this.node),this.size("100%","100%")),this.namespace().defs())},inherit:d.Container,extend:{namespace:function(){return this.attr({xmlns:d.ns,version:"1.1"}).attr("xmlns:xlink",d.xlink,d.xmlns).attr("xmlns:svgjs",d.svgjs,d.xmlns)},defs:function(){var t;this._defs||((t=this.node.getElementsByTagName("defs")[0])?this._defs=d.adopt(t):this._defs=new d.Defs,this.node.appendChild(this._defs.node));return this._defs},parent:function(){return"#document"==this.node.parentNode.nodeName?null:this.node.parentNode},spof:function(){var t=this.node.getScreenCTM();return t&&this.style("left",-t.e%1+"px").style("top",-t.f%1+"px"),this},remove:function(){return this.parent()&&this.parent().removeChild(this.node),this},clear:function(){for(;this.node.hasChildNodes();)this.node.removeChild(this.node.lastChild);return delete this._defs,d.parser.draw.parentNode||this.node.appendChild(d.parser.draw),this}}}),d.Shape=d.invent({create:function(t){this.constructor.call(this,t)},inherit:d.Element}),d.Bare=d.invent({create:function(t,e){if(this.constructor.call(this,d.create(t)),e)for(var i in e.prototype)"function"==typeof e.prototype[i]&&(this[i]=e.prototype[i])},inherit:d.Element,extend:{words:function(t){for(;this.node.hasChildNodes();)this.node.removeChild(this.node.lastChild);return this.node.appendChild(e.createTextNode(t)),this}}}),d.extend(d.Parent,{element:function(t,e){return this.put(new d.Bare(t,e))}}),d.Symbol=d.invent({create:"symbol",inherit:d.Container,construct:{symbol:function(){return this.put(new d.Symbol)}}}),d.Use=d.invent({create:"use",inherit:d.Shape,extend:{element:function(t,e){return this.attr("href",(e||"")+"#"+t,d.xlink)}},construct:{use:function(t,e){return this.put(new d.Use).element(t,e)}}}),d.Rect=d.invent({create:"rect",inherit:d.Shape,construct:{rect:function(t,e){return this.put(new d.Rect).size(t,e)}}}),d.Circle=d.invent({create:"circle",inherit:d.Shape,construct:{circle:function(t){return this.put(new d.Circle).rx(new d.Number(t).divide(2)).move(0,0)}}}),d.extend(d.Circle,d.FX,{rx:function(t){return this.attr("r",t)},ry:function(t){return this.rx(t)}}),d.Ellipse=d.invent({create:"ellipse",inherit:d.Shape,construct:{ellipse:function(t,e){return this.put(new d.Ellipse).size(t,e).move(0,0)}}}),d.extend(d.Ellipse,d.Rect,d.FX,{rx:function(t){return this.attr("rx",t)},ry:function(t){return this.attr("ry",t)}}),d.extend(d.Circle,d.Ellipse,{x:function(t){return null==t?this.cx()-this.rx():this.cx(t+this.rx())},y:function(t){return null==t?this.cy()-this.ry():this.cy(t+this.ry())},cx:function(t){return null==t?this.attr("cx"):this.attr("cx",t)},cy:function(t){return null==t?this.attr("cy"):this.attr("cy",t)},width:function(t){return null==t?2*this.rx():this.rx(new d.Number(t).divide(2))},height:function(t){return null==t?2*this.ry():this.ry(new d.Number(t).divide(2))},size:function(t,e){var i=r(this,t,e);return this.rx(new d.Number(i.width).divide(2)).ry(new d.Number(i.height).divide(2))}}),d.Line=d.invent({create:"line",inherit:d.Shape,extend:{array:function(){return new d.PointArray([[this.attr("x1"),this.attr("y1")],[this.attr("x2"),this.attr("y2")]])},plot:function(t,e,i,n){return null==t?this.array():(t=void 0!==e?{x1:t,y1:e,x2:i,y2:n}:new d.PointArray(t).toLine(),this.attr(t))},move:function(t,e){return this.attr(this.array().move(t,e).toLine())},size:function(t,e){var i=r(this,t,e);return this.attr(this.array().size(i.width,i.height).toLine())}},construct:{line:function(t,e,i,n){return d.Line.prototype.plot.apply(this.put(new d.Line),null!=t?[t,e,i,n]:[0,0,0,0])}}}),d.Polyline=d.invent({create:"polyline",inherit:d.Shape,construct:{polyline:function(t){return this.put(new d.Polyline).plot(t||new d.PointArray)}}}),d.Polygon=d.invent({create:"polygon",inherit:d.Shape,construct:{polygon:function(t){return this.put(new d.Polygon).plot(t||new d.PointArray)}}}),d.extend(d.Polyline,d.Polygon,{array:function(){return this._array||(this._array=new d.PointArray(this.attr("points")))},plot:function(t){return null==t?this.array():this.clear().attr("points","string"==typeof t?t:this._array=new d.PointArray(t))},clear:function(){return delete this._array,this},move:function(t,e){return this.attr("points",this.array().move(t,e))},size:function(t,e){var i=r(this,t,e);return this.attr("points",this.array().size(i.width,i.height))}}),d.extend(d.Line,d.Polyline,d.Polygon,{morphArray:d.PointArray,x:function(t){return null==t?this.bbox().x:this.move(t,this.bbox().y)},y:function(t){return null==t?this.bbox().y:this.move(this.bbox().x,t)},width:function(t){var e=this.bbox();return null==t?e.width:this.size(t,e.height)},height:function(t){var e=this.bbox();return null==t?e.height:this.size(e.width,t)}}),d.Path=d.invent({create:"path",inherit:d.Shape,extend:{morphArray:d.PathArray,array:function(){return this._array||(this._array=new d.PathArray(this.attr("d")))},plot:function(t){return null==t?this.array():this.clear().attr("d","string"==typeof t?t:this._array=new d.PathArray(t))},clear:function(){return delete this._array,this},move:function(t,e){return this.attr("d",this.array().move(t,e))},x:function(t){return null==t?this.bbox().x:this.move(t,this.bbox().y)},y:function(t){return null==t?this.bbox().y:this.move(this.bbox().x,t)},size:function(t,e){var i=r(this,t,e);return this.attr("d",this.array().size(i.width,i.height))},width:function(t){return null==t?this.bbox().width:this.size(t,this.bbox().height)},height:function(t){return null==t?this.bbox().height:this.size(this.bbox().width,t)}},construct:{path:function(t){return this.put(new d.Path).plot(t||new d.PathArray)}}}),d.Image=d.invent({create:"image",inherit:d.Shape,extend:{load:function(e){if(!e)return this;var i=this,n=new t.Image;return d.on(n,"load",function(){d.off(n);var t=i.parent(d.Pattern);null!==t&&(0==i.width()&&0==i.height()&&i.size(n.width,n.height),t&&0==t.width()&&0==t.height()&&t.size(i.width(),i.height()),"function"==typeof i._loaded&&i._loaded.call(i,{width:n.width,height:n.height,ratio:n.width/n.height,url:e}))}),d.on(n,"error",function(t){d.off(n),"function"==typeof i._error&&i._error.call(i,t)}),this.attr("href",n.src=this.src=e,d.xlink)},loaded:function(t){return this._loaded=t,this},error:function(t){return this._error=t,this}},construct:{image:function(t,e,i){return this.put(new d.Image).load(t).size(e||0,i||e||0)}}}),d.Text=d.invent({create:function(){this.constructor.call(this,d.create("text")),this.dom.leading=new d.Number(1.3),this._rebuild=!0,this._build=!1,this.attr("font-family",d.defaults.attrs["font-family"])},inherit:d.Shape,extend:{x:function(t){return null==t?this.attr("x"):this.attr("x",t)},y:function(t){var e=this.attr("y"),i="number"==typeof e?e-this.bbox().y:0;return null==t?"number"==typeof e?e-i:e:this.attr("y","number"==typeof t?t+i:t)},cx:function(t){return null==t?this.bbox().cx:this.x(t-this.bbox().width/2)},cy:function(t){return null==t?this.bbox().cy:this.y(t-this.bbox().height/2)},text:function(t){if(void 0===t){t="";for(var e=this.node.childNodes,i=0,n=e.length;i<n;++i)0!=i&&3!=e[i].nodeType&&1==d.adopt(e[i]).dom.newLined&&(t+="\n"),t+=e[i].textContent;return t}if(this.clear().build(!0),"function"==typeof t)t.call(this,this);else{i=0;for(var s=(t=t.split("\n")).length;i<s;i++)this.tspan(t[i]).newLine()}return this.build(!1).rebuild()},size:function(t){return this.attr("font-size",t).rebuild()},leading:function(t){return null==t?this.dom.leading:(this.dom.leading=new d.Number(t),this.rebuild())},lines:function(){var t=(this.textPath&&this.textPath()||this).node,e=d.utils.map(d.utils.filterSVGElements(t.childNodes),function(t){return d.adopt(t)});return new d.Set(e)},rebuild:function(t){if("boolean"==typeof t&&(this._rebuild=t),this._rebuild){var e=this,i=0,n=this.dom.leading*new d.Number(this.attr("font-size"));this.lines().each(function(){this.dom.newLined&&(e.textPath()||this.attr("x",e.attr("x")),"\n"==this.text()?i+=n:(this.attr("dy",n+i),i=0))}),this.fire("rebuild")}return this},build:function(t){return this._build=!!t,this},setData:function(t){return this.dom=t,this.dom.leading=new d.Number(t.leading||1.3),this}},construct:{text:function(t){return this.put(new d.Text).text(t)},plain:function(t){return this.put(new d.Text).plain(t)}}}),d.Tspan=d.invent({create:"tspan",inherit:d.Shape,extend:{text:function(t){return null==t?this.node.textContent+(this.dom.newLined?"\n":""):("function"==typeof t?t.call(this,this):this.plain(t),this)},dx:function(t){return this.attr("dx",t)},dy:function(t){return this.attr("dy",t)},newLine:function(){var t=this.parent(d.Text);return this.dom.newLined=!0,this.dy(t.dom.leading*t.attr("font-size")).attr("x",t.x())}}}),d.extend(d.Text,d.Tspan,{plain:function(t){return!1===this._build&&this.clear(),this.node.appendChild(e.createTextNode(t)),this},tspan:function(t){var e=(this.textPath&&this.textPath()||this).node,i=new d.Tspan;return!1===this._build&&this.clear(),e.appendChild(i.node),i.text(t)},clear:function(){for(var t=(this.textPath&&this.textPath()||this).node;t.hasChildNodes();)t.removeChild(t.lastChild);return this},length:function(){return this.node.getComputedTextLength()}}),d.TextPath=d.invent({create:"textPath",inherit:d.Parent,parent:d.Text,construct:{morphArray:d.PathArray,path:function(t){for(var e=new d.TextPath,i=this.doc().defs().path(t);this.node.hasChildNodes();)e.node.appendChild(this.node.firstChild);return this.node.appendChild(e.node),e.attr("href","#"+i,d.xlink),this},array:function(){var t=this.track();return t?t.array():null},plot:function(t){var e=this.track(),i=null;return e&&(i=e.plot(t)),null==t?i:this},track:function(){var t=this.textPath();if(t)return t.reference("href")},textPath:function(){if(this.node.firstChild&&"textPath"==this.node.firstChild.nodeName)return d.adopt(this.node.firstChild)}}}),d.Nested=d.invent({create:function(){this.constructor.call(this,d.create("svg")),this.style("overflow","visible")},inherit:d.Container,construct:{nested:function(){return this.put(new d.Nested)}}}),d.A=d.invent({create:"a",inherit:d.Container,extend:{to:function(t){return this.attr("href",t,d.xlink)},show:function(t){return this.attr("show",t,d.xlink)},target:function(t){return this.attr("target",t)}},construct:{link:function(t){return this.put(new d.A).to(t)}}}),d.extend(d.Element,{linkTo:function(t){var e=new d.A;return"function"==typeof t?t.call(e,e):e.to(t),this.parent().put(e).put(this)}}),d.Marker=d.invent({create:"marker",inherit:d.Container,extend:{width:function(t){return this.attr("markerWidth",t)},height:function(t){return this.attr("markerHeight",t)},ref:function(t,e){return this.attr("refX",t).attr("refY",e)},update:function(t){return this.clear(),"function"==typeof t&&t.call(this,this),this},toString:function(){return"url(#"+this.id()+")"}},construct:{marker:function(t,e,i){return this.defs().marker(t,e,i)}}}),d.extend(d.Defs,{marker:function(t,e,i){return this.put(new d.Marker).size(t,e).ref(t/2,e/2).viewbox(0,0,t,e).attr("orient","auto").update(i)}}),d.extend(d.Line,d.Polyline,d.Polygon,d.Path,{marker:function(t,e,i,n){var s=["marker"];return"all"!=t&&s.push(t),s=s.join("-"),t=arguments[1]instanceof d.Marker?arguments[1]:this.doc().marker(e,i,n),this.attr(s,t)}});var y={stroke:["color","width","opacity","linecap","linejoin","miterlimit","dasharray","dashoffset"],fill:["color","opacity","rule"],prefix:function(t,e){return"color"==e?t:t+"-"+e}};["fill","stroke"].forEach(function(t){var e,i={};i[t]=function(i){if(void 0===i)return this;if("string"==typeof i||d.Color.isRgb(i)||i&&"function"==typeof i.fill)this.attr(t,i);else for(e=y[t].length-1;e>=0;e--)null!=i[y[t][e]]&&this.attr(y.prefix(t,y[t][e]),i[y[t][e]]);return this},d.extend(d.Element,d.FX,i)}),d.extend(d.Element,d.FX,{rotate:function(t,e,i){return this.transform({rotation:t,cx:e,cy:i})},skew:function(t,e,i,n){return 1==arguments.length||3==arguments.length?this.transform({skew:t,cx:e,cy:i}):this.transform({skewX:t,skewY:e,cx:i,cy:n})},scale:function(t,e,i,n){return 1==arguments.length||3==arguments.length?this.transform({scale:t,cx:e,cy:i}):this.transform({scaleX:t,scaleY:e,cx:i,cy:n})},translate:function(t,e){return this.transform({x:t,y:e})},flip:function(t,e){return e="number"==typeof t?t:e,this.transform({flip:t||"both",offset:e})},matrix:function(t){return this.attr("transform",new d.Matrix(6==arguments.length?[].slice.call(arguments):t))},opacity:function(t){return this.attr("opacity",t)},dx:function(t){return this.x(new d.Number(t).plus(this instanceof d.FX?0:this.x()),!0)},dy:function(t){return this.y(new d.Number(t).plus(this instanceof d.FX?0:this.y()),!0)},dmove:function(t,e){return this.dx(t).dy(e)}}),d.extend(d.Rect,d.Ellipse,d.Circle,d.Gradient,d.FX,{radius:function(t,e){var i=(this._target||this).type;return"radial"==i||"circle"==i?this.attr("r",new d.Number(t)):this.rx(t).ry(null==e?t:e)}}),d.extend(d.Path,{length:function(){return this.node.getTotalLength()},pointAt:function(t){return this.node.getPointAtLength(t)}}),d.extend(d.Parent,d.Text,d.Tspan,d.FX,{font:function(t,e){if("object"==typeof t)for(e in t)this.font(e,t[e]);return"leading"==t?this.leading(e):"anchor"==t?this.attr("text-anchor",e):"size"==t||"family"==t||"weight"==t||"stretch"==t||"variant"==t||"style"==t?this.attr("font-"+t,e):this.attr(t,e)}}),d.Set=d.invent({create:function(t){Array.isArray(t)?this.members=t:this.clear()},extend:{add:function(){var t,e,i=[].slice.call(arguments);for(t=0,e=i.length;t<e;t++)this.members.push(i[t]);return this},remove:function(t){var e=this.index(t);return e>-1&&this.members.splice(e,1),this},each:function(t){for(var e=0,i=this.members.length;e<i;e++)t.apply(this.members[e],[e,this.members]);return this},clear:function(){return this.members=[],this},length:function(){return this.members.length},has:function(t){return this.index(t)>=0},index:function(t){return this.members.indexOf(t)},get:function(t){return this.members[t]},first:function(){return this.get(0)},last:function(){return this.get(this.members.length-1)},valueOf:function(){return this.members},bbox:function(){if(0==this.members.length)return new d.RBox;var t=this.members[0].rbox(this.members[0].doc());return this.each(function(){t=t.merge(this.rbox(this.doc()))}),t}},construct:{set:function(t){return new d.Set(t)}}}),d.FX.Set=d.invent({create:function(t){this.set=t}}),d.Set.inherit=function(){var t=[];for(var e in d.Shape.prototype)"function"==typeof d.Shape.prototype[e]&&"function"!=typeof d.Set.prototype[e]&&t.push(e);for(var e in t.forEach(function(t){d.Set.prototype[t]=function(){for(var e=0,i=this.members.length;e<i;e++)this.members[e]&&"function"==typeof this.members[e][t]&&this.members[e][t].apply(this.members[e],arguments);return"animate"==t?this.fx||(this.fx=new d.FX.Set(this)):this}}),t=[],d.FX.prototype)"function"==typeof d.FX.prototype[e]&&"function"!=typeof d.FX.Set.prototype[e]&&t.push(e);t.forEach(function(t){d.FX.Set.prototype[t]=function(){for(var e=0,i=this.set.members.length;e<i;e++)this.set.members[e].fx[t].apply(this.set.members[e].fx,arguments);return this}})},d.extend(d.Element,{data:function(t,e,i){if("object"==typeof t)for(e in t)this.data(e,t[e]);else if(arguments.length<2)try{return JSON.parse(this.attr("data-"+t))}catch(e){return this.attr("data-"+t)}else this.attr("data-"+t,null===e?null:!0===i||"string"==typeof e||"number"==typeof e?e:JSON.stringify(e));return this}}),d.extend(d.Element,{remember:function(t,e){if("object"==typeof arguments[0])for(var e in t)this.remember(e,t[e]);else{if(1==arguments.length)return this.memory()[t];this.memory()[t]=e}return this},forget:function(){if(0==arguments.length)this._memory={};else for(var t=arguments.length-1;t>=0;t--)delete this.memory()[arguments[t]];return this},memory:function(){return this._memory||(this._memory={})}}),d.get=function(t){var i=e.getElementById(function(t){var e=t.toString().match(d.regex.reference);if(e)return e[1]}(t)||t);return d.adopt(i)},d.select=function(t,i){return new d.Set(d.utils.map((i||e).querySelectorAll(t),function(t){return d.adopt(t)}))},d.extend(d.Parent,{select:function(t){return d.select(t,this.node)}});var v="abcdef".split("");if("function"!=typeof t.CustomEvent){var x=function(t,i){i=i||{bubbles:!1,cancelable:!1,detail:void 0};var n=e.createEvent("CustomEvent");return n.initCustomEvent(t,i.bubbles,i.cancelable,i.detail),n};x.prototype=t.Event.prototype,t.CustomEvent=x}return function(e){for(var i=0,n=["moz","webkit"],s=0;s<n.length&&!t.requestAnimationFrame;++s)e.requestAnimationFrame=e[n[s]+"RequestAnimationFrame"],e.cancelAnimationFrame=e[n[s]+"CancelAnimationFrame"]||e[n[s]+"CancelRequestAnimationFrame"];e.requestAnimationFrame=e.requestAnimationFrame||function(t){var n=(new Date).getTime(),s=Math.max(0,16-(n-i)),o=e.setTimeout(function(){t(n+s)},s);return i=n+s,o},e.cancelAnimationFrame=e.cancelAnimationFrame||e.clearTimeout}(t),d});var rough=function(){"use strict";var t=Math.round,e=Math.tan,i=Math.pow,n=Math.floor,s=Math.cos,o=Math.sin,r=Math.PI,a=Math.sqrt,h=Math.max,l=Math.min,u=Math.abs,c=Number.MAX_VALUE;class f{constructor(t,e,i,n){this.RoughSegmentRelationConst={LEFT:0,RIGHT:1,INTERSECTS:2,AHEAD:3,BEHIND:4,SEPARATE:5,UNDEFINED:6},this.px1=t,this.py1=e,this.px2=i,this.py2=n,this.xi=c,this.yi=c,this.a=n-e,this.b=t-i,this.c=i*e-t*n,this._undefined=0==this.a&&0==this.b&&0==this.c}isUndefined(){return this._undefined}compare(t){if(this.isUndefined()||t.isUndefined())return this.RoughSegmentRelationConst.UNDEFINED;var e=c,i=c,n=0,s=0,o=this.a,r=this.b,a=this.c;return 1e-5<u(r)&&(e=-o/r,n=-a/r),1e-5<u(t.b)&&(i=-t.a/t.b,s=-t.c/t.b),e==c?i==c?-a/o==-t.c/t.a?this.py1>=l(t.py1,t.py2)&&this.py1<=h(t.py1,t.py2)?(this.xi=this.px1,this.yi=this.py1,this.RoughSegmentRelationConst.INTERSECTS):this.py2>=l(t.py1,t.py2)&&this.py2<=h(t.py1,t.py2)?(this.xi=this.px2,this.yi=this.py2,this.RoughSegmentRelationConst.INTERSECTS):this.RoughSegmentRelationConst.SEPARATE:this.RoughSegmentRelationConst.SEPARATE:(this.xi=this.px1,this.yi=i*this.xi+s,-1e-5>(this.py1-this.yi)*(this.yi-this.py2)||-1e-5>(t.py1-this.yi)*(this.yi-t.py2)?this.RoughSegmentRelationConst.SEPARATE:1e-5>u(t.a)&&-1e-5>(t.px1-this.xi)*(this.xi-t.px2)?this.RoughSegmentRelationConst.SEPARATE:this.RoughSegmentRelationConst.INTERSECTS):i==c?(this.xi=t.px1,this.yi=e*this.xi+n,-1e-5>(t.py1-this.yi)*(this.yi-t.py2)||-1e-5>(this.py1-this.yi)*(this.yi-this.py2)?this.RoughSegmentRelationConst.SEPARATE:1e-5>u(o)&&-1e-5>(this.px1-this.xi)*(this.xi-this.px2)?this.RoughSegmentRelationConst.SEPARATE:this.RoughSegmentRelationConst.INTERSECTS):e==i?n==s?this.px1>=l(t.px1,t.px2)&&this.px1<=h(t.py1,t.py2)?(this.xi=this.px1,this.yi=this.py1,this.RoughSegmentRelationConst.INTERSECTS):this.px2>=l(t.px1,t.px2)&&this.px2<=h(t.px1,t.px2)?(this.xi=this.px2,this.yi=this.py2,this.RoughSegmentRelationConst.INTERSECTS):this.RoughSegmentRelationConst.SEPARATE:this.RoughSegmentRelationConst.SEPARATE:(this.xi=(s-n)/(e-i),this.yi=e*this.xi+n,-1e-5>(this.px1-this.xi)*(this.xi-this.px2)||-1e-5>(t.px1-this.xi)*(this.xi-t.px2)?this.RoughSegmentRelationConst.SEPARATE:this.RoughSegmentRelationConst.INTERSECTS)}getLength(){return this._getLength(this.px1,this.py1,this.px2,this.py2)}_getLength(t,e,i,n){var s=i-t,o=n-e;return a(s*s+o*o)}}class d{constructor(t,e,i,n,s,o,r,a){this.top=t,this.bottom=e,this.left=i,this.right=n,this.gap=s,this.sinAngle=o,this.tanAngle=a,1e-4>u(o)?this.pos=i+s:.9999<u(o)?this.pos=t+s:(this.deltaX=(e-t)*u(a),this.pos=i-u(this.deltaX),this.hGap=u(s/r),this.sLeft=new f(i,e,i,t),this.sRight=new f(n,e,n,t))}getNextLine(){if(1e-4>u(this.sinAngle)){if(this.pos<this.right){let t=[this.pos,this.top,this.pos,this.bottom];return this.pos+=this.gap,t}}else if(.9999<u(this.sinAngle)){if(this.pos<this.bottom){let t=[this.left,this.pos,this.right,this.pos];return this.pos+=this.gap,t}}else{let t=this.pos-this.deltaX/2,e=this.pos+this.deltaX/2,i=this.bottom,n=this.top;if(this.pos<this.right+this.deltaX){for(;t<this.left&&e<this.left||t>this.right&&e>this.right;)if(this.pos+=this.hGap,t=this.pos-this.deltaX/2,e=this.pos+this.deltaX/2,this.pos>this.right+this.deltaX)return null;let s=new f(t,i,e,n);2==s.compare(this.sLeft)&&(t=s.xi,i=s.yi),2==s.compare(this.sRight)&&(e=s.xi,n=s.yi),0<this.tanAngle&&(t=this.right-(t-this.left),e=this.right-(e-this.left));let o=[t,i,e,n];return this.pos+=this.hGap,o}}return null}}class p{constructor(t,e){this.type=t,this.text=e}isType(t){return this.type===t}}class m{constructor(t){this.PARAMS={A:["rx","ry","x-axis-rotation","large-arc-flag","sweep-flag","x","y"],a:["rx","ry","x-axis-rotation","large-arc-flag","sweep-flag","x","y"],C:["x1","y1","x2","y2","x","y"],c:["x1","y1","x2","y2","x","y"],H:["x"],h:["x"],L:["x","y"],l:["x","y"],M:["x","y"],m:["x","y"],Q:["x1","y1","x","y"],q:["x1","y1","x","y"],S:["x2","y2","x","y"],s:["x2","y2","x","y"],T:["x","y"],t:["x","y"],V:["y"],v:["y"],Z:[],z:[]},this.COMMAND=0,this.NUMBER=1,this.EOD=2,this.segments=[],this.d=t||"",this.parseData(t),this.processPoints()}loadFromSegments(t){this.segments=t,this.processPoints()}processPoints(){let t=null,e=[0,0];for(let i,n=0;n<this.segments.length;n++){switch((i=this.segments[n]).key){case"M":case"L":case"T":i.point=[i.data[0],i.data[1]];break;case"m":case"l":case"t":i.point=[i.data[0]+e[0],i.data[1]+e[1]];break;case"H":i.point=[i.data[0],e[1]];break;case"h":i.point=[i.data[0]+e[0],e[1]];break;case"V":i.point=[e[0],i.data[0]];break;case"v":i.point=[e[0],i.data[0]+e[1]];break;case"z":case"Z":t&&(i.point=[t[0],t[1]]);break;case"C":i.point=[i.data[4],i.data[5]];break;case"c":i.point=[i.data[4]+e[0],i.data[5]+e[1]];break;case"S":i.point=[i.data[2],i.data[3]];break;case"s":i.point=[i.data[2]+e[0],i.data[3]+e[1]];break;case"Q":i.point=[i.data[2],i.data[3]];break;case"q":i.point=[i.data[2]+e[0],i.data[3]+e[1]];break;case"A":i.point=[i.data[5],i.data[6]];break;case"a":i.point=[i.data[5]+e[0],i.data[6]+e[1]]}("m"===i.key||"M"===i.key)&&(t=null),i.point&&(e=i.point,!t&&(t=i.point)),("z"===i.key||"Z"===i.key)&&(t=null)}}get closed(){if(void 0===this._closed){this._closed=!1;for(let t of this.segments)"z"===t.key.toLowerCase()&&(this._closed=!0)}return this._closed}parseData(t){var e=this.tokenize(t),i=0,n=e[i],s="BOD";for(this.segments=[];!n.isType(this.EOD);){var o,r=[];if("BOD"!=s)n.isType(this.NUMBER)?o=this.PARAMS[s].length:(i++,o=this.PARAMS[n.text].length,s=n.text);else{if("M"!=n.text&&"m"!=n.text)return this.parseData("M0,0"+t);i++,o=this.PARAMS[n.text].length,s=n.text}if(i+o<e.length){for(var a,h=i;h<i+o;h++){if(!(a=e[h]).isType(this.NUMBER))return void console.error("Parameter type is not a number: "+s+","+a.text);r[r.length]=a.text}var l;if(!this.PARAMS[s])return void console.error("Unsupported segment type: "+s);l={key:s,data:r},this.segments.push(l),n=e[i+=o],"M"==s&&(s="L"),"m"==s&&(s="l")}else console.error("Path data ended before all parameters were found")}}tokenize(t){for(var e=[];""!=t;)if(t.match(/^([ \t\r\n,]+)/))t=t.substr(RegExp.$1.length);else if(t.match(/^([aAcChHlLmMqQsStTvVzZ])/))e[e.length]=new p(this.COMMAND,RegExp.$1),t=t.substr(RegExp.$1.length);else{if(!t.match(/^(([-+]?[0-9]+(\.[0-9]*)?|[-+]?\.[0-9]+)([eE][-+]?[0-9]+)?)/))return console.error("Unrecognized segment command: "+t),null;e[e.length]=new p(this.NUMBER,parseFloat(RegExp.$1)),t=t.substr(RegExp.$1.length)}return e[e.length]=new p(this.EOD,null),e}}class _{constructor(t){this.d=t,this.parsed=new m(t),this._position=[0,0],this.bezierReflectionPoint=null,this.quadReflectionPoint=null,this._first=null}get segments(){return this.parsed.segments}get closed(){return this.parsed.closed}get linearPoints(){if(!this._linearPoints){const t=[];let e=[];for(let i of this.parsed.segments){let n=i.key.toLowerCase();("m"===n||"z"===n)&&(e.length&&(t.push(e),e=[]),"z"===n)||i.point&&e.push(i.point)}e.length&&(t.push(e),e=[]),this._linearPoints=t}return this._linearPoints}get first(){return this._first}set first(t){this._first=t}setPosition(t,e){this._position=[t,e],this._first||(this._first=[t,e])}get position(){return this._position}get x(){return this._position[0]}get y(){return this._position[1]}}class g{constructor(t,e,i,n,h,l){const c=r/180;if(this._segIndex=0,this._numSegs=0,t[0]==e[0]&&t[1]==e[1])return;this._rx=u(i[0]),this._ry=u(i[1]),this._sinPhi=o(n*c),this._cosPhi=s(n*c);var f,d=this._cosPhi*(t[0]-e[0])/2+this._sinPhi*(t[1]-e[1])/2,p=-this._sinPhi*(t[0]-e[0])/2+this._cosPhi*(t[1]-e[1])/2,m=this._rx*this._rx*this._ry*this._ry-this._rx*this._rx*p*p-this._ry*this._ry*d*d;if(0>m){let t=a(1-m/(this._rx*this._rx*this._ry*this._ry));this._rx=t,this._ry=t,f=0}else f=(h==l?-1:1)*a(m/(this._rx*this._rx*p*p+this._ry*this._ry*d*d));let _=f*this._rx*p/this._ry,g=-f*this._ry*d/this._rx;this._C=[0,0],this._C[0]=this._cosPhi*_-this._sinPhi*g+(t[0]+e[0])/2,this._C[1]=this._sinPhi*_+this._cosPhi*g+(t[1]+e[1])/2,this._theta=this.calculateVectorAngle(1,0,(d-_)/this._rx,(p-g)/this._ry);let y=this.calculateVectorAngle((d-_)/this._rx,(p-g)/this._ry,(-d-_)/this._rx,(-p-g)/this._ry);!l&&0<y?y-=2*r:l&&0>y&&(y+=2*r),this._numSegs=Math.ceil(u(y/(r/2))),this._delta=y/this._numSegs,this._T=8/3*o(this._delta/4)*o(this._delta/4)/o(this._delta/2),this._from=t}getNextSegment(){var t,e,i;if(this._segIndex==this._numSegs)return null;let n=s(this._theta),r=o(this._theta),a=this._theta+this._delta,h=s(a),l=o(a);return i=[this._cosPhi*this._rx*h-this._sinPhi*this._ry*l+this._C[0],this._sinPhi*this._rx*h+this._cosPhi*this._ry*l+this._C[1]],t=[this._from[0]+this._T*(-this._cosPhi*this._rx*r-this._sinPhi*this._ry*n),this._from[1]+this._T*(-this._sinPhi*this._rx*r+this._cosPhi*this._ry*n)],e=[i[0]+this._T*(this._cosPhi*this._rx*l+this._sinPhi*this._ry*h),i[1]+this._T*(this._sinPhi*this._rx*l-this._cosPhi*this._ry*h)],this._theta=a,this._from=[i[0],i[1]],this._segIndex++,{cp1:t,cp2:e,to:i}}calculateVectorAngle(t,e,i,n){var s=Math.atan2;let o=s(e,t),a=s(n,i);return a>=o?a-o:2*r-(o-a)}}class y{constructor(t,e){this.sets=t,this.closed=e}fit(t){let e=[];for(const i of this.sets){let s=i.length,o=n(t*s);if(5>o){if(5>=s)continue;o=5}e.push(this.reduce(i,o))}let i="";for(const t of e){for(let e,n=0;n<t.length;n++)e=t[n],i+=0===n?"M"+e[0]+","+e[1]:"L"+e[0]+","+e[1];this.closed&&(i+="z ")}return i}distance(t,e){return a(i(t[0]-e[0],2)+i(t[1]-e[1],2))}reduce(t,e){if(t.length<=e)return t;let i=t.slice(0);for(;i.length>e;){let t=-1,e=-1;for(let n=1;n<i.length-1;n++){let s=this.distance(i[n-1],i[n]),o=this.distance(i[n],i[n+1]),r=this.distance(i[n-1],i[n+1]),h=(s+o+r)/2,l=a(h*(h-s)*(h-o)*(h-r));(0>t||l<t)&&(t=l,e=n)}if(!(0<e))break;i.splice(e,1)}return i}}class v{line(t,e,i,n,s){return{type:"path",ops:this._doubleLine(t,e,i,n,s)}}linearPath(t,e,i){const n=(t||[]).length;if(2<n){let s=[];for(let e=0;e<n-1;e++)s=s.concat(this._doubleLine(t[e][0],t[e][1],t[e+1][0],t[e+1][1],i));return e&&(s=s.concat(this._doubleLine(t[n-1][0],t[n-1][1],t[0][0],t[0][1],i))),{type:"path",ops:s}}return 2===n?this.line(t[0][0],t[0][1],t[1][0],t[1][1],i):void 0}polygon(t,e){return this.linearPath(t,!0,e)}rectangle(t,e,i,n,s){return this.polygon([[t,e],[t+i,e],[t+i,e+n],[t,e+n]],s)}curve(t,e){let i=this._curveWithOffset(t,1*(1+.2*e.roughness),e),n=this._curveWithOffset(t,1.5*(1+.22*e.roughness),e);return{type:"path",ops:i.concat(n)}}ellipse(t,e,i,n,s){const o=2*r/s.curveStepCount;let a=u(i/2),h=u(n/2);a+=this._getOffset(.05*-a,.05*a,s),h+=this._getOffset(.05*-h,.05*h,s);let l=this._ellipse(o,t,e,a,h,1,o*this._getOffset(.1,this._getOffset(.4,1,s),s),s),c=this._ellipse(o,t,e,a,h,1.5,0,s);return{type:"path",ops:l.concat(c)}}arc(t,e,i,n,a,h,c,f,d){let p=t,m=e,_=u(i/2),g=u(n/2);_+=this._getOffset(.01*-_,.01*_,d),g+=this._getOffset(.01*-g,.01*g,d);let y=a,v=h;for(;0>y;)y+=2*r,v+=2*r;v-y>2*r&&(y=0,v=2*r);let x=2*r/d.curveStepCount,w=l(x/2,(v-y)/2),b=this._arc(w,p,m,_,g,y,v,1,d),P=this._arc(w,p,m,_,g,y,v,1.5,d),M=b.concat(P);return c&&(f?M=(M=M.concat(this._doubleLine(p,m,p+_*s(y),m+g*o(y),d))).concat(this._doubleLine(p,m,p+_*s(v),m+g*o(v),d)):(M.push({op:"lineTo",data:[p,m]}),M.push({op:"lineTo",data:[p+_*s(y),m+g*o(y)]}))),{type:"path",ops:M}}hachureFillArc(t,e,i,n,a,h,l){let c=t,f=e,d=u(i/2),p=u(n/2);d+=this._getOffset(.01*-d,.01*d,l),p+=this._getOffset(.01*-p,.01*p,l);let m=a,_=h;for(;0>m;)m+=2*r,_+=2*r;_-m>2*r&&(m=0,_=2*r);let g=(_-m)/l.curveStepCount,y=[],v=[];for(let t=m;t<=_;t+=g)y.push(c+d*s(t)),v.push(f+p*o(t));return y.push(c+d*s(_)),v.push(f+p*o(_)),y.push(c),v.push(f),this.hachureFillShape(y,v,l)}solidFillShape(t,e,i){let n=[];if(t&&e&&t.length&&e.length&&t.length===e.length){let o=i.maxRandomnessOffset||0;const r=t.length;if(2<r){n.push({op:"move",data:[t[0]+this._getOffset(-o,o,i),e[0]+this._getOffset(-o,o,i)]});for(var s=1;s<r;s++)n.push({op:"lineTo",data:[t[s]+this._getOffset(-o,o,i),e[s]+this._getOffset(-o,o,i)]})}}return{type:"fillPath",ops:n}}hachureFillShape(t,i,n){let a=[];if(t&&i&&t.length&&i.length){let u=t[0],c=t[0],f=i[0],p=i[0];for(let e=1;e<t.length;e++)u=l(u,t[e]),c=h(c,t[e]),f=l(f,i[e]),p=h(p,i[e]);const m=n.hachureAngle;let _=n.hachureGap;0>_&&(_=4*n.strokeWidth),_=h(_,.1);const g=m%180*(r/180),y=s(g),v=o(g),x=e(g),w=new d(f-1,p+1,u-1,c+1,_,v,y,x);for(let e;null!=(e=w.getNextLine());){let s=this._getIntersectingLines(e,t,i);for(let t=0;t<s.length;t++)if(t<s.length-1){let e=s[t],i=s[t+1];a=a.concat(this._doubleLine(e[0],e[1],i[0],i[1],n))}}}return{type:"fillSketch",ops:a}}hachureFillEllipse(t,i,n,s,o){let h=[],l=u(n/2),c=u(s/2);l+=this._getOffset(.05*-l,.05*l,o),c+=this._getOffset(.05*-c,.05*c,o);let f=o.hachureAngle,d=o.hachureGap;0>=d&&(d=4*o.strokeWidth);let p=o.fillWeight;0>p&&(p=o.strokeWidth/2);let m=e(f%180*(r/180)),_=c/l,g=a(_*m*_*m+1),y=_*m/g,v=1/g,x=d/(l*c/a(c*v*(c*v)+l*y*(l*y))/l),w=a(l*l-(t-l+x)*(t-l+x));for(var b=t-l+x;b<t+l;b+=x){w=a(l*l-(t-b)*(t-b));let e=this._affine(b,i-w,t,i,y,v,_),n=this._affine(b,i+w,t,i,y,v,_);h=h.concat(this._doubleLine(e[0],e[1],n[0],n[1],o))}return{type:"fillSketch",ops:h}}svgPath(t,e){t=(t||"").replace(/\n/g," ").replace(/(-\s)/g,"-").replace("/(ss)/g"," ");let i=new _(t);if(e.simplification){let t=new y(i.linearPoints,i.closed).fit(e.simplification);i=new _(t)}let n=[],s=i.segments||[];for(let t=0;t<s.length;t++){let o=s[t],r=0<t?s[t-1]:null,a=this._processSegment(i,o,r,e);a&&a.length&&(n=n.concat(a))}return{type:"path",ops:n}}_bezierTo(t,e,i,n,s,o,r,a){let h=[],l=[a.maxRandomnessOffset||1,(a.maxRandomnessOffset||1)+.5],u=null;for(let c=0;2>c;c++)0===c?h.push({op:"move",data:[r.x,r.y]}):h.push({op:"move",data:[r.x+this._getOffset(-l[0],l[0],a),r.y+this._getOffset(-l[0],l[0],a)]}),u=[s+this._getOffset(-l[c],l[c],a),o+this._getOffset(-l[c],l[c],a)],h.push({op:"bcurveTo",data:[t+this._getOffset(-l[c],l[c],a),e+this._getOffset(-l[c],l[c],a),i+this._getOffset(-l[c],l[c],a),n+this._getOffset(-l[c],l[c],a),u[0],u[1]]});return r.setPosition(u[0],u[1]),h}_processSegment(t,e,i,n){let s=[];switch(e.key){case"M":case"m":{let i="m"===e.key;if(2<=e.data.length){let o=+e.data[0],r=+e.data[1];i&&(o+=t.x,r+=t.y);let a=1*(n.maxRandomnessOffset||0);o+=this._getOffset(-a,a,n),r+=this._getOffset(-a,a,n),t.setPosition(o,r),s.push({op:"move",data:[o,r]})}break}case"L":case"l":{let i="l"===e.key;if(2<=e.data.length){let o=+e.data[0],r=+e.data[1];i&&(o+=t.x,r+=t.y),s=s.concat(this._doubleLine(t.x,t.y,o,r,n)),t.setPosition(o,r)}break}case"H":case"h":{const i="h"===e.key;if(e.data.length){let o=+e.data[0];i&&(o+=t.x),s=s.concat(this._doubleLine(t.x,t.y,o,t.y,n)),t.setPosition(o,t.y)}break}case"V":case"v":{const i="v"===e.key;if(e.data.length){let o=+e.data[0];i&&(o+=t.y),s=s.concat(this._doubleLine(t.x,t.y,t.x,o,n)),t.setPosition(t.x,o)}break}case"Z":case"z":t.first&&(s=s.concat(this._doubleLine(t.x,t.y,t.first[0],t.first[1],n)),t.setPosition(t.first[0],t.first[1]),t.first=null);break;case"C":case"c":{const i="c"===e.key;if(6<=e.data.length){let o=+e.data[0],r=+e.data[1],a=+e.data[2],h=+e.data[3],l=+e.data[4],u=+e.data[5];i&&(o+=t.x,a+=t.x,l+=t.x,r+=t.y,h+=t.y,u+=t.y);let c=this._bezierTo(o,r,a,h,l,u,t,n);s=s.concat(c),t.bezierReflectionPoint=[l+(l-a),u+(u-h)]}break}case"S":case"s":{const r="s"===e.key;if(4<=e.data.length){let a=+e.data[0],h=+e.data[1],l=+e.data[2],u=+e.data[3];r&&(a+=t.x,l+=t.x,h+=t.y,u+=t.y);let c=a,f=h,d=i?i.key:"";var o=null;("c"==d||"C"==d||"s"==d||"S"==d)&&(o=t.bezierReflectionPoint),o&&(c=o[0],f=o[1]);let p=this._bezierTo(c,f,a,h,l,u,t,n);s=s.concat(p),t.bezierReflectionPoint=[l+(l-a),u+(u-h)]}break}case"Q":case"q":{const i="q"===e.key;if(4<=e.data.length){let o=+e.data[0],r=+e.data[1],a=+e.data[2],h=+e.data[3];i&&(o+=t.x,a+=t.x,r+=t.y,h+=t.y);let l=1*(1+.2*n.roughness),u=1.5*(1+.22*n.roughness);s.push({op:"move",data:[t.x+this._getOffset(-l,l,n),t.y+this._getOffset(-l,l,n)]});let c=[a+this._getOffset(-l,l,n),h+this._getOffset(-l,l,n)];s.push({op:"qcurveTo",data:[o+this._getOffset(-l,l,n),r+this._getOffset(-l,l,n),c[0],c[1]]}),s.push({op:"move",data:[t.x+this._getOffset(-u,u,n),t.y+this._getOffset(-u,u,n)]}),c=[a+this._getOffset(-u,u,n),h+this._getOffset(-u,u,n)],s.push({op:"qcurveTo",data:[o+this._getOffset(-u,u,n),r+this._getOffset(-u,u,n),c[0],c[1]]}),t.setPosition(c[0],c[1]),t.quadReflectionPoint=[a+(a-o),h+(h-r)]}break}case"T":case"t":{const r="t"===e.key;if(2<=e.data.length){let a=+e.data[0],h=+e.data[1];r&&(a+=t.x,h+=t.y);let l=a,u=h,c=i?i.key:"";o=null;("q"==c||"Q"==c||"t"==c||"T"==c)&&(o=t.quadReflectionPoint),o&&(l=o[0],u=o[1]);let f=1*(1+.2*n.roughness),d=1.5*(1+.22*n.roughness);s.push({op:"move",data:[t.x+this._getOffset(-f,f,n),t.y+this._getOffset(-f,f,n)]});let p=[a+this._getOffset(-f,f,n),h+this._getOffset(-f,f,n)];s.push({op:"qcurveTo",data:[l+this._getOffset(-f,f,n),u+this._getOffset(-f,f,n),p[0],p[1]]}),s.push({op:"move",data:[t.x+this._getOffset(-d,d,n),t.y+this._getOffset(-d,d,n)]}),p=[a+this._getOffset(-d,d,n),h+this._getOffset(-d,d,n)],s.push({op:"qcurveTo",data:[l+this._getOffset(-d,d,n),u+this._getOffset(-d,d,n),p[0],p[1]]}),t.setPosition(p[0],p[1]),t.quadReflectionPoint=[a+(a-l),h+(h-u)]}break}case"A":case"a":{const i="a"===e.key;if(7<=e.data.length){let o=+e.data[0],r=+e.data[1],a=+e.data[2],h=+e.data[3],l=+e.data[4],u=+e.data[5],c=+e.data[6];if(i&&(u+=t.x,c+=t.y),u==t.x&&c==t.y)break;if(0==o||0==r)s=s.concat(this._doubleLine(t.x,t.y,u,c,n)),t.setPosition(u,c);else{n.maxRandomnessOffset;for(let e=0;1>e;e++){let e=new g([t.x,t.y],[u,c],[o,r],a,!!h,!!l),i=e.getNextSegment();for(;i;){let o=this._bezierTo(i.cp1[0],i.cp1[1],i.cp2[0],i.cp2[1],i.to[0],i.to[1],t,n);s=s.concat(o),i=e.getNextSegment()}}}}break}}return s}_getOffset(t,e,i){return i.roughness*(Math.random()*(e-t)+t)}_affine(t,e,i,n,s,o,r){return[-i*o-n*s+i+o*t+s*e,r*(i*s-n*o)+n+-r*s*t+r*o*e]}_doubleLine(t,e,i,n,s){const o=this._line(t,e,i,n,s,!0,!1),r=this._line(t,e,i,n,s,!0,!0);return o.concat(r)}_line(t,e,n,s,o,r,h){const l=i(t-n,2)+i(e-s,2);let u=o.maxRandomnessOffset||0;u*u*100>l&&(u=a(l)/10);const c=u/2,f=.2+.2*Math.random();let d=o.bowing*o.maxRandomnessOffset*(s-e)/200,p=o.bowing*o.maxRandomnessOffset*(t-n)/200;d=this._getOffset(-d,d,o),p=this._getOffset(-p,p,o);let m=[];return r&&(h?m.push({op:"move",data:[t+this._getOffset(-c,c,o),e+this._getOffset(-c,c,o)]}):m.push({op:"move",data:[t+this._getOffset(-u,u,o),e+this._getOffset(-u,u,o)]})),h?m.push({op:"bcurveTo",data:[d+t+(n-t)*f+this._getOffset(-c,c,o),p+e+(s-e)*f+this._getOffset(-c,c,o),d+t+2*(n-t)*f+this._getOffset(-c,c,o),p+e+2*(s-e)*f+this._getOffset(-c,c,o),n+this._getOffset(-c,c,o),s+this._getOffset(-c,c,o)]}):m.push({op:"bcurveTo",data:[d+t+(n-t)*f+this._getOffset(-u,u,o),p+e+(s-e)*f+this._getOffset(-u,u,o),d+t+2*(n-t)*f+this._getOffset(-u,u,o),p+e+2*(s-e)*f+this._getOffset(-u,u,o),n+this._getOffset(-u,u,o),s+this._getOffset(-u,u,o)]}),m}_curve(t,e,i){const n=t.length;let s=[];if(3<n){const o=[],r=1-i.curveTightness;s.push({op:"move",data:[t[1][0],t[1][1]]});for(let e=1;e+2<n;e++){const i=t[e];o[0]=[i[0],i[1]],o[1]=[i[0]+(r*t[e+1][0]-r*t[e-1][0])/6,i[1]+(r*t[e+1][1]-r*t[e-1][1])/6],o[2]=[t[e+1][0]+(r*t[e][0]-r*t[e+2][0])/6,t[e+1][1]+(r*t[e][1]-r*t[e+2][1])/6],o[3]=[t[e+1][0],t[e+1][1]],s.push({op:"bcurveTo",data:[o[1][0],o[1][1],o[2][0],o[2][1],o[3][0],o[3][1]]})}if(e&&2===e.length){let t=i.maxRandomnessOffset;s.push({ops:"lineTo",data:[e[0]+this._getOffset(-t,t,i),e[1]+ +this._getOffset(-t,t,i)]})}}else 3===n?(s.push({op:"move",data:[t[1][0],t[1][1]]}),s.push({op:"bcurveTo",data:[t[1][0],t[1][1],t[2][0],t[2][1],t[2][0],t[2][1]]})):2===n&&(s=s.concat(this._doubleLine(t[0][0],t[0][1],t[1][0],t[1][1],i)));return s}_ellipse(t,e,i,n,a,h,l,u){const c=this._getOffset(-.5,.5,u)-r/2,f=[];f.push([this._getOffset(-h,h,u)+e+.9*n*s(c-t),this._getOffset(-h,h,u)+i+.9*a*o(c-t)]);for(let l=c;l<2*r+c-.01;l+=t)f.push([this._getOffset(-h,h,u)+e+n*s(l),this._getOffset(-h,h,u)+i+a*o(l)]);return f.push([this._getOffset(-h,h,u)+e+n*s(c+2*r+.5*l),this._getOffset(-h,h,u)+i+a*o(c+2*r+.5*l)]),f.push([this._getOffset(-h,h,u)+e+.98*n*s(c+l),this._getOffset(-h,h,u)+i+.98*a*o(c+l)]),f.push([this._getOffset(-h,h,u)+e+.9*n*s(c+.5*l),this._getOffset(-h,h,u)+i+.9*a*o(c+.5*l)]),this._curve(f,null,u)}_curveWithOffset(t,e,i){const n=[[t[0][0]+this._getOffset(-e,e,i),t[0][1]+this._getOffset(-e,e,i)],[t[0][0]+this._getOffset(-e,e,i),t[0][1]+this._getOffset(-e,e,i)]];for(let s=1;s<t.length;s++)n.push([t[s][0]+this._getOffset(-e,e,i),t[s][1]+this._getOffset(-e,e,i)]),s===t.length-1&&n.push([t[s][0]+this._getOffset(-e,e,i),t[s][1]+this._getOffset(-e,e,i)]);return this._curve(n,null,i)}_arc(t,e,i,n,r,a,h,l,u){const c=a+this._getOffset(-.1,.1,u),f=[];f.push([this._getOffset(-l,l,u)+e+.9*n*s(c-t),this._getOffset(-l,l,u)+i+.9*r*o(c-t)]);for(let a=c;a<=h;a+=t)f.push([this._getOffset(-l,l,u)+e+n*s(a),this._getOffset(-l,l,u)+i+r*o(a)]);return f.push([e+n*s(h),i+r*o(h)]),f.push([e+n*s(h),i+r*o(h)]),this._curve(f,null,u)}_getIntersectingLines(t,e,i){let n=[];for(var s=new f(t[0],t[1],t[2],t[3]),o=0;o<e.length;o++){let t=new f(e[o],i[o],e[(o+1)%e.length],i[(o+1)%e.length]);2==s.compare(t)&&n.push([s.xi,s.yi])}return n}}self._roughScript=self.document&&self.document.currentScript&&self.document.currentScript.src;class x{constructor(t,e){this.config=t||{},this.canvas=e,this.defaultOptions={maxRandomnessOffset:2,roughness:1,bowing:1,stroke:"#000",strokeWidth:1,curveTightness:0,curveStepCount:9,fill:null,fillStyle:"hachure",fillWeight:-1,hachureAngle:-41,hachureGap:-1},this.config.options&&(this.defaultOptions=this._options(this.config.options))}_options(t){return t?Object.assign({},this.defaultOptions,t):this.defaultOptions}_drawable(t,e,i){return{shape:t,sets:e||[],options:i||this.defaultOptions}}get lib(){if(!this._renderer)if(self&&self.workly&&this.config.async&&!this.config.noWorker){Function.prototype.toString;const t=this.config.worklyURL||"https://cdn.jsdelivr.net/gh/pshihn/workly/dist/workly.min.js",e=this.config.roughURL||self._roughScript;if(e&&t){let i=`importScripts('${t}', '${e}');\nworkly.expose(self.rough.createRenderer());`,n=URL.createObjectURL(new Blob([i]));this._renderer=workly.proxy(n)}else this._renderer=new v}else this._renderer=new v;return this._renderer}line(t,e,i,n,s){const o=this._options(s);return this._drawable("line",[this.lib.line(t,e,i,n,o)],o)}rectangle(t,e,i,n,s){const o=this._options(s),r=[];if(o.fill){const s=[t,t+i,t+i,t],a=[e,e,e+n,e+n];"solid"===o.fillStyle?r.push(this.lib.solidFillShape(s,a,o)):r.push(this.lib.hachureFillShape(s,a,o))}return r.push(this.lib.rectangle(t,e,i,n,o)),this._drawable("rectangle",r,o)}ellipse(t,e,i,n,s){const o=this._options(s),r=[];if(o.fill)if("solid"===o.fillStyle){const s=this.lib.ellipse(t,e,i,n,o);s.type="fillPath",r.push(s)}else r.push(this.lib.hachureFillEllipse(t,e,i,n,o));return r.push(this.lib.ellipse(t,e,i,n,o)),this._drawable("ellipse",r,o)}circle(t,e,i,n){let s=this.ellipse(t,e,i,i,n);return s.shape="circle",s}linearPath(t,e){const i=this._options(e);return this._drawable("linearPath",[this.lib.linearPath(t,!1,i)],i)}polygon(t,e){const i=this._options(e),n=[];if(i.fill){let e=[],s=[];for(let i of t)e.push(i[0]),s.push(i[1]);"solid"===i.fillStyle?n.push(this.lib.solidFillShape(e,s,i)):n.push(this.lib.hachureFillShape(e,s,i))}return n.push(this.lib.linearPath(t,!0,i)),this._drawable("polygon",n,i)}arc(t,e,i,n,s,o,r,a){const h=this._options(a),l=[];if(r&&h.fill)if("solid"===h.fillStyle){let r=this.lib.arc(t,e,i,n,s,o,!0,!1,h);r.type="fillPath",l.push(r)}else l.push(this.lib.hachureFillArc(t,e,i,n,s,o,h));return l.push(this.lib.arc(t,e,i,n,s,o,r,!0,h)),this._drawable("arc",l,h)}curve(t,e){const i=this._options(e);return this._drawable("curve",[this.lib.curve(t,i)],i)}path(t,e){const i=this._options(e),n=[];if(!t)return this._drawable("path",n,i);if(i.fill)if("solid"===i.fillStyle)n.push({type:"path2Dfill",path:t});else{const e=this._computePathSize(t);let s=[0,e[0],e[0],0],o=[0,0,e[1],e[1]],r=this.lib.hachureFillShape(s,o,i);r.type="path2Dpattern",r.size=e,r.path=t,n.push(r)}return n.push(this.lib.svgPath(t,i)),this._drawable("path",n,i)}toPaths(e){const i=e.sets||[],n=e.options||this.defaultOptions,s=[];for(const e of i){let i=null;switch(e.type){case"path":i={d:this.opsToPath(e),stroke:n.stroke,strokeWidth:n.strokeWidth,fill:"none"};break;case"fillPath":i={d:this.opsToPath(e),stroke:"none",strokeWidth:0,fill:n.fill};break;case"fillSketch":i=this._fillSketch(e,n);break;case"path2Dfill":i={d:e.path,stroke:"none",strokeWidth:0,fill:n.fill};break;case"path2Dpattern":{const s=e.size,o={x:0,y:0,width:1,height:1,viewBox:`0 0 ${t(s[0])} ${t(s[1])}`,patternUnits:"objectBoundingBox",path:this._fillSketch(e,n)};i={d:e.path,stroke:"none",strokeWidth:0,pattern:o};break}}i&&s.push(i)}return s}_fillSketch(t,e){let i=e.fillWeight;return 0>i&&(i=e.strokeWidth/2),{d:this.opsToPath(t),stroke:e.fill,strokeWidth:i,fill:"none"}}opsToPath(t){let e="";for(let i of t.ops){const t=i.data;switch(i.op){case"move":e+=`M${t[0]} ${t[1]} `;break;case"bcurveTo":e+=`C${t[0]} ${t[1]}, ${t[2]} ${t[3]}, ${t[4]} ${t[5]} `;break;case"qcurveTo":e+=`Q${t[0]} ${t[1]}, ${t[2]} ${t[3]} `;break;case"lineTo":e+=`L${t[0]} ${t[1]} `}}return e.trim()}_computePathSize(t){let e=[0,0];if(self.document)try{const i="http://www.w3.org/2000/svg";let n=self.document.createElementNS(i,"svg");n.setAttribute("width","0"),n.setAttribute("height","0");let s=self.document.createElementNS(i,"path");s.setAttribute("d",t),n.appendChild(s),self.document.body.appendChild(n);let o=s.getBBox();o&&(e[0]=o.width||0,e[1]=o.height||0),self.document.body.removeChild(n)}catch(t){}const i=this._canvasSize();return e[0]*e[1]||(e=i),e[0]=l(e[0],i[0]),e[1]=l(e[1],i[1]),e}_canvasSize(){const t=t=>t&&"object"==typeof t&&t.baseVal&&t.baseVal.value?t.baseVal.value:t||100;return this.canvas?[t(this.canvas.width),t(this.canvas.height)]:[100,100]}}class w extends x{async line(t,e,i,n,s){const o=this._options(s);return this._drawable("line",[await this.lib.line(t,e,i,n,o)],o)}async rectangle(t,e,i,n,s){const o=this._options(s),r=[];if(o.fill){const s=[t,t+i,t+i,t],a=[e,e,e+n,e+n];"solid"===o.fillStyle?r.push(await this.lib.solidFillShape(s,a,o)):r.push(await this.lib.hachureFillShape(s,a,o))}return r.push(await this.lib.rectangle(t,e,i,n,o)),this._drawable("rectangle",r,o)}async ellipse(t,e,i,n,s){const o=this._options(s),r=[];if(o.fill)if("solid"===o.fillStyle){const s=await this.lib.ellipse(t,e,i,n,o);s.type="fillPath",r.push(s)}else r.push(await this.lib.hachureFillEllipse(t,e,i,n,o));return r.push(await this.lib.ellipse(t,e,i,n,o)),this._drawable("ellipse",r,o)}async circle(t,e,i,n){let s=await this.ellipse(t,e,i,i,n);return s.shape="circle",s}async linearPath(t,e){const i=this._options(e);return this._drawable("linearPath",[await this.lib.linearPath(t,!1,i)],i)}async polygon(t,e){const i=this._options(e),n=[];if(i.fill){let e=[],s=[];for(let i of t)e.push(i[0]),s.push(i[1]);"solid"===i.fillStyle?n.push(await this.lib.solidFillShape(e,s,i)):n.push(await this.lib.hachureFillShape(e,s,i))}return n.push(await this.lib.linearPath(t,!0,i)),this._drawable("polygon",n,i)}async arc(t,e,i,n,s,o,r,a){const h=this._options(a),l=[];if(r&&h.fill)if("solid"===h.fillStyle){let r=await this.lib.arc(t,e,i,n,s,o,!0,!1,h);r.type="fillPath",l.push(r)}else l.push(await this.lib.hachureFillArc(t,e,i,n,s,o,h));return l.push(await this.lib.arc(t,e,i,n,s,o,r,!0,h)),this._drawable("arc",l,h)}async curve(t,e){const i=this._options(e);return this._drawable("curve",[await this.lib.curve(t,i)],i)}async path(t,e){const i=this._options(e),n=[];if(!t)return this._drawable("path",n,i);if(i.fill)if("solid"===i.fillStyle)n.push({type:"path2Dfill",path:t});else{const e=this._computePathSize(t);let s=[0,e[0],e[0],0],o=[0,0,e[1],e[1]],r=await this.lib.hachureFillShape(s,o,i);r.type="path2Dpattern",r.size=e,r.path=t,n.push(r)}return n.push(await this.lib.svgPath(t,i)),this._drawable("path",n,i)}}class b{constructor(t,e){this.canvas=t,this.ctx=this.canvas.getContext("2d"),this._init(e)}_init(t){this.gen=new x(t,this.canvas)}get generator(){return this.gen}static createRenderer(){return new v}line(t,e,i,n,s){let o=this.gen.line(t,e,i,n,s);return this.draw(o),o}rectangle(t,e,i,n,s){let o=this.gen.rectangle(t,e,i,n,s);return this.draw(o),o}ellipse(t,e,i,n,s){let o=this.gen.ellipse(t,e,i,n,s);return this.draw(o),o}circle(t,e,i,n){let s=this.gen.circle(t,e,i,n);return this.draw(s),s}linearPath(t,e){let i=this.gen.linearPath(t,e);return this.draw(i),i}polygon(t,e){let i=this.gen.polygon(t,e);return this.draw(i),i}arc(t,e,i,n,s,o,r,a){let h=this.gen.arc(t,e,i,n,s,o,r,a);return this.draw(h),h}curve(t,e){let i=this.gen.curve(t,e);return this.draw(i),i}path(t,e){let i=this.gen.path(t,e);return this.draw(i),i}draw(t){let e=t.sets||[],i=t.options||this.gen.defaultOptions,n=this.ctx;for(let t of e)switch(t.type){case"path":n.save(),n.strokeStyle=i.stroke,n.lineWidth=i.strokeWidth,this._drawToContext(n,t),n.restore();break;case"fillPath":n.save(),n.fillStyle=i.fill,this._drawToContext(n,t,i),n.restore();break;case"fillSketch":this._fillSketch(n,t,i);break;case"path2Dfill":{this.ctx.save(),this.ctx.fillStyle=i.fill;let e=new Path2D(t.path);this.ctx.fill(e),this.ctx.restore();break}case"path2Dpattern":{let e=t.size;const n=document.createElement("canvas"),s=n.getContext("2d");let o=this._computeBBox(t.path);o&&(o.width||o.height)?(n.width=this.canvas.width,n.height=this.canvas.height,s.translate(o.x||0,o.y||0)):(n.width=e[0],n.height=e[1]),this._fillSketch(s,t,i),this.ctx.save(),this.ctx.fillStyle=this.ctx.createPattern(n,"repeat");let r=new Path2D(t.path);this.ctx.fill(r),this.ctx.restore();break}}}_computeBBox(t){if(self.document)try{const e="http://www.w3.org/2000/svg";let i=self.document.createElementNS(e,"svg");i.setAttribute("width","0"),i.setAttribute("height","0");let n=self.document.createElementNS(e,"path");n.setAttribute("d",t),i.appendChild(n),self.document.body.appendChild(i);let s=n.getBBox();return self.document.body.removeChild(i),s}catch(t){}return null}_fillSketch(t,e,i){let n=i.fillWeight;0>n&&(n=i.strokeWidth/2),t.save(),t.strokeStyle=i.fill,t.lineWidth=n,this._drawToContext(t,e),t.restore()}_drawToContext(t,e){t.beginPath();for(let i of e.ops){const e=i.data;switch(i.op){case"move":t.moveTo(e[0],e[1]);break;case"bcurveTo":t.bezierCurveTo(e[0],e[1],e[2],e[3],e[4],e[5]);break;case"qcurveTo":t.quadraticCurveTo(e[0],e[1],e[2],e[3]);break;case"lineTo":t.lineTo(e[0],e[1])}}"fillPath"===e.type?t.fill():t.stroke()}}class P{constructor(t,e){this.svg=t,this._init(e)}_init(t){this.gen=new x(t,this.svg)}get generator(){return this.gen}get defs(){if(!this._defs){let t=(this.svg.ownerDocument||document).createElementNS("http://www.w3.org/2000/svg","defs");this.svg.firstChild?this.svg.insertBefore(t,this.svg.firstChild):this.svg.appendChild(t),this._defs=t}return this._defs}line(t,e,i,n,s){let o=this.gen.line(t,e,i,n,s);return this.draw(o)}rectangle(t,e,i,n,s){let o=this.gen.rectangle(t,e,i,n,s);return this.draw(o)}ellipse(t,e,i,n,s){let o=this.gen.ellipse(t,e,i,n,s);return this.draw(o)}circle(t,e,i,n){let s=this.gen.circle(t,e,i,n);return this.draw(s)}linearPath(t,e){let i=this.gen.linearPath(t,e);return this.draw(i)}polygon(t,e){let i=this.gen.polygon(t,e);return this.draw(i)}arc(t,e,i,n,s,o,r,a){let h=this.gen.arc(t,e,i,n,s,o,r,a);return this.draw(h)}curve(t,e){let i=this.gen.curve(t,e);return this.draw(i)}path(t,e){let i=this.gen.path(t,e);return this.draw(i)}draw(e){let i=e.sets||[],s=e.options||this.gen.defaultOptions,o=this.svg.ownerDocument||document,r=o.createElementNS("http://www.w3.org/2000/svg","g");for(let e of i){let i=null;switch(e.type){case"path":(i=o.createElementNS("http://www.w3.org/2000/svg","path")).setAttribute("d",this._opsToPath(e)),i.style.stroke=s.stroke,i.style.strokeWidth=s.strokeWidth,i.style.fill="none";break;case"fillPath":(i=o.createElementNS("http://www.w3.org/2000/svg","path")).setAttribute("d",this._opsToPath(e)),i.style.stroke="none",i.style.strokeWidth=0,i.style.fill=s.fill;break;case"fillSketch":i=this._fillSketch(o,e,s);break;case"path2Dfill":(i=o.createElementNS("http://www.w3.org/2000/svg","path")).setAttribute("d",e.path),i.style.stroke="none",i.style.strokeWidth=0,i.style.fill=s.fill;break;case"path2Dpattern":{const r=e.size,a=o.createElementNS("http://www.w3.org/2000/svg","pattern"),h=`rough-${n(Math.random()*(Number.MAX_SAFE_INTEGER||999999))}`;a.setAttribute("id",h),a.setAttribute("x",0),a.setAttribute("y",0),a.setAttribute("width",1),a.setAttribute("height",1),a.setAttribute("height",1),a.setAttribute("viewBox",`0 0 ${t(r[0])} ${t(r[1])}`),a.setAttribute("patternUnits","objectBoundingBox");const l=this._fillSketch(o,e,s);a.appendChild(l),this.defs.appendChild(a),(i=o.createElementNS("http://www.w3.org/2000/svg","path")).setAttribute("d",e.path),i.style.stroke="none",i.style.strokeWidth=0,i.style.fill=`url(#${h})`;break}}i&&r.appendChild(i)}return r}_fillSketch(t,e,i){let n=i.fillWeight;0>n&&(n=i.strokeWidth/2);let s=t.createElementNS("http://www.w3.org/2000/svg","path");return s.setAttribute("d",this._opsToPath(e)),s.style.stroke=i.fill,s.style.strokeWidth=n,s.style.fill="none",s}_opsToPath(t){return this.gen.opsToPath(t)}}return{canvas:(t,e)=>e&&e.async?new class extends b{_init(t){this.gen=new w(t,this.canvas)}async line(t,e,i,n,s){let o=await this.gen.line(t,e,i,n,s);return this.draw(o),o}async rectangle(t,e,i,n,s){let o=await this.gen.rectangle(t,e,i,n,s);return this.draw(o),o}async ellipse(t,e,i,n,s){let o=await this.gen.ellipse(t,e,i,n,s);return this.draw(o),o}async circle(t,e,i,n){let s=await this.gen.circle(t,e,i,n);return this.draw(s),s}async linearPath(t,e){let i=await this.gen.linearPath(t,e);return this.draw(i),i}async polygon(t,e){let i=await this.gen.polygon(t,e);return this.draw(i),i}async arc(t,e,i,n,s,o,r,a){let h=await this.gen.arc(t,e,i,n,s,o,r,a);return this.draw(h),h}async curve(t,e){let i=await this.gen.curve(t,e);return this.draw(i),i}async path(t,e){let i=await this.gen.path(t,e);return this.draw(i),i}}(t,e):new b(t,e),svg:(t,e)=>e&&e.async?new class extends P{_init(t){this.gen=new w(t,this.svg)}async line(t,e,i,n,s){let o=await this.gen.line(t,e,i,n,s);return this.draw(o)}async rectangle(t,e,i,n,s){let o=await this.gen.rectangle(t,e,i,n,s);return this.draw(o)}async ellipse(t,e,i,n,s){let o=await this.gen.ellipse(t,e,i,n,s);return this.draw(o)}async circle(t,e,i,n){let s=await this.gen.circle(t,e,i,n);return this.draw(s)}async linearPath(t,e){let i=await this.gen.linearPath(t,e);return this.draw(i)}async polygon(t,e){let i=await this.gen.polygon(t,e);return this.draw(i)}async arc(t,e,i,n,s,o,r,a){let h=await this.gen.arc(t,e,i,n,s,o,r,a);return this.draw(h)}async curve(t,e){let i=await this.gen.curve(t,e);return this.draw(i)}async path(t,e){let i=await this.gen.path(t,e);return this.draw(i)}}(t,e):new P(t,e),createRenderer:()=>b.createRenderer(),generator:(t,e)=>t&&t.async?new w(t,e):new x(t,e)}}();!function(t,e){"function"==typeof define&&define.amd?define([],e):"object"==typeof module&&"undefined"!=typeof exports?module.exports=e():t.Papa=e()}(this,function(){"use strict";function t(t){this._handle=null,this._paused=!1,this._finished=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},function(t){var e=u(t);e.chunkSize=parseInt(e.chunkSize),t.step||t.chunk||(e.chunkSize=null),this._handle=new o(e),this._handle.streamer=this,this._config=e}.call(this,t),this.parseChunk=function(t){if(this.isFirstChunk&&f(this._config.beforeFirstChunk)){var e=this._config.beforeFirstChunk(t);void 0!==e&&(t=e)}this.isFirstChunk=!1;var i=this._partialLine+t;this._partialLine="";var n=this._handle.parse(i,this._baseIndex,!this._finished);if(!this._handle.paused()&&!this._handle.aborted()){var s=n.meta.cursor;this._finished||(this._partialLine=i.substring(s-this._baseIndex),this._baseIndex=s),n&&n.data&&(this._rowCount+=n.data.length);var o=this._finished||this._config.preview&&this._rowCount>=this._config.preview;if(_)p.postMessage({results:n,workerId:x.WORKER_ID,finished:o});else if(f(this._config.chunk)){if(this._config.chunk(n,this._handle),this._paused)return;n=void 0,this._completeResults=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(n.data),this._completeResults.errors=this._completeResults.errors.concat(n.errors),this._completeResults.meta=n.meta),!o||!f(this._config.complete)||n&&n.meta.aborted||this._config.complete(this._completeResults,this._input),o||n&&n.meta.paused||this._nextChunk(),n}},this._sendError=function(t){f(this._config.error)?this._config.error(t):_&&this._config.error&&p.postMessage({workerId:x.WORKER_ID,error:t,finished:!1})}}function e(e){var i;(e=e||{}).chunkSize||(e.chunkSize=x.RemoteChunkSize),t.call(this,e),this._nextChunk=m?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(t){this._input=t,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(i=new XMLHttpRequest,this._config.withCredentials&&(i.withCredentials=this._config.withCredentials),m||(i.onload=c(this._chunkLoaded,this),i.onerror=c(this._chunkError,this)),i.open("GET",this._input,!m),this._config.downloadRequestHeaders){var t=this._config.downloadRequestHeaders;for(var e in t)i.setRequestHeader(e,t[e])}if(this._config.chunkSize){var n=this._start+this._config.chunkSize-1;i.setRequestHeader("Range","bytes="+this._start+"-"+n),i.setRequestHeader("If-None-Match","webkit-no-cache")}try{i.send()}catch(t){this._chunkError(t.message)}m&&0===i.status?this._chunkError():this._start+=this._config.chunkSize}},this._chunkLoaded=function(){if(4==i.readyState){if(i.status<200||i.status>=400)return void this._chunkError();this._finished=!this._config.chunkSize||this._start>function(t){var e=t.getResponseHeader("Content-Range");return null===e?-1:parseInt(e.substr(e.lastIndexOf("/")+1))}(i),this.parseChunk(i.responseText)}},this._chunkError=function(t){var e=i.statusText||t;this._sendError(e)}}function i(e){(e=e||{}).chunkSize||(e.chunkSize=x.LocalChunkSize),t.call(this,e);var i,n,s="undefined"!=typeof FileReader;this.stream=function(t){this._input=t,n=t.slice||t.webkitSlice||t.mozSlice,s?((i=new FileReader).onload=c(this._chunkLoaded,this),i.onerror=c(this._chunkError,this)):i=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var t=this._input;if(this._config.chunkSize){var e=Math.min(this._start+this._config.chunkSize,this._input.size);t=n.call(t,this._start,e)}var o=i.readAsText(t,this._config.encoding);s||this._chunkLoaded({target:{result:o}})},this._chunkLoaded=function(t){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(t.target.result)},this._chunkError=function(){this._sendError(i.error.message)}}function n(e){var i;e=e||{},t.call(this,e),this.stream=function(t){return t,i=t,this._nextChunk()},this._nextChunk=function(){if(!this._finished){var t=this._config.chunkSize,e=t?i.substr(0,t):i;return i=t?i.substr(t):"",this._finished=!i,this.parseChunk(e)}}}function s(e){e=e||{},t.call(this,e);var i=[],n=!0;this.stream=function(t){this._input=t,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._nextChunk=function(){i.length?this.parseChunk(i.shift()):n=!0},this._streamData=c(function(t){try{i.push("string"==typeof t?t:t.toString(this._config.encoding)),n&&(n=!1,this.parseChunk(i.shift()))}catch(t){this._streamError(t)}},this),this._streamError=c(function(t){this._streamCleanUp(),this._sendError(t.message)},this),this._streamEnd=c(function(){this._streamCleanUp(),this._finished=!0,this._streamData("")},this),this._streamCleanUp=c(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function o(t){function e(){if(y&&l&&(o("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+x.DefaultDelimiter+"'"),l=!1),t.skipEmptyLines)for(var e=0;e<y.data.length;e++)1===y.data[e].length&&""===y.data[e][0]&&y.data.splice(e--,1);return i()&&function(){if(y){for(var t=0;i()&&t<y.data.length;t++)for(var e=0;e<y.data[t].length;e++)g.push(y.data[t][e]);y.data.splice(0,1)}}(),function(){if(!y||!t.header&&!t.dynamicTyping)return y;for(var e=0;e<y.data.length;e++){for(var i=t.header?{}:[],n=0;n<y.data[e].length;n++){var r=n,a=y.data[e][n];t.header&&(r=n>=g.length?"__parsed_extra":g[n]),a=s(r,a),"__parsed_extra"===r?(i[r]=i[r]||[],i[r].push(a)):i[r]=a}y.data[e]=i,t.header&&(n>g.length?o("FieldMismatch","TooManyFields","Too many fields: expected "+g.length+" fields but parsed "+n,e):n<g.length&&o("FieldMismatch","TooFewFields","Too few fields: expected "+g.length+" fields but parsed "+n,e))}return t.header&&y.meta&&(y.meta.fields=g),y}()}function i(){return t.header&&0===g.length}function n(e){return t.dynamicTypingFunction&&void 0===t.dynamicTyping[e]&&(t.dynamicTyping[e]=t.dynamicTypingFunction(e)),!0===(t.dynamicTyping[e]||t.dynamicTyping)}function s(t,e){return n(t)?"true"===e||"TRUE"===e||"false"!==e&&"FALSE"!==e&&function(t){return c.test(t)?parseFloat(t):t}(e):e}function o(t,e,i,n){y.errors.push({type:t,code:e,message:i,row:n})}var a,h,l,c=/^\s*-?(\d*\.?\d+|\d+\.?\d*)(e[-+]?\d+)?\s*$/i,d=this,p=0,m=!1,_=!1,g=[],y={data:[],errors:[],meta:{}};if(f(t.step)){var v=t.step;t.step=function(n){if(y=n,i())e();else{if(e(),0===y.data.length)return;p+=n.data.length,t.preview&&p>t.preview?h.abort():v(y,d)}}}this.parse=function(i,n,s){if(t.newline||(t.newline=function(t){var e=(t=t.substr(0,1048576)).split("\r"),i=t.split("\n"),n=i.length>1&&i[0].length<e[0].length;if(1===e.length||n)return"\n";for(var s=0,o=0;o<e.length;o++)"\n"===e[o][0]&&s++;return s>=e.length/2?"\r\n":"\r"}(i)),l=!1,t.delimiter)f(t.delimiter)&&(t.delimiter=t.delimiter(i),y.meta.delimiter=t.delimiter);else{var o=function(e,i,n){for(var s,o,a,h=[",","\t","|",";",x.RECORD_SEP,x.UNIT_SEP],l=0;l<h.length;l++){var u=h[l],c=0,f=0,d=0;a=void 0;for(var p=new r({delimiter:u,newline:i,preview:10}).parse(e),m=0;m<p.data.length;m++)if(n&&1===p.data[m].length&&0===p.data[m][0].length)d++;else{var _=p.data[m].length;f+=_,void 0!==a?_>1&&(c+=Math.abs(_-a),a=_):a=_}p.data.length>0&&(f/=p.data.length-d),(void 0===o||c<o)&&f>1.99&&(o=c,s=u)}return t.delimiter=s,{successful:!!s,bestDelimiter:s}}(i,t.newline,t.skipEmptyLines);o.successful?t.delimiter=o.bestDelimiter:(l=!0,t.delimiter=x.DefaultDelimiter),y.meta.delimiter=t.delimiter}var c=u(t);return t.preview&&t.header&&c.preview++,a=i,h=new r(c),y=h.parse(a,n,s),e(),m?{meta:{paused:!0}}:y||{meta:{paused:!1}}},this.paused=function(){return m},this.pause=function(){m=!0,h.abort(),a=a.substr(h.getCharIndex())},this.resume=function(){m=!1,d.streamer.parseChunk(a)},this.aborted=function(){return _},this.abort=function(){_=!0,h.abort(),y.meta.aborted=!0,f(t.complete)&&t.complete(y),a=""}}function r(t){var e=(t=t||{}).delimiter,i=t.newline,n=t.comments,s=t.step,o=t.preview,r=t.fastMode;if(void 0===t.quoteChar)var a='"';else a=t.quoteChar;if(("string"!=typeof e||x.BAD_DELIMITERS.indexOf(e)>-1)&&(e=","),n===e)throw"Comment character same as delimiter";!0===n?n="#":("string"!=typeof n||x.BAD_DELIMITERS.indexOf(n)>-1)&&(n=!1),"\n"!=i&&"\r"!=i&&"\r\n"!=i&&(i="\n");var h=0,l=!1;this.parse=function(t,u,c){function d(t){P.push(t),S=h}function p(e){return c?_():(void 0===e&&(e=t.substr(h)),T.push(e),h=y,d(T),b&&g(),_())}function m(e){h=e,d(T),T=[],C=t.indexOf(i,h)}function _(t){return{data:P,errors:M,meta:{delimiter:e,linebreak:i,aborted:l,truncated:!!t,cursor:S+(u||0)}}}function g(){s(_()),P=[],M=[]}if("string"!=typeof t)throw"Input must be a string";var y=t.length,v=e.length,x=i.length,w=n.length,b=f(s);h=0;var P=[],M=[],T=[],S=0;if(!t)return _();if(r||!1!==r&&-1===t.indexOf(a)){for(var L=t.split(i),k=0;k<L.length;k++){T=L[k];if(h+=T.length,k!==L.length-1)h+=i.length;else if(c)return _();if(!n||T.substr(0,w)!==n){if(b){if(P=[],d(T.split(e)),g(),l)return _()}else d(T.split(e));if(o&&k>=o)return P=P.slice(0,o),_(!0)}}return _()}for(var E=t.indexOf(e,h),C=t.indexOf(i,h),A=new RegExp(a+a,"g");;)if(t[h]!==a)if(n&&0===T.length&&t.substr(h,w)===n){if(-1===C)return _();h=C+x,C=t.indexOf(i,h),E=t.indexOf(e,h)}else if(-1!==E&&(E<C||-1===C))T.push(t.substring(h,E)),h=E+v,E=t.indexOf(e,h);else{if(-1===C)break;if(T.push(t.substring(h,C)),m(C+x),b&&(g(),l))return _();if(o&&P.length>=o)return _(!0)}else{var O=h;for(h++;;){if(-1===(O=t.indexOf(a,O+1)))return c||M.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:P.length,index:h}),p();if(O===y-1)return p(t.substring(h,O).replace(A,a));if(t[O+1]!==a){if(t[O+1]===e){T.push(t.substring(h,O).replace(A,a)),h=O+1+v,E=t.indexOf(e,h),C=t.indexOf(i,h);break}if(t.substr(O+1,x)===i){if(T.push(t.substring(h,O).replace(A,a)),m(O+1+x),E=t.indexOf(e,h),b&&(g(),l))return _();if(o&&P.length>=o)return _(!0);break}M.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:P.length,index:h}),O++}else O++}}return p()},this.abort=function(){l=!0},this.getCharIndex=function(){return h}}function a(t){var e=t.data,i=y[e.workerId],n=!1;if(e.error)i.userError(e.error,e.file);else if(e.results&&e.results.data){var s={abort:function(){n=!0,h(e.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:l,resume:l};if(f(i.userStep)){for(var o=0;o<e.results.data.length&&(i.userStep({data:[e.results.data[o]],errors:e.results.errors,meta:e.results.meta},s),!n);o++);delete e.results}else f(i.userChunk)&&(i.userChunk(e.results,s,e.file),delete e.results)}e.finished&&!n&&h(e.workerId,e.results)}function h(t,e){var i=y[t];f(i.userComplete)&&i.userComplete(e),i.terminate(),delete y[t]}function l(){throw"Not implemented."}function u(t){if("object"!=typeof t)return t;var e=t instanceof Array?[]:{};for(var i in t)e[i]=u(t[i]);return e}function c(t,e){return function(){t.apply(e,arguments)}}function f(t){return"function"==typeof t}var d,p="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==p?p:{},m=!p.document&&!!p.postMessage,_=m&&/(\?|&)papaworker(=|&|$)/.test(p.location.search),g=!1,y={},v=0,x={};if(x.parse=function(t,o){var r=(o=o||{}).dynamicTyping||!1;if(f(r)&&(o.dynamicTypingFunction=r,r={}),o.dynamicTyping=r,o.worker&&x.WORKERS_SUPPORTED){var h=function(){if(!x.WORKERS_SUPPORTED)return!1;if(!g&&null===x.SCRIPT_PATH)throw new Error("Script path cannot be determined automatically when Papa Parse is loaded asynchronously. You need to set Papa.SCRIPT_PATH manually.");var t=x.SCRIPT_PATH||d;t+=(-1!==t.indexOf("?")?"&":"?")+"papaworker";var e=new p.Worker(t);return e.onmessage=a,e.id=v++,y[e.id]=e,e}();return h.userStep=o.step,h.userChunk=o.chunk,h.userComplete=o.complete,h.userError=o.error,o.step=f(o.step),o.chunk=f(o.chunk),o.complete=f(o.complete),o.error=f(o.error),delete o.worker,void h.postMessage({input:t,config:o,workerId:h.id})}var l=null;return"string"==typeof t?l=o.download?new e(o):new n(o):!0===t.readable&&f(t.read)&&f(t.on)?l=new s(o):(p.File&&t instanceof File||t instanceof Object)&&(l=new i(o)),l.stream(t)},x.unparse=function(t,e){function i(t){if("object"!=typeof t)return[];var e=[];for(var i in t)e.push(i);return e}function n(t,e){var i="";"string"==typeof t&&(t=JSON.parse(t)),"string"==typeof e&&(e=JSON.parse(e));var n=t instanceof Array&&t.length>0,o=!(e[0]instanceof Array);if(n&&r){for(var l=0;l<t.length;l++)l>0&&(i+=a),i+=s(t[l],l);e.length>0&&(i+=h)}for(var u=0;u<e.length;u++){for(var c=n?t.length:e[u].length,f=0;f<c;f++){f>0&&(i+=a);var d=n&&o?t[f]:f;i+=s(e[u][d],f)}u<e.length-1&&(i+=h)}return i}function s(t,e){return void 0===t||null===t?"":(t=t.toString().replace(u,l+l),"boolean"==typeof o&&o||o instanceof Array&&o[e]||function(t,e){for(var i=0;i<e.length;i++)if(t.indexOf(e[i])>-1)return!0;return!1}(t,x.BAD_DELIMITERS)||t.indexOf(a)>-1||" "===t.charAt(0)||" "===t.charAt(t.length-1)?l+t+l:t)}var o=!1,r=!0,a=",",h="\r\n",l='"';"object"==typeof e&&("string"==typeof e.delimiter&&1===e.delimiter.length&&-1===x.BAD_DELIMITERS.indexOf(e.delimiter)&&(a=e.delimiter),("boolean"==typeof e.quotes||e.quotes instanceof Array)&&(o=e.quotes),"string"==typeof e.newline&&(h=e.newline),"string"==typeof e.quoteChar&&(l=e.quoteChar),"boolean"==typeof e.header&&(r=e.header));var u=new RegExp(l,"g");if("string"==typeof t&&(t=JSON.parse(t)),t instanceof Array){if(!t.length||t[0]instanceof Array)return n(null,t);if("object"==typeof t[0])return n(i(t[0]),t)}else if("object"==typeof t)return"string"==typeof t.data&&(t.data=JSON.parse(t.data)),t.data instanceof Array&&(t.fields||(t.fields=t.meta&&t.meta.fields),t.fields||(t.fields=t.data[0]instanceof Array?t.fields:i(t.data[0])),t.data[0]instanceof Array||"object"==typeof t.data[0]||(t.data=[t.data])),n(t.fields||[],t.data||[]);throw"exception: Unable to serialize unrecognized input"},x.RECORD_SEP=String.fromCharCode(30),x.UNIT_SEP=String.fromCharCode(31),x.BYTE_ORDER_MARK="\ufeff",x.BAD_DELIMITERS=["\r","\n",'"',x.BYTE_ORDER_MARK],x.WORKERS_SUPPORTED=!m&&!!p.Worker,x.SCRIPT_PATH=null,x.LocalChunkSize=10485760,x.RemoteChunkSize=5242880,x.DefaultDelimiter=",",x.Parser=r,x.ParserHandle=o,x.NetworkStreamer=e,x.FileStreamer=i,x.StringStreamer=n,x.ReadableStreamStreamer=s,p.jQuery){var w=p.jQuery;w.fn.parse=function(t){function e(){if(0!==s.length){var e=s[0];if(f(t.before)){var n=t.before(e.file,e.inputElem);if("object"==typeof n){if("abort"===n.action)return void function(e,i,n,s){f(t.error)&&t.error({name:e},i,n,s)}("AbortError",e.file,e.inputElem,n.reason);if("skip"===n.action)return void i();"object"==typeof n.config&&(e.instanceConfig=w.extend(e.instanceConfig,n.config))}else if("skip"===n)return void i()}var o=e.instanceConfig.complete;e.instanceConfig.complete=function(t){f(o)&&o(t,e.file,e.inputElem),i()},x.parse(e.file,e.instanceConfig)}else f(t.complete)&&t.complete()}function i(){s.splice(0,1),e()}var n=t.config||{},s=[];return this.each(function(t){if(!("INPUT"===w(this).prop("tagName").toUpperCase()&&"file"===w(this).attr("type").toLowerCase()&&p.FileReader)||!this.files||0===this.files.length)return!0;for(var e=0;e<this.files.length;e++)s.push({file:this.files[e],inputElem:this,instanceConfig:w.extend({},n)})}),e(),this}}return _?p.onmessage=function(t){var e=t.data;if(void 0===x.WORKER_ID&&e&&(x.WORKER_ID=e.workerId),"string"==typeof e.input)p.postMessage({workerId:x.WORKER_ID,results:x.parse(e.input,e.config),finished:!0});else if(p.File&&e.input instanceof File||e.input instanceof Object){var i=x.parse(e.input,e.config);i&&p.postMessage({workerId:x.WORKER_ID,results:i,finished:!0})}}:x.WORKERS_SUPPORTED&&(d=function(){var t=document.getElementsByTagName("script");return t.length?t[t.length-1].src:""}(),document.body?document.addEventListener("DOMContentLoaded",function(){g=!0},!0):g=!0),e.prototype=Object.create(t.prototype),e.prototype.constructor=e,i.prototype=Object.create(t.prototype),i.prototype.constructor=i,n.prototype=Object.create(n.prototype),n.prototype.constructor=n,s.prototype=Object.create(t.prototype),s.prototype.constructor=s,x}),function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.CircleType=e():t.CircleType=e()}("undefined"!=typeof self?self:this,function(){return function(t){function e(n){if(i[n])return i[n].exports;var s=i[n]={i:n,l:!1,exports:{}};return t[n].call(s.exports,s,s.exports,e),s.l=!0,s.exports}var i={};return e.m=t,e.c=i,e.d=function(t,i,n){e.o(t,i)||Object.defineProperty(t,i,{configurable:!1,enumerable:!0,get:n})},e.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(i,"a",i),i},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=29)}([function(t,e,i){var n=i(24)("wks"),s=i(12),o=i(1).Symbol,r="function"==typeof o;(t.exports=function(t){return n[t]||(n[t]=r&&o[t]||(r?o:s)("Symbol."+t))}).store=n},function(t,e){var i=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=i)},function(t,e){var i=t.exports={version:"2.5.6"};"number"==typeof __e&&(__e=i)},function(t,e,i){var n=i(4),s=i(11);t.exports=i(6)?function(t,e,i){return n.f(t,e,s(1,i))}:function(t,e,i){return t[e]=i,t}},function(t,e,i){var n=i(5),s=i(34),o=i(35),r=Object.defineProperty;e.f=i(6)?Object.defineProperty:function(t,e,i){if(n(t),e=o(e,!0),n(i),s)try{return r(t,e,i)}catch(t){}if("get"in i||"set"in i)throw TypeError("Accessors not supported!");return"value"in i&&(t[e]=i.value),t}},function(t,e,i){var n=i(10);t.exports=function(t){if(!n(t))throw TypeError(t+" is not an object!");return t}},function(t,e,i){t.exports=!i(17)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(t,e){var i={}.hasOwnProperty;t.exports=function(t,e){return i.call(t,e)}},function(t,e){var i=Math.ceil,n=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?n:i)(t)}},function(t,e){t.exports=function(t){if(void 0==t)throw TypeError("Can't call method on  "+t);return t}},function(t,e){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},function(t,e){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},function(t,e){var i=0,n=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++i+n).toString(36))}},function(t,e){t.exports={}},function(t,e,i){var n=i(24)("keys"),s=i(12);t.exports=function(t){return n[t]||(n[t]=s(t))}},function(t,e){t.exports=!1},function(t,e,i){var n=i(1),s=i(2),o=i(3),r=i(19),a=i(20),h=function(t,e,i){var l,u,c,f,d=t&h.F,p=t&h.G,m=t&h.S,_=t&h.P,g=t&h.B,y=p?n:m?n[e]||(n[e]={}):(n[e]||{}).prototype,v=p?s:s[e]||(s[e]={}),x=v.prototype||(v.prototype={});for(l in p&&(i=e),i)c=((u=!d&&y&&void 0!==y[l])?y:i)[l],f=g&&u?a(c,n):_&&"function"==typeof c?a(Function.call,c):c,y&&r(y,l,c,t&h.U),v[l]!=c&&o(v,l,f),_&&x[l]!=c&&(x[l]=c)};n.core=s,h.F=1,h.G=2,h.S=4,h.P=8,h.B=16,h.W=32,h.U=64,h.R=128,t.exports=h},function(t,e){t.exports=function(t){try{return!!t()}catch(t){return!0}}},function(t,e,i){var n=i(10),s=i(1).document,o=n(s)&&n(s.createElement);t.exports=function(t){return o?s.createElement(t):{}}},function(t,e,i){var n=i(1),s=i(3),o=i(7),r=i(12)("src"),a=Function.toString,h=(""+a).split("toString");i(2).inspectSource=function(t){return a.call(t)},(t.exports=function(t,e,i,a){var l="function"==typeof i;l&&(o(i,"name")||s(i,"name",e)),t[e]!==i&&(l&&(o(i,r)||s(i,r,t[e]?""+t[e]:h.join(String(e)))),t===n?t[e]=i:a?t[e]?t[e]=i:s(t,e,i):(delete t[e],s(t,e,i)))})(Function.prototype,"toString",function(){return"function"==typeof this&&this[r]||a.call(this)})},function(t,e,i){var n=i(36);t.exports=function(t,e,i){if(n(t),void 0===e)return t;switch(i){case 1:return function(i){return t.call(e,i)};case 2:return function(i,n){return t.call(e,i,n)};case 3:return function(i,n,s){return t.call(e,i,n,s)}}return function(){return t.apply(e,arguments)}}},function(t,e,i){var n=i(42),s=i(9);t.exports=function(t){return n(s(t))}},function(t,e){var i={}.toString;t.exports=function(t){return i.call(t).slice(8,-1)}},function(t,e,i){var n=i(8),s=Math.min;t.exports=function(t){return t>0?s(n(t),9007199254740991):0}},function(t,e,i){var n=i(2),s=i(1),o=s["__core-js_shared__"]||(s["__core-js_shared__"]={});(t.exports=function(t,e){return o[t]||(o[t]=void 0!==e?e:{})})("versions",[]).push({version:n.version,mode:i(15)?"pure":"global",copyright:"© 2018 Denis Pushkarev (zloirock.ru)"})},function(t,e){t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(t,e,i){var n=i(4).f,s=i(7),o=i(0)("toStringTag");t.exports=function(t,e,i){t&&!s(t=i?t:t.prototype,o)&&n(t,o,{configurable:!0,value:e})}},function(t,e,i){var n=i(9);t.exports=function(t){return Object(n(t))}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=Math.PI/180;e.default=function(t){return t*n}},function(t,e,i){"use strict";i(30);var n=function(t){return t&&t.__esModule?t:{default:t}}(i(54));t.exports=n.default},function(t,e,i){i(31),i(47),t.exports=i(2).Array.from},function(t,e,i){"use strict";var n=i(32)(!0);i(33)(String,"String",function(t){this._t=String(t),this._i=0},function(){var t,e=this._t,i=this._i;return i>=e.length?{value:void 0,done:!0}:(t=n(e,i),this._i+=t.length,{value:t,done:!1})})},function(t,e,i){var n=i(8),s=i(9);t.exports=function(t){return function(e,i){var o,r,a=String(s(e)),h=n(i),l=a.length;return h<0||h>=l?t?"":void 0:(o=a.charCodeAt(h))<55296||o>56319||h+1===l||(r=a.charCodeAt(h+1))<56320||r>57343?t?a.charAt(h):o:t?a.slice(h,h+2):r-56320+(o-55296<<10)+65536}}},function(t,e,i){"use strict";var n=i(15),s=i(16),o=i(19),r=i(3),a=i(13),h=i(37),l=i(26),u=i(46),c=i(0)("iterator"),f=!([].keys&&"next"in[].keys()),d=function(){return this};t.exports=function(t,e,i,p,m,_,g){h(i,e,p);var y,v,x,w=function(t){if(!f&&t in T)return T[t];switch(t){case"keys":case"values":return function(){return new i(this,t)}}return function(){return new i(this,t)}},b=e+" Iterator",P="values"==m,M=!1,T=t.prototype,S=T[c]||T["@@iterator"]||m&&T[m],L=S||w(m),k=m?P?w("entries"):L:void 0,E="Array"==e&&T.entries||S;if(E&&(x=u(E.call(new t)))!==Object.prototype&&x.next&&(l(x,b,!0),n||"function"==typeof x[c]||r(x,c,d)),P&&S&&"values"!==S.name&&(M=!0,L=function(){return S.call(this)}),n&&!g||!f&&!M&&T[c]||r(T,c,L),a[e]=L,a[b]=d,m)if(y={values:P?L:w("values"),keys:_?L:w("keys"),entries:k},g)for(v in y)v in T||o(T,v,y[v]);else s(s.P+s.F*(f||M),e,y);return y}},function(t,e,i){t.exports=!i(6)&&!i(17)(function(){return 7!=Object.defineProperty(i(18)("div"),"a",{get:function(){return 7}}).a})},function(t,e,i){var n=i(10);t.exports=function(t,e){if(!n(t))return t;var i,s;if(e&&"function"==typeof(i=t.toString)&&!n(s=i.call(t)))return s;if("function"==typeof(i=t.valueOf)&&!n(s=i.call(t)))return s;if(!e&&"function"==typeof(i=t.toString)&&!n(s=i.call(t)))return s;throw TypeError("Can't convert object to primitive value")}},function(t,e){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},function(t,e,i){"use strict";var n=i(38),s=i(11),o=i(26),r={};i(3)(r,i(0)("iterator"),function(){return this}),t.exports=function(t,e,i){t.prototype=n(r,{next:s(1,i)}),o(t,e+" Iterator")}},function(t,e,i){var n=i(5),s=i(39),o=i(25),r=i(14)("IE_PROTO"),a=function(){},h=function(){var t,e=i(18)("iframe"),n=o.length;for(e.style.display="none",i(45).appendChild(e),e.src="javascript:",(t=e.contentWindow.document).open(),t.write("<script>document.F=Object<\/script>"),t.close(),h=t.F;n--;)delete h.prototype[o[n]];return h()};t.exports=Object.create||function(t,e){var i;return null!==t?(a.prototype=n(t),i=new a,a.prototype=null,i[r]=t):i=h(),void 0===e?i:s(i,e)}},function(t,e,i){var n=i(4),s=i(5),o=i(40);t.exports=i(6)?Object.defineProperties:function(t,e){s(t);for(var i,r=o(e),a=r.length,h=0;a>h;)n.f(t,i=r[h++],e[i]);return t}},function(t,e,i){var n=i(41),s=i(25);t.exports=Object.keys||function(t){return n(t,s)}},function(t,e,i){var n=i(7),s=i(21),o=i(43)(!1),r=i(14)("IE_PROTO");t.exports=function(t,e){var i,a=s(t),h=0,l=[];for(i in a)i!=r&&n(a,i)&&l.push(i);for(;e.length>h;)n(a,i=e[h++])&&(~o(l,i)||l.push(i));return l}},function(t,e,i){var n=i(22);t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==n(t)?t.split(""):Object(t)}},function(t,e,i){var n=i(21),s=i(23),o=i(44);t.exports=function(t){return function(e,i,r){var a,h=n(e),l=s(h.length),u=o(r,l);if(t&&i!=i){for(;l>u;)if((a=h[u++])!=a)return!0}else for(;l>u;u++)if((t||u in h)&&h[u]===i)return t||u||0;return!t&&-1}}},function(t,e,i){var n=i(8),s=Math.max,o=Math.min;t.exports=function(t,e){return(t=n(t))<0?s(t+e,0):o(t,e)}},function(t,e,i){var n=i(1).document;t.exports=n&&n.documentElement},function(t,e,i){var n=i(7),s=i(27),o=i(14)("IE_PROTO"),r=Object.prototype;t.exports=Object.getPrototypeOf||function(t){return t=s(t),n(t,o)?t[o]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?r:null}},function(t,e,i){"use strict";var n=i(20),s=i(16),o=i(27),r=i(48),a=i(49),h=i(23),l=i(50),u=i(51);s(s.S+s.F*!i(53)(function(t){Array.from(t)}),"Array",{from:function(t){var e,i,s,c,f=o(t),d="function"==typeof this?this:Array,p=arguments.length,m=p>1?arguments[1]:void 0,_=void 0!==m,g=0,y=u(f);if(_&&(m=n(m,p>2?arguments[2]:void 0,2)),void 0==y||d==Array&&a(y))for(i=new d(e=h(f.length));e>g;g++)l(i,g,_?m(f[g],g):f[g]);else for(c=y.call(f),i=new d;!(s=c.next()).done;g++)l(i,g,_?r(c,m,[s.value,g],!0):s.value);return i.length=g,i}})},function(t,e,i){var n=i(5);t.exports=function(t,e,i,s){try{return s?e(n(i)[0],i[1]):e(i)}catch(e){var o=t.return;throw void 0!==o&&n(o.call(t)),e}}},function(t,e,i){var n=i(13),s=i(0)("iterator"),o=Array.prototype;t.exports=function(t){return void 0!==t&&(n.Array===t||o[s]===t)}},function(t,e,i){"use strict";var n=i(4),s=i(11);t.exports=function(t,e,i){e in t?n.f(t,e,s(0,i)):t[e]=i}},function(t,e,i){var n=i(52),s=i(0)("iterator"),o=i(13);t.exports=i(2).getIteratorMethod=function(t){if(void 0!=t)return t[s]||t["@@iterator"]||o[n(t)]}},function(t,e,i){var n=i(22),s=i(0)("toStringTag"),o="Arguments"==n(function(){return arguments}());t.exports=function(t){var e,i,r;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(i=function(t,e){try{return t[e]}catch(t){}}(e=Object(t),s))?i:o?n(e):"Object"==(r=n(e))&&"function"==typeof e.callee?"Arguments":r}},function(t,e,i){var n=i(0)("iterator"),s=!1;try{var o=[7][n]();o.return=function(){s=!0},Array.from(o,function(){throw 2})}catch(t){}t.exports=function(t,e){if(!e&&!s)return!1;var i=!1;try{var o=[7],r=o[n]();r.next=function(){return{done:i=!0}},o[n]=function(){return r},t(o)}catch(t){}return i}},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var s=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),o=n(i(55)),r=n(i(56)),a=n(i(57)),h=n(i(58)),l=n(i(59)),u=Math.PI,c=Math.max,f=Math.min,d=function(){function t(e){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.element=e,this.originalHTML=this.element.innerHTML;var i=document.createElement("div");i.setAttribute("aria-label",e.innerText),i.style.position="relative",this.container=i,this._letters=(0,r.default)(e),this._letters.forEach(function(t){return i.appendChild(t)}),this.element.innerHTML="",this.element.appendChild(i);var n=window.getComputedStyle(this.element),s=n.fontSize,a=n.lineHeight;this._fontSize=parseFloat(s),this._lineHeight=parseFloat(a)||this._fontSize,this._metrics=this._letters.map(o.default);var h=this._metrics.reduce(function(t,e){return t+e.width},0);this._minRadius=h/u/2+this._lineHeight,this._dir=1,this._forceWidth=!1,this._forceHeight=!0,this._radius=this._minRadius,this._invalidate()}return s(t,[{key:"radius",value:function(t){return void 0!==t?(this._radius=c(this._minRadius,t),this._invalidate(),this):this._radius}},{key:"dir",value:function(t){return void 0!==t?(this._dir=t,this._invalidate(),this):this._dir}},{key:"forceWidth",value:function(t){return void 0!==t?(this._forceWidth=t,this._invalidate(),this):this._forceWidth}},{key:"forceHeight",value:function(t){return void 0!==t?(this._forceHeight=t,this._invalidate(),this):this._forceHeight}},{key:"refresh",value:function(){return this._invalidate()}},{key:"destroy",value:function(){return this.element.innerHTML=this.originalHTML,this}},{key:"_invalidate",value:function(){var t=this;return cancelAnimationFrame(this._raf),this._raf=requestAnimationFrame(function(){t._layout()}),this}},{key:"_layout",value:function(){var t=this,e=this._radius,i=this._dir,n="center "+(-1===i?-e+this._lineHeight:e)/this._fontSize+"em",s=e-this._lineHeight,o=(0,l.default)(this._metrics,s),r=o.rotations,u=o.θ;if(this._letters.forEach(function(e,s){var o=e.style,a=(-.5*u+r[s])*i,h="translateX("+-.5*t._metrics[s].width/t._fontSize+"em) rotate("+a+"deg)";o.position="absolute",o.bottom=-1===i?0:"auto",o.left="50%",o.transform=h,o.transformOrigin=n,o.webkitTransform=h,o.webkitTransformOrigin=n}),this._forceHeight){var c=u>180?(0,a.default)(e,u):(0,a.default)(s,u)+this._lineHeight;this.container.style.height=c/this._fontSize+"em"}if(this._forceWidth){var d=(0,h.default)(e,f(180,u));this.container.style.width=d/this._fontSize+"em"}return this}}]),t}();e.default=d},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){var e=t.getBoundingClientRect();return{height:e.height,left:e.left+window.pageXOffset,top:e.top+window.pageYOffset,width:e.width}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"span",i=document.createElement(e);return[].concat(function(t){if(Array.isArray(t)){for(var e=0,i=Array(t.length);e<t.length;e++)i[e]=t[e];return i}return Array.from(t)}(t.innerText.trim())).map(function(t){var e=i.cloneNode();return e.insertAdjacentHTML("afterbegin"," "===t?"&nbsp;":t),e})}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(t){return t&&t.__esModule?t:{default:t}}(i(28));e.default=function(t,e){return t*(1-Math.cos((0,n.default)(e/2)))}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(t){return t&&t.__esModule?t:{default:t}}(i(28));e.default=function(t,e){return 2*t*Math.sin((0,n.default)(e/2))}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(t){return t&&t.__esModule?t:{default:t}}(i(60));e.default=function(t,e){return t.reduce(function(t,i){var s=i.width,o=(0,n.default)(s/e);return{"θ":t.θ+o,rotations:t.rotations.concat([t.θ+o/2])}},{"θ":0,rotations:[]})}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=180/Math.PI;e.default=function(t){return t*n}}])}),function(t){"use strict";function e(t){var e=getComputedStyle(t);this.units={px:1},this.element=t;var i=function(t){return t&&t.length?parseInt(t):0};this.margins=[e.marginTop,e.marginRight,e.marginBottom,e.marginLeft],this.margins=this.margins.map(i),this.borders=[e.borderTopWidth,e.borderRightWidth,e.borderBottomWidth,e.borderLeftWidth],this.borders=this.borders.map(i),this.paddings=[e.paddingTop,e.paddingRight,e.paddingBottom,e.paddingLeft],this.paddings=this.paddings.map(i),this.borderBox={x:0,y:0,width:t.offsetWidth,height:t.offsetHeight},this.marginBox={x:-this.margins[3],y:-this.margins[0],width:t.offsetWidth+this.margins[1]+this.margins[3],height:t.offsetHeight+this.margins[0]+this.margins[2]};var n=this;this.borderBox.radii=["borderTopLeftRadius","borderTopRightRadius","borderBottomRightRadius","borderBottomLeftRadius"].map(function(t){return t=e[t].split(/\s+/),[n.toPixels(t[0],n.borderBox.width),n.toPixels(t.length>1?t[1]:t[0],n.borderBox.height)]}),this.cssFloat=e.cssFloat}function i(t,e,i){return(i.x-t.x)*(e.y-t.y)-(e.x-t.x)*(i.y-t.y)}function n(t,e,n){return Math.abs(i(t,e,n))<350}function s(t,e){return t.x==e.x&&t.y==e.y}function o(){}function r(t,e,i,n){return t.y>=i&&t.y<=n?{x1:t.x-e,x2:t.x+e}:n<t.y?(s=M(n-t.y,e,e),{x1:t.x-s,x2:t.x+s}):(s=M(i-t.y,e,e),{x1:t.x-s,x2:t.x+s});var s}function a(t,e,i){this.init(t,e,i)}function h(t,e){var i=t.polygon.shapeMargin,n=e.x*i,s=e.y*i;this.anchorEdge=t,this.normalUnitVector=e;var o={x:t.vertex1.x+n,y:t.vertex1.y+s},r={x:t.vertex2.x+n,y:t.vertex2.y+s};this.init(t.polygon,o,r)}function l(t){for(var e=0,n=1;n<t.length;++n){var s=t[n];(s.y<t[e].y||s.y==t[e].y&&s.x<t[e].x)&&(e=n)}var o=t[(e+1)%t.length];return i(t[(e+t.length-1)%t.length],t[e],o)<0}function u(t,e,i){if(this.m_vertices=t,this.fillRule=e,this.shapeMargin=i,t.length<3)return this.m_edges=[],void(this.shapeMarginEdges=[]);var s=[],o=t.length>0?t[0].x:void 0,r=t.length>0?t[0].y:void 0,u=o,c=r,f=l(t),d=0;do{var p=this.nextEdgeVertexIndex(d,f);s.push(new a(this,t[d],t[p]));var m=t[d].x,_=t[d].y;o=Math.min(m,o),r=Math.min(_,r),u=Math.max(m,u),c=Math.max(_,c),d=p}while(0!==d);for(var g,y=0;y<s.length&&s.length>3;)g=(y+1)%s.length,n(s[y].vertex1,s[y].vertex2,s[g].vertex2)?(s[y].vertex2=s[g].vertex2,s.splice(g,1)):y++;if(0===i)this.shapeMarginEdges=s;else{for(var v=[],x=0;x<s.length;x++)v.push(new h(s[x],s[x].outwardNormal())),v.push(new h(s[x],s[x].inwardNormal()));this.shapeMarginEdges=v}this.m_edges=s,this.bounds=new b(o-i,r-i,2*i+(u-o),2*i+(c-r))}function c(t,e){return t.minX-e.minX}function f(t,e){return e.x-t.x}function d(t,e){return e.maxX-t.maxX}function p(t,e){return t.x-e.x}function m(t,e,i){this.y=t,this.startX=e,this.endX=i}function _(t,e){this.intervals=[],this.yOffset=t,this.size=e;for(var i=0;e>i;i++)this.intervals[i]=_.none;this.minY=-t,this.maxY=e-t}function g(t){this.shapeMargin=t,this.xIntercepts=[];for(var e=0;t>=e;e++)this.xIntercepts[e]=Math.sqrt(t*t-e*e)}function y(t,e){console.log("Unable to load image ",t,". It's probably missing or you've run into a CORS issue."),e&&console.log("The exact problem was ",e)}function v(t,e,i){var n=document.createElement("canvas");this.width=n.width=e,this.height=n.height=i;var s=n.getContext("2d");s.drawImage(t,0,0,e,i);try{this.imageData=s.getImageData(0,0,e,i)}catch(e){y(t.src,e)}}function x(t,e,i,n,s,o){this.url=t,this.box=e,this.shapeImageThreshold=256*i,this.shapeMargin=n,this.clip=s,this.init(o)}function w(t,e){this.width=t,this.height=e}function b(t,e,i,n){this.x=t,this.y=e,this.width=i,this.height=n,this.maxX=t+i,this.maxY=e+n}function P(t,e,i,n,s){this.rect=t,this.radii={topLeft:e,topRight:i,bottomLeft:n,bottomRight:s}}function M(t,e,i){return e*Math.sqrt(1-t*t/(i*i))}function T(t,e,i){return 0===e?1:Math.round(0===t||i>t*e/2?e:Math.sqrt(2*i*(e/t)))}function S(t,e,i,n){return function(s,o,r){if(!this.rect.overlapsYRange(s,o))return[{x:void 0,height:o-s}];var a=[];s<this.rect.y&&a.push({x:void 0,height:this.rect.y-s});var h,l,u,c,f,d=t.call(this),p=e.call(this),m=new b(this.rect.x,d.maxY,this.rect.width,p.y-d.maxY);if(d.overlapsYRange(s,o))for(h=T(d.width,d.height,r),l=Math.max(d.y,s),u=Math.min(d.maxY,o),c=l;u>c;c+=h)f=M(d.maxY-Math.min(c+h,u),d.width,d.height),a.push({height:Math.min(h,u-c),x:n(d,f)});if(l=Math.max(m.y,s),u=Math.min(m.maxY,o),m.overlapsYRange(s,o)&&a.push({x:i(m),height:u-l}),p.overlapsYRange(s,o))for(h=T(p.width,p.height,r),l=Math.max(s,p.y),u=Math.min(p.maxY,o),c=l;u>c;c+=h)f=M(c-p.y,p.width,p.height),a.push({height:Math.min(h,u-c),x:n(p,f)});return o>this.rect.maxY&&a.push({x:void 0,height:o-this.rect.maxY}),a}}function L(t,e){var i,n=void 0===t.shapeMargin?0:t.shapeMargin;if(t.shape){switch(t.shape.type){case"circle":i=function(t,e){var i=t.r+e,n=new w(i,i);return new P(new b(t.cx-i,t.cy-i,2*i,2*i),n,n,n,n)}(t.shape,n);break;case"ellipse":i=function(t,e){var i=new w(t.rx+e,t.ry+e);return new P(new b(t.cx-i.width,t.cy-i.height,2*i.width,2*i.height),i,i,i,i)}(t.shape,n);break;case"inset":(i=function(t,e){function i(t){return new w(t[0]+e,t[1]+e)}var n=i(t.radii[0]),s=i(t.radii[1]),o=i(t.radii[2]),r=i(t.radii[3]);return new P(new b(t.x-e,t.y-e,t.width+2*e,t.height+2*e),n,s,r,o)}(t.shape,n)).isRenderable()||i.adjustRadii();break;case"polygon":i=function(t,e){return new u(t.points,t.fillRule,e)}(t.shape,n)}return e(),i}return t.url?function(t,e,i,n,s,o){return new x(t,e,i,n,new b(s.x,s.y,s.width,s.height),o)}(t.url,t.box,t.shapeImageThreshold,n,t.clip,e):t.box?(i=function(t,e){function i(t){return new w(t[0]+e,t[1]+e)}var n=i(t.radii[0]),s=i(t.radii[1]),o=i(t.radii[2]),r=i(t.radii[3]);return new P(new b(-e,-e,t.width+2*e,t.height+2*e),n,s,r,o)}(t.box,n),e(),i):void console.error("Unrecognized shape")}function k(t){this.metrics=new e(t);var i={metrics:this.metrics,shapeOutside:t.getAttribute("data-shape-outside"),shapeMargin:t.getAttribute("data-shape-margin"),shapeImageThreshold:t.getAttribute("data-shape-image-threshold")};this.shapeValue=new C(i);var n=this;this.geometry=L(this.shapeValue,function(){n.ready=!0,n.callback&&n.callback()})}function E(t){this.scope=t;var e=document.currentScript;e||(e=(e=document.getElementsByTagName("script"))[e.length-1]);var i=this;"false"!==e.getAttribute("data-auto-run")&&t.addEventListener&&t.addEventListener("load",function(){i.run()})}function C(t){return t&&t.metrics&&t.shapeOutside?(this.url=this.parseUrl(t.shapeOutside),this.box=this.parseBox(this.url?"content-box":t.shapeOutside,t.metrics),this.shape=this.parseBasicShape(t.shapeOutside,this.box,t.metrics),this.clip=this.computeClip(this.box,t.metrics),this.shapeMargin=this.parseShapeMargin(t.shapeMargin,this.box,t.metrics),void(this.shapeImageThreshold=this.parseShapeImageThreshold(t.shapeImageThreshold))):void console.error("ShapeValue requires at least a metrics object and shape-outside string")}function A(t,e,i){var n=i.reduce(function(t,e){return t+e[0]},0),s=i.reduce(function(t,e){return t+e[1]},0),o=i.reduce(function(t,e){return t+e[2]},0),r=i.reduce(function(t,e){return t+e[3]},0);t.x-=e*r,t.y-=e*n,t.width+=e*(r+s),t.height+=e*(n+o)}function O(t,e,i){if(0>e)return Math.max(t+e*i,0);var n=Math.abs(t/i);return 1>n?Math.max(t+i*(1+Math.pow(n-1,3)),0):t+i}function R(t,e,i){var n=i.reduce(function(t,e){return t+e[0]},0),s=i.reduce(function(t,e){return t+e[1]},0),o=i.reduce(function(t,e){return t+e[2]},0),r=i.reduce(function(t,e){return t+e[3]},0);t[0][0]=O(t[0][0],e,r),t[0][1]=O(t[0][1],e,n),t[1][0]=O(t[1][0],e,s),t[1][1]=O(t[1][1],e,n),t[2][0]=O(t[2][0],e,s),t[2][1]=O(t[2][1],e,o),t[3][0]=O(t[3][0],e,r),t[3][1]=O(t[3][1],e,o)}function z(t,e){return t.map(function(t){return t[e]})}function I(t,e,i){var n="TopLeft",s=0;switch((t=t.split(/\s+/))[0]){case"top":case"left":break;case"bottom":case"right":n="BottomRight";break;case"center":s=e/2;break;default:s=i.toPixels(t[0],e)}return t.length>1&&(s=i.toPixels(t[1],e)),"TopLeft"===n?s:e-s}function B(t,e,i,n){return"closest-side"===t?Math.min.apply(null,e):"farthest-side"===t?Math.max.apply(null,e):n.toPixels(t,i)}function N(t){this.source=t,this.url=t.href||null,this.cssText=""}function Z(t){return this instanceof Z?(this.stylesheets=[],this.queueCount=0,this.callback=t||function(){},void this.init()):new Z(t)}function D(t){this.callback=t||function(){};var e=this;new Z(function(t){e.onStylesLoaded(t)})}e.prototype.unitToPx=function(t){if(this.units[t])return this.units[t];var e=this.element.style.getPropertyValue("line-height");return this.element.style.setProperty("line-height",1+t),this.units[t]=parseFloat(getComputedStyle(this.element).getPropertyValue("line-height")),this.element.style.setProperty("line-height",e),this.units[t]},e.prototype.getUnitsMap=function(t){var e=document.createElement("div");e.style.width="0px",e.style.height="0px",t.appendChild(e);var i=getComputedStyle(e),n={};return["em","ex","ch","rem","vw","vh","vmin","vmax","cm","mm","in","px","pt","pc"].forEach(function(t){e.style.lineHeight="1"+t,n[t]=parseFloat(i.lineHeight)}),e.parentNode.removeChild(e),n},e.prototype.toPixels=function(t,e){var i=/([\-0-9\.]*)([a-z%]*)/.exec(t);return i[1]=parseFloat(i[1]),i[2]?"%"===i[2]?i[1]*e/100:i[1]*this.unitToPx(i[2]):i[1]},o.prototype.init=function(t,e,i){this.polygon=t,this.vertex1=e,this.vertex2=i,this.minX=Math.min(this.vertex1.x,this.vertex2.x),this.maxX=Math.max(this.vertex1.x,this.vertex2.x)},o.prototype.containsPoint=function(t){return function(t,e,i){return i.x>=Math.min(t.x,e.x)&&i.x<=Math.max(t.x,e.x)&&n(t,e,i)}(this.vertex1,this.vertex2,t)},o.prototype.overlapsYRange=function(t,e){var i=this.vertex1.y,n=this.vertex2.y;return e>=Math.min(i,n)&&t<=Math.max(i,n)},o.prototype.isWithinYRange=function(t,e){var i=this.vertex1.y,n=this.vertex2.y;return t<=Math.min(i,n)&&e>=Math.max(i,n)},o.prototype.inwardNormal=function(){var t=this.vertex2.x-this.vertex1.x,e=this.vertex2.y-this.vertex1.y,i=Math.sqrt(t*t+e*e);return{x:-e/i,y:t/i}},o.prototype.outwardNormal=function(){var t=this.inwardNormal();return{x:-t.x,y:-t.y}},o.prototype.xIntercept=function(t){var e=this.vertex1.y,i=this.vertex2.y;return e==i?Math.min(this.vertex1.x,this.vertex2.x):t==Math.min(e,i)?i>e?this.vertex1.x:this.vertex2.x:t==Math.max(e,i)?e>i?this.vertex1.x:this.vertex2.x:this.vertex1.x+(t-e)*(this.vertex2.x-this.vertex1.x)/(i-e)},o.prototype.clippedEdgeXRange=function(t,e){if(this.isWithinYRange(t,e)){var i=this.vertex1.x,n=this.vertex2.x;return{x1:Math.min(i,n),x2:Math.max(i,n)}}var s,o;this.vertex1.y<this.vertex2.y?(s=this.vertex1,o=this.vertex2):(s=this.vertex2,o=this.vertex1);var r=s.y<t?this.xIntercept(t):s.x,a=o.y>e?this.xIntercept(e):o.x;return{x1:Math.min(r,a),x2:Math.max(r,a)}},a.prototype=new o,h.prototype=new o,u.prototype.vertexAt=function(t){return this.m_vertices[t]},u.prototype.edgeAt=function(t){return this.m_edges[t]},u.prototype.isEmpty=function(){return this.m_edges.length<3||this.bounds.isEmpty()},u.prototype.vertices=function(){return this.m_vertices.slice(0)},u.prototype.edges=function(){return this.m_edges.slice(0)},u.prototype.overlapsYRange=function(t,e){return t<this.bounds.maxY&&e>=this.bounds.y},u.prototype.nextVertexIndex=function(t,e){var i=this.m_vertices.length;return(e?t+1:t-1+i)%i},u.prototype.nextEdgeVertexIndex=function(t,e){for(var i=(this.m_vertices.length,this.nextVertexIndex(t,e));i&&s(this.vertexAt(t),this.vertexAt(i));)i=this.nextVertexIndex(i,e);for(;i;){var o=this.nextVertexIndex(i,e);if(!n(this.vertexAt(t),this.vertexAt(i),this.vertexAt(o)))break;i=o}return i},u.prototype.containsPointEvenOdd=function(t){for(var e=0,i=0;i<this.m_edges.length;++i){var n=this.edgeAt(i);if(n.containsPoint(t))return!0;var s=n.vertex1,o=n.vertex2;if(s.y<=t.y&&o.y>t.y||s.y>t.y&&o.y<=t.y){var r=(t.y-s.y)/(o.y-s.y);t.x<s.x+r*(o.x-s.x)&&++e}}return 0!=(1&e)},u.prototype.containsPointNonZero=function(t){for(var e=0,n=0;n<this.m_edges.length;++n){var s=this.edgeAt(n);if(s.containsPoint(t))return!0;var o=s.vertex1,r=s.vertex2;r.y<t.y?o.y>t.y&&i(o,r,t)>0&&++e:r.y>t.y&&o.y<=t.y&&i(o,r,t)<0&&--e}return 0!==e},u.prototype.containsPoint=function(t){return!!this.bounds.containsPoint(t)&&("nonzero"==this.fillRule?this.containsPointNonZero(t):this.containsPointEvenOdd(t))},u.prototype.edgeVerticesThatOverlapYRange=function(t,e){for(var i=[],n=0;n<this.m_edges.length;n++){var s=this.edgeAt(n).vertex1;s.y>=t&&s.y<e&&i.push(s)}return i},u.prototype.edgesThatOverlapYRange=function(t,e){for(var i=[],n=0;n<this.m_edges.length;n++){var s=this.edgeAt(n);s.overlapsYRange(t,e)&&i.push(s)}return i},u.prototype.shapeMarginEdgesThatOverlapYRange=function(t,e){for(var i=[],n=0;n<this.shapeMarginEdges.length;n++){var s=this.shapeMarginEdges[n];s.overlapsYRange(t,e)&&i.push(s)}return i},u.prototype.leftExclusionEdge=function(t,e){if(!this.isEmpty()&&this.bounds.overlapsYRange(t,e)){var i,n,s,o=this.shapeMarginEdgesThatOverlapYRange(t,e);if(0!==o.length)for(o.sort(c),i=o[0].clippedEdgeXRange(t,e).x1,n=1;n<o.length&&!(o[n].minX>i);n++)s=o[n].clippedEdgeXRange(t,e),i=void 0===i?s.x1:Math.min(i,s.x1);var a=this.shapeMargin;if(a>0){var h=this.edgeVerticesThatOverlapYRange(t-a,e+a);for(h.sort(f),n=0;n<h.length;n++)s=r(h[n],a,t,e),i=void 0===i?s.x1:Math.min(i,s.x1)}return void 0===i&&console.error("Polygon leftExclusionEdge() failed"),i}},u.prototype.rightExclusionEdge=function(t,e){if(!this.isEmpty()&&this.bounds.overlapsYRange(t,e)){var i,n,s,o=this.shapeMarginEdgesThatOverlapYRange(t,e);if(0!==o.length)for(o.sort(d),i=o[0].clippedEdgeXRange(t,e).x2,n=1;n<o.length&&!(o[n].maxX<i);n++)s=o[n].clippedEdgeXRange(t,e),i=Math.max(i,s.x2);var a=this.shapeMargin;if(a>0){var h=this.edgeVerticesThatOverlapYRange(t-a,e+a);for(h.sort(p),n=0;n<h.length;n++)s=r(h[n],a,t,e),i=void 0===i?s.x2:Math.max(i,s.x2)}return void 0===i&&console.error("Polygon rightExclusionEdge() failed"),i}},_.none={},_.prototype.intervalAt=function(t){return this.intervals[t+this.yOffset]},_.prototype.setIntervalAt=function(t,e){this.intervals[t+this.yOffset]=e},_.prototype.uniteIntervalAt=function(t,e){var i=this.intervalAt(t);i===_.none?this.setIntervalAt(t,e):(i.startX=Math.min(i.startX,e.startX),i.endX=Math.max(i.endX,e.endX))},_.prototype.intervalAtContains=function(t,e){var i=this.intervalAt(t);return i!=_.none&&(i.startX<=e.startX&&i.endX>=e.endX)},g.prototype.generateIntervalAt=function(t,e){var i=Math.abs(t-e.y),n=i>this.shapeMargin?0:this.xIntercepts[i];return new m(t,e.startX-n,e.endX+n)},_.prototype.computeMarginIntervals=function(t){for(var e=new g(t),i=new _(this.yOffset,this.size),n=this.minY;n<this.maxY;++n){var s=this.intervalAt(n);if(s!=_.none){var o,r=Math.max(this.minY,n-t),a=Math.min(this.maxY-1,n+t);for(o=n-1;o>=r&&!(o>0&&this.intervalAtContains(o,s));--o)i.uniteIntervalAt(o,e.generateIntervalAt(o,s));for(i.uniteIntervalAt(n,e.generateIntervalAt(n,s)),o=n+1;a>=o&&!(o<this.maxY&&this.intervalAtContains(o,s));++o)i.uniteIntervalAt(o,e.generateIntervalAt(o,s))}}return i},v.prototype.hasData=function(){return!!this.imageData},v.prototype.alphaAt=function(t,e){return this.imageData.data[4*t+3+e*this.width*4]},x.prototype.init=function(t){var e,i=this,n=new Image;if(document.createElement("canvas").getContext||(y(i.url),t()),n.onload=function(){i.intervals=i.computeIntervals(n),i.intervals&&i.shapeMargin>0&&(i.intervals=i.intervals.computeMarginIntervals(i.shapeMargin,i.clip)),e&&URL.revokeObjectURL(e),t()},n.onerror=function(){y(i.url),t()},!n.hasOwnProperty("crossOrigin")&&window.URL&&window.URL.createObjectURL){var s=new XMLHttpRequest;s.onreadystatechange=function(){4===s.readyState&&(200===s.status?(e=URL.createObjectURL(s.response),n.src=e):(y(i.url),t()))},s.open("GET",i.url,!0),s.responseType="blob",s.send()}else n.crossOrigin="anonymous",n.src=i.url},x.prototype.computeIntervals=function(t){var e=this.clip,i=this.shapeImageThreshold,n=this.box.width,s=new v(t,n,this.box.height);if(s.hasData()){for(var o=new _(-e.y,e.height),r=Math.min(e.height,this.box.height),a=0;r>a;a++)for(var h=-1,l=0;l<this.box.width;l++){var u=s.alphaAt(l,a);-1==h&&u>i?(h=l,o.intervalAt(a)===_.none&&o.setIntervalAt(a,new m(a,h,n))):-1!=h&&i>=u&&(o.intervalAt(a).endX=l,h=-1)}return o}},x.prototype.rightExclusionEdge=function(t,e){var i=this.intervals;if(!i)return this.clip.width;for(var n,s=Math.max(t,this.clip.y);e>=s&&s<this.clip.maxY;s++){var o=i.intervalAt(s).endX;(void 0===n||void 0!==o&&o>n)&&(n=o)}return n},x.prototype.leftExclusionEdge=function(t,e){var i=this.intervals;if(!i)return 0;for(var n,s=Math.max(t,this.clip.y);e>=s&&s<this.clip.maxY;s++){var o=i.intervalAt(s).startX;(void 0===n||void 0!==o&&n>o)&&(n=o)}return n},w.zeroSize={width:0,height:0},w.prototype.isEmpty=function(){return this.width<=0||this.height<=0},w.prototype.scale=function(t){this.width*=t,this.height*=t},b.prototype.isEmpty=function(){return this.width<=0||this.height<=0},b.prototype.containsX=function(t){return t>=this.x&&t<this.maxX},b.prototype.containsY=function(t){return t>=this.y&&t<this.maxY},b.prototype.containsPoint=function(t){return this.containsX(t.x)&&this.containsY(t.y)},b.prototype.shiftLeftEdgeTo=function(t){this.width-=t-this.x,this.x=t},b.prototype.shiftTopEdgeTo=function(t){this.height-=t-this.y,this.y=t},b.prototype.shiftRightEdgeTo=function(t){this.width=t-this.x},b.prototype.shiftBottomEdgeTo=function(t){this.height=t-this.y},b.prototype.overlapsYRange=function(t,e){return!this.isEmpty()&&e>=this.y&&t<this.maxY},b.prototype.overlapsXRange=function(t,e){return!this.isEmpty()&&e>=this.x&&t<this.maxX},P.prototype.isEmpty=function(){return this.width<=0||this.height<=0},P.prototype.topLeftCorner=function(){return new b(this.rect.x,this.rect.y,this.radii.topLeft.width,this.radii.topLeft.height)},P.prototype.topRightCorner=function(){return new b(this.rect.maxX-this.radii.topRight.width,this.rect.y,this.radii.topRight.width,this.radii.topRight.height)},P.prototype.bottomLeftCorner=function(){return new b(this.rect.x,this.rect.maxY-this.radii.bottomLeft.height,this.radii.bottomLeft.width,this.radii.bottomLeft.height)},P.prototype.bottomRightCorner=function(){return new b(this.rect.maxX-this.radii.bottomRight.width,this.rect.maxY-this.radii.bottomRight.height,this.radii.bottomRight.width,this.radii.bottomRight.height)},P.prototype.isRounded=function(){function t(t){return t.width>0&&t.height>0}return t(this.radii.topLeft)||t(this.radii.topRight)||t(this.radii.bottomLeft)||t(this.radii.bottomRight)},P.prototype.cornersInsetRect=function(){var t=this.topLeftCorner(),e=this.topRightCorner(),i=this.bottomLeftCorner(),n=this.bottomRightCorner(),s=Math.max(t.maxX,i.maxX),o=Math.max(t.maxY,e.maxY);return new b(s,o,Math.min(e.x,n.x)-s,Math.min(i.y,n.y)-o)},P.prototype.scaleRadii=function(t){if(1!=t){var e=this.radii;e.topLeft.scale(t),e.topLeft.isEmpty()&&(e.topLeft=w.zeroSize),e.topRight.scale(t),e.topRight.isEmpty()&&(e.topRight=w.zeroSize),e.bottomLeft.scale(t),e.bottomLeft.isEmpty()&&(e.bottomLeft=w.zeroSize),e.bottomRight.scale(t),e.bottomRight.isEmpty()&&(e.bottomRight=w.zeroSize)}},P.prototype.isRenderable=function(){var t=this.radii,e=this.rect;return t.topLeft.width+t.topRight.width<=e.width&&t.bottomLeft.width+t.bottomRight.width<=e.width&&t.topLeft.height+t.bottomLeft.height<=e.height&&t.topRight.height+t.bottomRight.height<=e.height},P.prototype.adjustRadii=function(){var t=this.radii,e=Math.max(t.topLeft.width+t.topRight.width,t.bottomLeft.width+t.bottomRight.width),i=Math.max(t.topLeft.height+t.bottomLeft.height,t.topRight.height+t.bottomRight.height);if(0>=e||0>=i)this.radii={topLeft:w.zeroSize,topRight:w.zeroSize,bottomRight:w.zeroSize,bottomLeft:w.zeroSize};else{var n=this.rect,s=n.width/e,o=n.height/i;this.scaleRadii(o>s?s:o)}},P.prototype.minXInterceptAt=function(t,e){if(!this.rect.containsY(t))return e;var i,n=this.topLeftCorner();if(n.containsY(t))return i=n.maxY-t,n.maxX-M(i,n.width,n.height);var s=this.bottomLeftCorner();return s.containsY(t)?(i=t-s.y,s.maxX-M(i,s.width,s.height)):this.rect.x},P.prototype.maxXInterceptAt=function(t,e){if(!this.rect.containsY(t))return e;var i,n=this.topRightCorner();if(n.containsY(t))return i=n.maxY-t,n.x+M(i,n.width,n.height);var s=this.bottomRightCorner();return s.containsY(t)?(i=t-s.y,s.x+M(i,s.width,s.height)):this.rect.maxX},P.prototype.rightExclusionEdge=function(t,e){return this.rect.isEmpty()||!this.rect.overlapsYRange(t,e)?void 0:!this.isRounded()||this.cornersInsetRect().overlapsYRange(t,e)?this.rect.maxX:Math.max(this.maxXInterceptAt(t,this.rect.x),this.maxXInterceptAt(e,this.rect.x))},P.prototype.leftExclusionEdge=function(t,e){return this.rect.isEmpty()||!this.rect.overlapsYRange(t,e)?void 0:!this.isRounded()||this.cornersInsetRect().overlapsYRange(t,e)?this.rect.x:Math.min(this.minXInterceptAt(t,this.rect.maxX),this.minXInterceptAt(e,this.rect.maxX))},P.prototype.rightExclusionOffsets=S(P.prototype.topRightCorner,P.prototype.bottomRightCorner,function(t){return t.maxX},function(t,e){return t.x+e}),P.prototype.leftExclusionOffsets=S(P.prototype.topLeftCorner,P.prototype.bottomLeftCorner,function(t){return t.x},function(t,e){return t.maxX-e}),k.prototype.onReady=function(t){this.ready?t():this.callback=t},k.prototype.leftExclusionEdge=function(t){return this.geometry?this.geometry.leftExclusionEdge(t.top,t.bottom):t.left},k.prototype.rightExclusionEdge=function(t){return this.geometry?this.geometry.rightExclusionEdge(t.top,t.bottom):t.right},k.prototype.computeStepOffsets=function(t){for(var e,i=[],n=0;n<Math.ceil(this.metrics.marginBox.height/t);n++){var s={left:0,right:this.shapeValue.box.width,top:n*t,bottom:Math.min((n+1)*t,this.metrics.marginBox.height)};s.top-=this.metrics.margins[0]+this.shapeValue.box.y,s.bottom-=this.metrics.margins[0]+this.shapeValue.box.y,"left"===this.metrics.cssFloat?e=void 0===(e=this.rightExclusionEdge(s))?0:e+this.shapeValue.box.x+this.metrics.margins[3]:e=void 0===(e=this.leftExclusionEdge(s))?0:this.metrics.marginBox.width-(e+this.shapeValue.box.x+this.metrics.margins[3]),i.push({cssFloat:this.metrics.cssFloat,top:s.top+this.shapeValue.box.y+this.metrics.margins[0],bottom:s.bottom+this.shapeValue.box.y+this.metrics.margins[0],offset:Math.min(e,this.metrics.marginBox.width)})}return i},k.prototype.computeAdaptiveOffsets=function(t){for(var e=this.shapeValue.box.x+this.metrics.margins[3],i=this.metrics.margins[0]+this.shapeValue.box.y,n="left"===this.metrics.cssFloat?this.geometry.rightExclusionOffsets(-i,this.metrics.marginBox.height-i,t):this.geometry.leftExclusionOffsets(-i,this.metrics.marginBox.height-i,t),s=[],o=0,r=0;r<n.length;r++){var a;void 0===n[r].x?a=0:(a="left"==this.metrics.cssFloat?n[r].x+e:this.metrics.marginBox.width-(n[r].x+e),a=Math.min(a,this.metrics.marginBox.width)),s.push({offset:a,top:o,bottom:o+n[r].height,cssFloat:this.metrics.cssFloat}),o+=n[r].height}return s},k.prototype.offsets=function(t){return this.geometry instanceof P?"step"==(t&&t.mode)?this.computeStepOffsets(t.step):this.computeAdaptiveOffsets(t.limit):this.computeStepOffsets(t.step)},E.prototype.polyfill=function(t,e){var i=getComputedStyle(t);if(/left|right/.test(i.cssFloat)&&t.getAttribute("data-shape-outside")){var n=e&&e.step||parseInt(i.fontSize),s=e&&e.mode||"adaptive",o=e&&e.limit||1.8*n,r=new k(t),a=this;r.onReady(function(){var i=r.offsets({mode:s,limit:o,step:n});(function(t,e){var i,n=document.createElement("div");for(var s in e.forEach(function(t){var e=t.bottom-t.top,s=document.createElement("div");for(var o in s.className="sandbag",i={cssFloat:t.cssFloat,width:t.offset+"px",height:e+"px",clear:t.cssFloat})s.style[o]=i[o];n.appendChild(s)}),i={position:"relative",width:"auto",height:"0",clear:"both",pointerEvents:"none"})n.style[s]=i[s];var o,r=t.parentNode,a=getComputedStyle(r),h=parseFloat(a.borderTop)+parseFloat(a.borderBottom);for(s in i={position:"absolute",top:"0",width:"100%",height:r.clientHeight-h,left:"0"},o=document.createElement("div"),i)o.style[s]=i[s];n.appendChild(o),t.parentNode&&t.parentNode.insertBefore(n,t),o.appendChild(t),n.setAttribute("data-shape-outside-container","true")})(t,i),e&&e.callback&&"function"==typeof e.callback&&e.callback.call(a.scope)})}},E.prototype.removePolyfill=function(t){var e=t.parentNode;for(e=t.parentNode;e&&e.hasAttribute&&!e.hasAttribute("data-shape-outside-container");e=e.parentNode);e&&e.hasAttribute&&(e.parentNode.insertBefore(t,e),e.parentNode.removeChild(e))},E.prototype.run=function(t){var e=this,i=t&&t.force,n=(i&&(i===this.Force.Layout||this.Force.LayoutStyles),i&&(i===this.Force.Styles||i===this.Force.LayoutStyles));if(i===this.Force.LayoutStyles?t.force=this.Force.Layout:i&&delete t.force,void 0===this.hasNativeSupport){var s=document.createElement("div");["shape-outside","-webkit-shape-outside"].forEach(function(t){s.style.setProperty(t,"content-box"),e.hasNativeSupport=e.hasNativeSupport||s.style.getPropertyValue(t)})}if(!this.hasNativeSupport||i){if(!this.stylesLoaded||n){this.stylesLoaded=!0,new D(function(i){i.forEach(function(t){for(var e=document.querySelectorAll(t.selector),i=0;i<e.length;i++)e[i].setAttribute("data-"+t.property,t.value)}),e.run(t)});var o=function(t,e){var i;return function(){var n=this,s=arguments;clearTimeout(i),i=setTimeout(function(){i=null,t.apply(n,s)},e)}}(function(){e.teardown(),e.run(t)},300);return void this.scope.addEventListener("resize",o)}for(var r=document.querySelectorAll("[data-shape-outside]"),a=0;a<r.length;a++)this.polyfill(r[a],t)}},E.prototype.teardown=function(){for(var t=document.querySelectorAll("[data-shape-outside]"),e=0;e<t.length;e++)this.removePolyfill(t[e])},E.prototype.Force={Layout:"force-layout",Styles:"force-styles",LayoutStyles:"force-layout-styles"},Object.freeze&&(E.prototype.Force=Object.freeze(E.prototype.Force)),C.prototype.parseUrl=function(t){var e=/url\((.*)\)/.exec(t);return e?e=(e=(e=e[1]).replace(/^['"]/,"")).replace(/['"]$/,""):null},C.prototype.parseBox=function(t,e){var i=/margin-box|border-box|padding-box|content-box/.exec(t);i=i?i[0]:"margin-box";var n=JSON.parse(JSON.stringify(e.borderBox.radii)),s={text:i,x:e.borderBox.x,y:e.borderBox.y,width:e.borderBox.width,height:e.borderBox.height,radii:n};switch(i){case"content-box":A(s,-1,[e.paddings,e.borders]),R(s.radii,-1,[e.paddings,e.borders]);break;case"padding-box":A(s,-1,[e.borders]),R(s.radii,-1,[e.borders]);break;case"border-box":break;case"margin-box":A(s,1,[e.margins]),R(s.radii,1,[e.margins])}return s},C.prototype.printShape=function(){if(this.shape)switch(this.shape.type){case"inset":return"inset("+this.shape.insets.join(" ")+" round "+z(this.shape.radii,0).join(" ")+" / "+z(this.shape.radii,1).join(" ")+")";case"circle":return"circle("+this.shape.r+" at "+this.shape.cx+" "+this.shape.cy+")";case"ellipse":return"ellipse("+this.shape.rx+" "+this.shape.ry+" at "+this.shape.cx+" "+this.shape.cy+")";case"polygon":return"polygon("+this.shape.fillRule+", "+this.shape.points.map(function(t){return t.x+" "+t.y}).join(", ")+")";default:return"not yet implemented for "+this.shape.type}return"no shape specified"},C.prototype.printBox=function(){return this.box?this.box.text+" { x: "+this.box.x+", y: "+this.box.y+", width: "+this.box.width+", height: "+this.box.height+", radii: "+z(this.box.radii,0).join(" ")+" / "+z(this.box.radii,1).join(" ")+" }":"no box specified"},C.prototype.parseBasicShape=function(t,e,i){var n=/(inset|circle|ellipse|polygon)\((.*)\)/.exec(t);if(!n)return null;var s=n[1],o=n[2]?n[2]:"";switch(s){case"inset":return this.parseInset(o,e,i);case"circle":return this.parseCircle(o,e,i);case"ellipse":return this.parseEllipse(o,e,i);case"polygon":return this.parsePolygon(o,e,i);default:return null}},C.prototype.parseInset=function(t,e,i){var n,s={type:"inset",insets:[0,0,0,0],radii:[[0,0],[0,0],[0,0],[0,0]]};if((t=/((?:[^r]|r(?!o))*)?\s*(?:round\s+([^\/]*)(?:\s*\/\s*(.*))?)?/.exec(t))&&t[1]){var o=t[1].trim();o=o.split(/\s+/),s.insets[0]=o[0],s.insets[1]=o.length>1?o[1]:s.insets[0],s.insets[2]=o.length>2?o[2]:s.insets[0],s.insets[3]=o.length>3?o[3]:s.insets[1],s.insets[0]=i.toPixels(s.insets[0],e.height),s.insets[1]=i.toPixels(s.insets[1],e.width),s.insets[2]=i.toPixels(s.insets[2],e.height),s.insets[3]=i.toPixels(s.insets[3],e.width)}return t&&t[2]&&((n=(n=t[2].trim()).split(/\s+/)).length<2&&n.push(n[0]),n.length<3&&n.push(n[0]),n.length<4&&n.push(n[1]),s.radii=n.map(function(t){return[t=i.toPixels(t,e.width),t]})),t&&t[3]&&((n=(n=t[3].trim()).split(/\s+/)).length<2&&n.push(n[0]),n.length<3&&n.push(n[0]),n.length<4&&n.push(n[1]),n.forEach(function(t,n){s.radii[n][1]=i.toPixels(t,e.height)})),s.x=s.insets[3],s.y=s.insets[0],s.width=e.width-(s.insets[1]+s.insets[3]),s.height=e.height-(s.insets[0]+s.insets[2]),s},C.prototype.parseEllipsoid=function(t){var e={};if((t=/((?:[^a]|a(?!t))*)?\s*(?:at\s+(.*))?/.exec(t))&&t[1]){var i=t[1].trim();i=i.split(/\s+/),e.rx=i[0],e.ry=i.length>1?i[1]:i[0]}else e.rx=e.ry="closest-side";var n=[];if(t&&t[2]){var s=t[2].trim(),o=!1;(s=s.split(/\s+/)).forEach(function(t){/\d+/.test(t)&&o?n[n.length-1]+=" "+t:n.push(t),o=/top|bottom|left|right/.test(t)&&s.length>2})}for(;n.length<2;)n.push("center");if(/top|bottom/.test(n[0])||/left|right/.test(n[1])){var r=n[0];n[0]=n[1],n[1]=r}return e.cx=n[0],e.cy=n[1],e},C.prototype.parseCircle=function(t,e,i){var n=this.parseEllipsoid(t);return n.type="circle",n.cx=I(n.cx,e.width,i),n.cy=I(n.cy,e.height,i),n.r=B(n.rx,[Math.abs(n.cx),Math.abs(e.width-n.cx),Math.abs(n.cy),Math.abs(e.height-n.cy)],Math.sqrt((e.width*e.width+e.height*e.height)/2),i),delete n.rx,delete n.ry,n},C.prototype.parseEllipse=function(t,e,i){var n=this.parseEllipsoid(t);return n.type="ellipse",n.cx=I(n.cx,e.width,i),n.cy=I(n.cy,e.height,i),n.rx=B(n.rx,[Math.abs(n.cx),Math.abs(e.width-n.cx)],e.width,i),n.ry=B(n.ry,[Math.abs(n.cy),Math.abs(e.height-n.cy)],e.height,i),n},C.prototype.parsePolygon=function(t,e,i){var n="nonzero";return(t=t.split(/\s*,\s*/)).length>0&&/nonzero|evenodd/.test(t[0])&&(n=t[0].trim(),t=t.slice(1)),{type:"polygon",fillRule:n,points:t.map(function(t){var n=t.split(/\s+/);return{x:i.toPixels(n[0],e.width),y:i.toPixels(n[1],e.height)}})}},C.prototype.computeClip=function(t,e){var i=e.margins[3],n=e.margins[0],s=e.margins[3]+e.margins[1],o=e.margins[0]+e.margins[2];return{x:-t.x-i,y:-t.y-n,width:e.borderBox.width+s,height:e.borderBox.height+o}},C.prototype.parseShapeMargin=function(t,e,i){return parseInt(t)?Math.max(0,i.toPixels(t,e.width)):0},C.prototype.parseShapeImageThreshold=function(t){var e=parseFloat(t);return e?Math.min(Math.max(0,e),1):0},N.prototype.load=function(t,e,i){var n=this;if(this.url){var s=new XMLHttpRequest;s.onreadystatechange=function(){4===s.readyState&&(200===s.status?(n.cssText=s.responseText,t.call(i,n)):e.call(i,n))},s.open("GET",this.url);try{s.send(null)}catch(t){console.log("An error occurred loading a stylesheet, probably because we can't access the local file system"),e.call(i,n)}}else this.cssText=this.source.textContent,t.call(i,n)},Z.prototype.init=function(){var t,e,i=function(){var t,e,i=document,n=[];if("function"==typeof i.querySelectorAll)n=i.querySelectorAll('link[rel="stylesheet"], style'),n=Array.prototype.slice.call(n,0);else{var s=i.getElementsByTagName("link");if(s.length)for(t=0,e=s.length;e>t;t++)"stylesheet"===s[t].getAttribute("rel")&&n.push(s[t]);for(t=0,e=(s=i.getElementsByTagName("style")).length;e>t;t++)n.push(s[t])}return n}(),n=i.length;for(this.queueCount=n,e=0;n>e;e++)t=new N(i[e]),this.stylesheets.push(t),t.load(this.onStyleSheetLoad,this.onStyleSheetError,this)},Z.prototype.onStyleSheetLoad=function(){this.queueCount--,this.onComplete.call(this)},Z.prototype.onStyleSheetError=function(t){var e,i=this.stylesheets.length;for(e=0;i>e;e++)if(t.source===this.stylesheets[e].source)return this.stylesheets.splice(e,1),this.queueCount--,void this.onComplete.call(this)},Z.prototype.onComplete=function(){0===this.queueCount&&this.callback.call(this,this.stylesheets)},D.prototype.onStylesLoaded=function(t){var e,i,n=[];["shape-outside","shape-margin","shape-image-threshold"].forEach(function(s){e=new RegExp("\\s*([^{}]*[^\\s])\\s*{[^\\}]*("+s+")\\s*:\\s*((?:[^;\\(]|\\([^\\)]*\\))*)\\s*;","ig"),t.forEach(function(t){for(;null!==(i=e.exec(t.cssText));)n.push({selector:i[1],property:i[2],value:i[3]})})}),this.callback(n)},t.ShapesPolyfill=new E(t)}(window);